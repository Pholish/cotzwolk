//@  prepros-append ../scripts/libs/jquery.easing.1.3.js
//@  prepros-append ../scripts/libs/Stats.js

// LIBS
//@prepros-append ../scripts/libs/jquery.touchSwipe.min.js
//@prepros-append ../scripts/libs/TweenLite.min.js
//@prepros-append ../scripts/libs/EaselPlugin.min.js
//@prepros-append ../scripts/libs/CSSPlugin.min.js

// ANIMATIONS
//@prepros-append ../scripts/libs/isMobile.min.js
//@prepros-append ../components/device-orientation/DeviceOrientation.js
//@prepros-append ../components/psprites/psprites.js
//@prepros-append ../components/bg-animation/bg-animation.js
//@prepros-append ../components/bg-animation-main/bg-animation-main.js

// INTRO
//@  prepros-append ../components/side-paginator/side-paginator.js
//@prepros-append ../components/intro/intro.js
/*!
 * @fileOverview TouchSwipe - jQuery Plugin
 * @version 1.6.18
 *
 * @author Matt Bryson http://www.github.com/mattbryson
 * @see https://github.com/mattbryson/TouchSwipe-Jquery-Plugin
 * @see http://labs.rampinteractive.co.uk/touchSwipe/
 * @see http://plugins.jquery.com/project/touchSwipe
 * @license
 * Copyright (c) 2010-2015 Matt Bryson
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 */
!function(factory){"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],factory):factory("undefined"!=typeof module&&module.exports?require("jquery"):jQuery)}(function($){"use strict";function init(options){return!options||void 0!==options.allowPageScroll||void 0===options.swipe&&void 0===options.swipeStatus||(options.allowPageScroll=NONE),void 0!==options.click&&void 0===options.tap&&(options.tap=options.click),options||(options={}),options=$.extend({},$.fn.swipe.defaults,options),this.each(function(){var $this=$(this),plugin=$this.data(PLUGIN_NS);plugin||(plugin=new TouchSwipe(this,options),$this.data(PLUGIN_NS,plugin))})}function TouchSwipe(element,options){function touchStart(jqEvent){if(!(getTouchInProgress()||$(jqEvent.target).closest(options.excludedElements,$element).length>0)){var event=jqEvent.originalEvent?jqEvent.originalEvent:jqEvent;if(!event.pointerType||"mouse"!=event.pointerType||0!=options.fallbackToMouseEvents){var ret,touches=event.touches,evt=touches?touches[0]:event;return phase=PHASE_START,touches?fingerCount=touches.length:options.preventDefaultEvents!==!1&&jqEvent.preventDefault(),distance=0,direction=null,currentDirection=null,pinchDirection=null,duration=0,startTouchesDistance=0,endTouchesDistance=0,pinchZoom=1,pinchDistance=0,maximumsMap=createMaximumsData(),cancelMultiFingerRelease(),createFingerData(0,evt),!touches||fingerCount===options.fingers||options.fingers===ALL_FINGERS||hasPinches()?(startTime=getTimeStamp(),2==fingerCount&&(createFingerData(1,touches[1]),startTouchesDistance=endTouchesDistance=calculateTouchesDistance(fingerData[0].start,fingerData[1].start)),(options.swipeStatus||options.pinchStatus)&&(ret=triggerHandler(event,phase))):ret=!1,ret===!1?(phase=PHASE_CANCEL,triggerHandler(event,phase),ret):(options.hold&&(holdTimeout=setTimeout($.proxy(function(){$element.trigger("hold",[event.target]),options.hold&&(ret=options.hold.call($element,event,event.target))},this),options.longTapThreshold)),setTouchInProgress(!0),null)}}}function touchMove(jqEvent){var event=jqEvent.originalEvent?jqEvent.originalEvent:jqEvent;if(phase!==PHASE_END&&phase!==PHASE_CANCEL&&!inMultiFingerRelease()){var ret,touches=event.touches,evt=touches?touches[0]:event,currentFinger=updateFingerData(evt);if(endTime=getTimeStamp(),touches&&(fingerCount=touches.length),options.hold&&clearTimeout(holdTimeout),phase=PHASE_MOVE,2==fingerCount&&(0==startTouchesDistance?(createFingerData(1,touches[1]),startTouchesDistance=endTouchesDistance=calculateTouchesDistance(fingerData[0].start,fingerData[1].start)):(updateFingerData(touches[1]),endTouchesDistance=calculateTouchesDistance(fingerData[0].end,fingerData[1].end),pinchDirection=calculatePinchDirection(fingerData[0].end,fingerData[1].end)),pinchZoom=calculatePinchZoom(startTouchesDistance,endTouchesDistance),pinchDistance=Math.abs(startTouchesDistance-endTouchesDistance)),fingerCount===options.fingers||options.fingers===ALL_FINGERS||!touches||hasPinches()){if(direction=calculateDirection(currentFinger.start,currentFinger.end),currentDirection=calculateDirection(currentFinger.last,currentFinger.end),validateDefaultEvent(jqEvent,currentDirection),distance=calculateDistance(currentFinger.start,currentFinger.end),duration=calculateDuration(),setMaxDistance(direction,distance),ret=triggerHandler(event,phase),!options.triggerOnTouchEnd||options.triggerOnTouchLeave){var inBounds=!0;if(options.triggerOnTouchLeave){var bounds=getbounds(this);inBounds=isInBounds(currentFinger.end,bounds)}!options.triggerOnTouchEnd&&inBounds?phase=getNextPhase(PHASE_MOVE):options.triggerOnTouchLeave&&!inBounds&&(phase=getNextPhase(PHASE_END)),phase!=PHASE_CANCEL&&phase!=PHASE_END||triggerHandler(event,phase)}}else phase=PHASE_CANCEL,triggerHandler(event,phase);ret===!1&&(phase=PHASE_CANCEL,triggerHandler(event,phase))}}function touchEnd(jqEvent){var event=jqEvent.originalEvent?jqEvent.originalEvent:jqEvent,touches=event.touches;if(touches){if(touches.length&&!inMultiFingerRelease())return startMultiFingerRelease(event),!0;if(touches.length&&inMultiFingerRelease())return!0}return inMultiFingerRelease()&&(fingerCount=fingerCountAtRelease),endTime=getTimeStamp(),duration=calculateDuration(),didSwipeBackToCancel()||!validateSwipeDistance()?(phase=PHASE_CANCEL,triggerHandler(event,phase)):options.triggerOnTouchEnd||options.triggerOnTouchEnd===!1&&phase===PHASE_MOVE?(options.preventDefaultEvents!==!1&&jqEvent.cancelable!==!1&&jqEvent.preventDefault(),phase=PHASE_END,triggerHandler(event,phase)):!options.triggerOnTouchEnd&&hasTap()?(phase=PHASE_END,triggerHandlerForGesture(event,phase,TAP)):phase===PHASE_MOVE&&(phase=PHASE_CANCEL,triggerHandler(event,phase)),setTouchInProgress(!1),null}function touchCancel(){fingerCount=0,endTime=0,startTime=0,startTouchesDistance=0,endTouchesDistance=0,pinchZoom=1,cancelMultiFingerRelease(),setTouchInProgress(!1)}function touchLeave(jqEvent){var event=jqEvent.originalEvent?jqEvent.originalEvent:jqEvent;options.triggerOnTouchLeave&&(phase=getNextPhase(PHASE_END),triggerHandler(event,phase))}function removeListeners(){$element.unbind(START_EV,touchStart),$element.unbind(CANCEL_EV,touchCancel),$element.unbind(MOVE_EV,touchMove),$element.unbind(END_EV,touchEnd),LEAVE_EV&&$element.unbind(LEAVE_EV,touchLeave),setTouchInProgress(!1)}function getNextPhase(currentPhase){var nextPhase=currentPhase,validTime=validateSwipeTime(),validDistance=validateSwipeDistance(),didCancel=didSwipeBackToCancel();return!validTime||didCancel?nextPhase=PHASE_CANCEL:!validDistance||currentPhase!=PHASE_MOVE||options.triggerOnTouchEnd&&!options.triggerOnTouchLeave?!validDistance&&currentPhase==PHASE_END&&options.triggerOnTouchLeave&&(nextPhase=PHASE_CANCEL):nextPhase=PHASE_END,nextPhase}function triggerHandler(event,phase){var ret,touches=event.touches;return(didSwipe()||hasSwipes())&&(ret=triggerHandlerForGesture(event,phase,SWIPE)),(didPinch()||hasPinches())&&ret!==!1&&(ret=triggerHandlerForGesture(event,phase,PINCH)),didDoubleTap()&&ret!==!1?ret=triggerHandlerForGesture(event,phase,DOUBLE_TAP):didLongTap()&&ret!==!1?ret=triggerHandlerForGesture(event,phase,LONG_TAP):didTap()&&ret!==!1&&(ret=triggerHandlerForGesture(event,phase,TAP)),phase===PHASE_CANCEL&&touchCancel(event),phase===PHASE_END&&(touches?touches.length||touchCancel(event):touchCancel(event)),ret}function triggerHandlerForGesture(event,phase,gesture){var ret;if(gesture==SWIPE){if($element.trigger("swipeStatus",[phase,direction||null,distance||0,duration||0,fingerCount,fingerData,currentDirection]),options.swipeStatus&&(ret=options.swipeStatus.call($element,event,phase,direction||null,distance||0,duration||0,fingerCount,fingerData,currentDirection),ret===!1))return!1;if(phase==PHASE_END&&validateSwipe()){if(clearTimeout(singleTapTimeout),clearTimeout(holdTimeout),$element.trigger("swipe",[direction,distance,duration,fingerCount,fingerData,currentDirection]),options.swipe&&(ret=options.swipe.call($element,event,direction,distance,duration,fingerCount,fingerData,currentDirection),ret===!1))return!1;switch(direction){case LEFT:$element.trigger("swipeLeft",[direction,distance,duration,fingerCount,fingerData,currentDirection]),options.swipeLeft&&(ret=options.swipeLeft.call($element,event,direction,distance,duration,fingerCount,fingerData,currentDirection));break;case RIGHT:$element.trigger("swipeRight",[direction,distance,duration,fingerCount,fingerData,currentDirection]),options.swipeRight&&(ret=options.swipeRight.call($element,event,direction,distance,duration,fingerCount,fingerData,currentDirection));break;case UP:$element.trigger("swipeUp",[direction,distance,duration,fingerCount,fingerData,currentDirection]),options.swipeUp&&(ret=options.swipeUp.call($element,event,direction,distance,duration,fingerCount,fingerData,currentDirection));break;case DOWN:$element.trigger("swipeDown",[direction,distance,duration,fingerCount,fingerData,currentDirection]),options.swipeDown&&(ret=options.swipeDown.call($element,event,direction,distance,duration,fingerCount,fingerData,currentDirection))}}}if(gesture==PINCH){if($element.trigger("pinchStatus",[phase,pinchDirection||null,pinchDistance||0,duration||0,fingerCount,pinchZoom,fingerData]),options.pinchStatus&&(ret=options.pinchStatus.call($element,event,phase,pinchDirection||null,pinchDistance||0,duration||0,fingerCount,pinchZoom,fingerData),ret===!1))return!1;if(phase==PHASE_END&&validatePinch())switch(pinchDirection){case IN:$element.trigger("pinchIn",[pinchDirection||null,pinchDistance||0,duration||0,fingerCount,pinchZoom,fingerData]),options.pinchIn&&(ret=options.pinchIn.call($element,event,pinchDirection||null,pinchDistance||0,duration||0,fingerCount,pinchZoom,fingerData));break;case OUT:$element.trigger("pinchOut",[pinchDirection||null,pinchDistance||0,duration||0,fingerCount,pinchZoom,fingerData]),options.pinchOut&&(ret=options.pinchOut.call($element,event,pinchDirection||null,pinchDistance||0,duration||0,fingerCount,pinchZoom,fingerData))}}return gesture==TAP?phase!==PHASE_CANCEL&&phase!==PHASE_END||(clearTimeout(singleTapTimeout),clearTimeout(holdTimeout),hasDoubleTap()&&!inDoubleTap()?(doubleTapStartTime=getTimeStamp(),singleTapTimeout=setTimeout($.proxy(function(){doubleTapStartTime=null,$element.trigger("tap",[event.target]),options.tap&&(ret=options.tap.call($element,event,event.target))},this),options.doubleTapThreshold)):(doubleTapStartTime=null,$element.trigger("tap",[event.target]),options.tap&&(ret=options.tap.call($element,event,event.target)))):gesture==DOUBLE_TAP?phase!==PHASE_CANCEL&&phase!==PHASE_END||(clearTimeout(singleTapTimeout),clearTimeout(holdTimeout),doubleTapStartTime=null,$element.trigger("doubletap",[event.target]),options.doubleTap&&(ret=options.doubleTap.call($element,event,event.target))):gesture==LONG_TAP&&(phase!==PHASE_CANCEL&&phase!==PHASE_END||(clearTimeout(singleTapTimeout),doubleTapStartTime=null,$element.trigger("longtap",[event.target]),options.longTap&&(ret=options.longTap.call($element,event,event.target)))),ret}function validateSwipeDistance(){var valid=!0;return null!==options.threshold&&(valid=distance>=options.threshold),valid}function didSwipeBackToCancel(){var cancelled=!1;return null!==options.cancelThreshold&&null!==direction&&(cancelled=getMaxDistance(direction)-distance>=options.cancelThreshold),cancelled}function validatePinchDistance(){return null===options.pinchThreshold||pinchDistance>=options.pinchThreshold}function validateSwipeTime(){var result;return result=!options.maxTimeThreshold||!(duration>=options.maxTimeThreshold)}function validateDefaultEvent(jqEvent,direction){if(options.preventDefaultEvents!==!1)if(options.allowPageScroll===NONE)jqEvent.preventDefault();else{var auto=options.allowPageScroll===AUTO;switch(direction){case LEFT:(options.swipeLeft&&auto||!auto&&options.allowPageScroll!=HORIZONTAL)&&jqEvent.preventDefault();break;case RIGHT:(options.swipeRight&&auto||!auto&&options.allowPageScroll!=HORIZONTAL)&&jqEvent.preventDefault();break;case UP:(options.swipeUp&&auto||!auto&&options.allowPageScroll!=VERTICAL)&&jqEvent.preventDefault();break;case DOWN:(options.swipeDown&&auto||!auto&&options.allowPageScroll!=VERTICAL)&&jqEvent.preventDefault();break;case NONE:}}}function validatePinch(){var hasCorrectFingerCount=validateFingers(),hasEndPoint=validateEndPoint(),hasCorrectDistance=validatePinchDistance();return hasCorrectFingerCount&&hasEndPoint&&hasCorrectDistance}function hasPinches(){return!!(options.pinchStatus||options.pinchIn||options.pinchOut)}function didPinch(){return!(!validatePinch()||!hasPinches())}function validateSwipe(){var hasValidTime=validateSwipeTime(),hasValidDistance=validateSwipeDistance(),hasCorrectFingerCount=validateFingers(),hasEndPoint=validateEndPoint(),didCancel=didSwipeBackToCancel(),valid=!didCancel&&hasEndPoint&&hasCorrectFingerCount&&hasValidDistance&&hasValidTime;return valid}function hasSwipes(){return!!(options.swipe||options.swipeStatus||options.swipeLeft||options.swipeRight||options.swipeUp||options.swipeDown)}function didSwipe(){return!(!validateSwipe()||!hasSwipes())}function validateFingers(){return fingerCount===options.fingers||options.fingers===ALL_FINGERS||!SUPPORTS_TOUCH}function validateEndPoint(){return 0!==fingerData[0].end.x}function hasTap(){return!!options.tap}function hasDoubleTap(){return!!options.doubleTap}function hasLongTap(){return!!options.longTap}function validateDoubleTap(){if(null==doubleTapStartTime)return!1;var now=getTimeStamp();return hasDoubleTap()&&now-doubleTapStartTime<=options.doubleTapThreshold}function inDoubleTap(){return validateDoubleTap()}function validateTap(){return(1===fingerCount||!SUPPORTS_TOUCH)&&(isNaN(distance)||distance<options.threshold)}function validateLongTap(){return duration>options.longTapThreshold&&distance<DOUBLE_TAP_THRESHOLD}function didTap(){return!(!validateTap()||!hasTap())}function didDoubleTap(){return!(!validateDoubleTap()||!hasDoubleTap())}function didLongTap(){return!(!validateLongTap()||!hasLongTap())}function startMultiFingerRelease(event){previousTouchEndTime=getTimeStamp(),fingerCountAtRelease=event.touches.length+1}function cancelMultiFingerRelease(){previousTouchEndTime=0,fingerCountAtRelease=0}function inMultiFingerRelease(){var withinThreshold=!1;if(previousTouchEndTime){var diff=getTimeStamp()-previousTouchEndTime;diff<=options.fingerReleaseThreshold&&(withinThreshold=!0)}return withinThreshold}function getTouchInProgress(){return!($element.data(PLUGIN_NS+"_intouch")!==!0)}function setTouchInProgress(val){$element&&(val===!0?($element.bind(MOVE_EV,touchMove),$element.bind(END_EV,touchEnd),LEAVE_EV&&$element.bind(LEAVE_EV,touchLeave)):($element.unbind(MOVE_EV,touchMove,!1),$element.unbind(END_EV,touchEnd,!1),LEAVE_EV&&$element.unbind(LEAVE_EV,touchLeave,!1)),$element.data(PLUGIN_NS+"_intouch",val===!0))}function createFingerData(id,evt){var f={start:{x:0,y:0},last:{x:0,y:0},end:{x:0,y:0}};return f.start.x=f.last.x=f.end.x=evt.pageX||evt.clientX,f.start.y=f.last.y=f.end.y=evt.pageY||evt.clientY,fingerData[id]=f,f}function updateFingerData(evt){var id=void 0!==evt.identifier?evt.identifier:0,f=getFingerData(id);return null===f&&(f=createFingerData(id,evt)),f.last.x=f.end.x,f.last.y=f.end.y,f.end.x=evt.pageX||evt.clientX,f.end.y=evt.pageY||evt.clientY,f}function getFingerData(id){return fingerData[id]||null}function setMaxDistance(direction,distance){direction!=NONE&&(distance=Math.max(distance,getMaxDistance(direction)),maximumsMap[direction].distance=distance)}function getMaxDistance(direction){if(maximumsMap[direction])return maximumsMap[direction].distance}function createMaximumsData(){var maxData={};return maxData[LEFT]=createMaximumVO(LEFT),maxData[RIGHT]=createMaximumVO(RIGHT),maxData[UP]=createMaximumVO(UP),maxData[DOWN]=createMaximumVO(DOWN),maxData}function createMaximumVO(dir){return{direction:dir,distance:0}}function calculateDuration(){return endTime-startTime}function calculateTouchesDistance(startPoint,endPoint){var diffX=Math.abs(startPoint.x-endPoint.x),diffY=Math.abs(startPoint.y-endPoint.y);return Math.round(Math.sqrt(diffX*diffX+diffY*diffY))}function calculatePinchZoom(startDistance,endDistance){var percent=endDistance/startDistance*1;return percent.toFixed(2)}function calculatePinchDirection(){return pinchZoom<1?OUT:IN}function calculateDistance(startPoint,endPoint){return Math.round(Math.sqrt(Math.pow(endPoint.x-startPoint.x,2)+Math.pow(endPoint.y-startPoint.y,2)))}function calculateAngle(startPoint,endPoint){var x=startPoint.x-endPoint.x,y=endPoint.y-startPoint.y,r=Math.atan2(y,x),angle=Math.round(180*r/Math.PI);return angle<0&&(angle=360-Math.abs(angle)),angle}function calculateDirection(startPoint,endPoint){if(comparePoints(startPoint,endPoint))return NONE;var angle=calculateAngle(startPoint,endPoint);return angle<=45&&angle>=0?LEFT:angle<=360&&angle>=315?LEFT:angle>=135&&angle<=225?RIGHT:angle>45&&angle<135?DOWN:UP}function getTimeStamp(){var now=new Date;return now.getTime()}function getbounds(el){el=$(el);var offset=el.offset(),bounds={left:offset.left,right:offset.left+el.outerWidth(),top:offset.top,bottom:offset.top+el.outerHeight()};return bounds}function isInBounds(point,bounds){return point.x>bounds.left&&point.x<bounds.right&&point.y>bounds.top&&point.y<bounds.bottom}function comparePoints(pointA,pointB){return pointA.x==pointB.x&&pointA.y==pointB.y}var options=$.extend({},options),useTouchEvents=SUPPORTS_TOUCH||SUPPORTS_POINTER||!options.fallbackToMouseEvents,START_EV=useTouchEvents?SUPPORTS_POINTER?SUPPORTS_POINTER_IE10?"MSPointerDown":"pointerdown":"touchstart":"mousedown",MOVE_EV=useTouchEvents?SUPPORTS_POINTER?SUPPORTS_POINTER_IE10?"MSPointerMove":"pointermove":"touchmove":"mousemove",END_EV=useTouchEvents?SUPPORTS_POINTER?SUPPORTS_POINTER_IE10?"MSPointerUp":"pointerup":"touchend":"mouseup",LEAVE_EV=useTouchEvents?SUPPORTS_POINTER?"mouseleave":null:"mouseleave",CANCEL_EV=SUPPORTS_POINTER?SUPPORTS_POINTER_IE10?"MSPointerCancel":"pointercancel":"touchcancel",distance=0,direction=null,currentDirection=null,duration=0,startTouchesDistance=0,endTouchesDistance=0,pinchZoom=1,pinchDistance=0,pinchDirection=0,maximumsMap=null,$element=$(element),phase="start",fingerCount=0,fingerData={},startTime=0,endTime=0,previousTouchEndTime=0,fingerCountAtRelease=0,doubleTapStartTime=0,singleTapTimeout=null,holdTimeout=null;try{$element.bind(START_EV,touchStart),$element.bind(CANCEL_EV,touchCancel)}catch(e){$.error("events not supported "+START_EV+","+CANCEL_EV+" on jQuery.swipe")}this.enable=function(){return this.disable(),$element.bind(START_EV,touchStart),$element.bind(CANCEL_EV,touchCancel),$element},this.disable=function(){return removeListeners(),$element},this.destroy=function(){removeListeners(),$element.data(PLUGIN_NS,null),$element=null},this.option=function(property,value){if("object"==typeof property)options=$.extend(options,property);else if(void 0!==options[property]){if(void 0===value)return options[property];options[property]=value}else{if(!property)return options;$.error("Option "+property+" does not exist on jQuery.swipe.options")}return null}}var VERSION="1.6.18",LEFT="left",RIGHT="right",UP="up",DOWN="down",IN="in",OUT="out",NONE="none",AUTO="auto",SWIPE="swipe",PINCH="pinch",TAP="tap",DOUBLE_TAP="doubletap",LONG_TAP="longtap",HORIZONTAL="horizontal",VERTICAL="vertical",ALL_FINGERS="all",DOUBLE_TAP_THRESHOLD=10,PHASE_START="start",PHASE_MOVE="move",PHASE_END="end",PHASE_CANCEL="cancel",SUPPORTS_TOUCH="ontouchstart"in window,SUPPORTS_POINTER_IE10=window.navigator.msPointerEnabled&&!window.navigator.pointerEnabled&&!SUPPORTS_TOUCH,SUPPORTS_POINTER=(window.navigator.pointerEnabled||window.navigator.msPointerEnabled)&&!SUPPORTS_TOUCH,PLUGIN_NS="TouchSwipe",defaults={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,hold:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:".noSwipe",preventDefaultEvents:!0};$.fn.swipe=function(method){var $this=$(this),plugin=$this.data(PLUGIN_NS);if(plugin&&"string"==typeof method){if(plugin[method])return plugin[method].apply(plugin,Array.prototype.slice.call(arguments,1));$.error("Method "+method+" does not exist on jQuery.swipe")}else if(plugin&&"object"==typeof method)plugin.option.apply(plugin,arguments);else if(!(plugin||"object"!=typeof method&&method))return init.apply(this,arguments);return $this},$.fn.swipe.version=VERSION,$.fn.swipe.defaults=defaults,$.fn.swipe.phases={PHASE_START:PHASE_START,PHASE_MOVE:PHASE_MOVE,PHASE_END:PHASE_END,PHASE_CANCEL:PHASE_CANCEL},$.fn.swipe.directions={LEFT:LEFT,RIGHT:RIGHT,UP:UP,DOWN:DOWN,IN:IN,OUT:OUT},$.fn.swipe.pageScroll={NONE:NONE,HORIZONTAL:HORIZONTAL,VERTICAL:VERTICAL,AUTO:AUTO},$.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,FOUR:4,FIVE:5,ALL:ALL_FINGERS}});
/*!
 * VERSION: 1.20.4
 * DATE: 2018-02-15
 * UPDATES AND DOCS AT: http://greensock.com
 *
 * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
 * This work is subject to the terms at http://greensock.com/standard-license or for
 * Club GreenSock members, the software agreement that was issued with your membership.
 * 
 * @author: Jack Doyle, jack@greensock.com
 */
!function(a,b){"use strict";var c={},d=a.document,e=a.GreenSockGlobals=a.GreenSockGlobals||a;if(!e.TweenLite){var f,g,h,i,j,k=function(a){var b,c=a.split("."),d=e;for(b=0;b<c.length;b++)d[c[b]]=d=d[c[b]]||{};return d},l=k("com.greensock"),m=1e-10,n=function(a){var b,c=[],d=a.length;for(b=0;b!==d;c.push(a[b++]));return c},o=function(){},p=function(){var a=Object.prototype.toString,b=a.call([]);return function(c){return null!=c&&(c instanceof Array||"object"==typeof c&&!!c.push&&a.call(c)===b)}}(),q={},r=function(d,f,g,h){this.sc=q[d]?q[d].sc:[],q[d]=this,this.gsClass=null,this.func=g;var i=[];this.check=function(j){for(var l,m,n,o,p=f.length,s=p;--p>-1;)(l=q[f[p]]||new r(f[p],[])).gsClass?(i[p]=l.gsClass,s--):j&&l.sc.push(this);if(0===s&&g){if(m=("com.greensock."+d).split("."),n=m.pop(),o=k(m.join("."))[n]=this.gsClass=g.apply(g,i),h)if(e[n]=c[n]=o,"undefined"!=typeof module&&module.exports)if(d===b){module.exports=c[b]=o;for(p in c)o[p]=c[p]}else c[b]&&(c[b][n]=o);else"function"==typeof define&&define.amd&&define((a.GreenSockAMDPath?a.GreenSockAMDPath+"/":"")+d.split(".").pop(),[],function(){return o});for(p=0;p<this.sc.length;p++)this.sc[p].check()}},this.check(!0)},s=a._gsDefine=function(a,b,c,d){return new r(a,b,c,d)},t=l._class=function(a,b,c){return b=b||function(){},s(a,[],function(){return b},c),b};s.globals=e;var u=[0,0,1,1],v=t("easing.Ease",function(a,b,c,d){this._func=a,this._type=c||0,this._power=d||0,this._params=b?u.concat(b):u},!0),w=v.map={},x=v.register=function(a,b,c,d){for(var e,f,g,h,i=b.split(","),j=i.length,k=(c||"easeIn,easeOut,easeInOut").split(",");--j>-1;)for(f=i[j],e=d?t("easing."+f,null,!0):l.easing[f]||{},g=k.length;--g>-1;)h=k[g],w[f+"."+h]=w[h+f]=e[h]=a.getRatio?a:a[h]||new a};for(h=v.prototype,h._calcEnd=!1,h.getRatio=function(a){if(this._func)return this._params[0]=a,this._func.apply(null,this._params);var b=this._type,c=this._power,d=1===b?1-a:2===b?a:.5>a?2*a:2*(1-a);return 1===c?d*=d:2===c?d*=d*d:3===c?d*=d*d*d:4===c&&(d*=d*d*d*d),1===b?1-d:2===b?d:.5>a?d/2:1-d/2},f=["Linear","Quad","Cubic","Quart","Quint,Strong"],g=f.length;--g>-1;)h=f[g]+",Power"+g,x(new v(null,null,1,g),h,"easeOut",!0),x(new v(null,null,2,g),h,"easeIn"+(0===g?",easeNone":"")),x(new v(null,null,3,g),h,"easeInOut");w.linear=l.easing.Linear.easeIn,w.swing=l.easing.Quad.easeInOut;var y=t("events.EventDispatcher",function(a){this._listeners={},this._eventTarget=a||this});h=y.prototype,h.addEventListener=function(a,b,c,d,e){e=e||0;var f,g,h=this._listeners[a],k=0;for(this!==i||j||i.wake(),null==h&&(this._listeners[a]=h=[]),g=h.length;--g>-1;)f=h[g],f.c===b&&f.s===c?h.splice(g,1):0===k&&f.pr<e&&(k=g+1);h.splice(k,0,{c:b,s:c,up:d,pr:e})},h.removeEventListener=function(a,b){var c,d=this._listeners[a];if(d)for(c=d.length;--c>-1;)if(d[c].c===b)return void d.splice(c,1)},h.dispatchEvent=function(a){var b,c,d,e=this._listeners[a];if(e)for(b=e.length,b>1&&(e=e.slice(0)),c=this._eventTarget;--b>-1;)d=e[b],d&&(d.up?d.c.call(d.s||c,{type:a,target:c}):d.c.call(d.s||c))};var z=a.requestAnimationFrame,A=a.cancelAnimationFrame,B=Date.now||function(){return(new Date).getTime()},C=B();for(f=["ms","moz","webkit","o"],g=f.length;--g>-1&&!z;)z=a[f[g]+"RequestAnimationFrame"],A=a[f[g]+"CancelAnimationFrame"]||a[f[g]+"CancelRequestAnimationFrame"];t("Ticker",function(a,b){var c,e,f,g,h,k=this,l=B(),n=b!==!1&&z?"auto":!1,p=500,q=33,r="tick",s=function(a){var b,d,i=B()-C;i>p&&(l+=i-q),C+=i,k.time=(C-l)/1e3,b=k.time-h,(!c||b>0||a===!0)&&(k.frame++,h+=b+(b>=g?.004:g-b),d=!0),a!==!0&&(f=e(s)),d&&k.dispatchEvent(r)};y.call(k),k.time=k.frame=0,k.tick=function(){s(!0)},k.lagSmoothing=function(a,b){return arguments.length?(p=a||1/m,void(q=Math.min(b,p,0))):1/m>p},k.sleep=function(){null!=f&&(n&&A?A(f):clearTimeout(f),e=o,f=null,k===i&&(j=!1))},k.wake=function(a){null!==f?k.sleep():a?l+=-C+(C=B()):k.frame>10&&(C=B()-p+5),e=0===c?o:n&&z?z:function(a){return setTimeout(a,1e3*(h-k.time)+1|0)},k===i&&(j=!0),s(2)},k.fps=function(a){return arguments.length?(c=a,g=1/(c||60),h=this.time+g,void k.wake()):c},k.useRAF=function(a){return arguments.length?(k.sleep(),n=a,void k.fps(c)):n},k.fps(a),setTimeout(function(){"auto"===n&&k.frame<5&&"hidden"!==(d||{}).visibilityState&&k.useRAF(!1)},1500)}),h=l.Ticker.prototype=new l.events.EventDispatcher,h.constructor=l.Ticker;var D=t("core.Animation",function(a,b){if(this.vars=b=b||{},this._duration=this._totalDuration=a||0,this._delay=Number(b.delay)||0,this._timeScale=1,this._active=b.immediateRender===!0,this.data=b.data,this._reversed=b.reversed===!0,X){j||i.wake();var c=this.vars.useFrames?W:X;c.add(this,c._time),this.vars.paused&&this.paused(!0)}});i=D.ticker=new l.Ticker,h=D.prototype,h._dirty=h._gc=h._initted=h._paused=!1,h._totalTime=h._time=0,h._rawPrevTime=-1,h._next=h._last=h._onUpdate=h._timeline=h.timeline=null,h._paused=!1;var E=function(){j&&B()-C>2e3&&("hidden"!==(d||{}).visibilityState||!i.lagSmoothing())&&i.wake();var a=setTimeout(E,2e3);a.unref&&a.unref()};E(),h.play=function(a,b){return null!=a&&this.seek(a,b),this.reversed(!1).paused(!1)},h.pause=function(a,b){return null!=a&&this.seek(a,b),this.paused(!0)},h.resume=function(a,b){return null!=a&&this.seek(a,b),this.paused(!1)},h.seek=function(a,b){return this.totalTime(Number(a),b!==!1)},h.restart=function(a,b){return this.reversed(!1).paused(!1).totalTime(a?-this._delay:0,b!==!1,!0)},h.reverse=function(a,b){return null!=a&&this.seek(a||this.totalDuration(),b),this.reversed(!0).paused(!1)},h.render=function(a,b,c){},h.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,(this._gc||!this.timeline)&&this._enabled(!0),this},h.isActive=function(){var a,b=this._timeline,c=this._startTime;return!b||!this._gc&&!this._paused&&b.isActive()&&(a=b.rawTime(!0))>=c&&a<c+this.totalDuration()/this._timeScale-1e-7},h._enabled=function(a,b){return j||i.wake(),this._gc=!a,this._active=this.isActive(),b!==!0&&(a&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!a&&this.timeline&&this._timeline._remove(this,!0)),!1},h._kill=function(a,b){return this._enabled(!1,!1)},h.kill=function(a,b){return this._kill(a,b),this},h._uncache=function(a){for(var b=a?this:this.timeline;b;)b._dirty=!0,b=b.timeline;return this},h._swapSelfInParams=function(a){for(var b=a.length,c=a.concat();--b>-1;)"{self}"===a[b]&&(c[b]=this);return c},h._callback=function(a){var b=this.vars,c=b[a],d=b[a+"Params"],e=b[a+"Scope"]||b.callbackScope||this,f=d?d.length:0;switch(f){case 0:c.call(e);break;case 1:c.call(e,d[0]);break;case 2:c.call(e,d[0],d[1]);break;default:c.apply(e,d)}},h.eventCallback=function(a,b,c,d){if("on"===(a||"").substr(0,2)){var e=this.vars;if(1===arguments.length)return e[a];null==b?delete e[a]:(e[a]=b,e[a+"Params"]=p(c)&&-1!==c.join("").indexOf("{self}")?this._swapSelfInParams(c):c,e[a+"Scope"]=d),"onUpdate"===a&&(this._onUpdate=b)}return this},h.delay=function(a){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+a-this._delay),this._delay=a,this):this._delay},h.duration=function(a){return arguments.length?(this._duration=this._totalDuration=a,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==a&&this.totalTime(this._totalTime*(a/this._duration),!0),this):(this._dirty=!1,this._duration)},h.totalDuration=function(a){return this._dirty=!1,arguments.length?this.duration(a):this._totalDuration},h.time=function(a,b){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(a>this._duration?this._duration:a,b)):this._time},h.totalTime=function(a,b,c){if(j||i.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>a&&!c&&(a+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var d=this._totalDuration,e=this._timeline;if(a>d&&!c&&(a=d),this._startTime=(this._paused?this._pauseTime:e._time)-(this._reversed?d-a:a)/this._timeScale,e._dirty||this._uncache(!1),e._timeline)for(;e._timeline;)e._timeline._time!==(e._startTime+e._totalTime)/e._timeScale&&e.totalTime(e._totalTime,!0),e=e._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==a||0===this._duration)&&(J.length&&Z(),this.render(a,b,!1),J.length&&Z())}return this},h.progress=h.totalProgress=function(a,b){var c=this.duration();return arguments.length?this.totalTime(c*a,b):c?this._time/c:this.ratio},h.startTime=function(a){return arguments.length?(a!==this._startTime&&(this._startTime=a,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,a-this._delay)),this):this._startTime},h.endTime=function(a){return this._startTime+(0!=a?this.totalDuration():this.duration())/this._timeScale},h.timeScale=function(a){if(!arguments.length)return this._timeScale;var b,c;for(a=a||m,this._timeline&&this._timeline.smoothChildTiming&&(b=this._pauseTime,c=b||0===b?b:this._timeline.totalTime(),this._startTime=c-(c-this._startTime)*this._timeScale/a),this._timeScale=a,c=this.timeline;c&&c.timeline;)c._dirty=!0,c.totalDuration(),c=c.timeline;return this},h.reversed=function(a){return arguments.length?(a!=this._reversed&&(this._reversed=a,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},h.paused=function(a){if(!arguments.length)return this._paused;var b,c,d=this._timeline;return a!=this._paused&&d&&(j||a||i.wake(),b=d.rawTime(),c=b-this._pauseTime,!a&&d.smoothChildTiming&&(this._startTime+=c,this._uncache(!1)),this._pauseTime=a?b:null,this._paused=a,this._active=this.isActive(),!a&&0!==c&&this._initted&&this.duration()&&(b=d.smoothChildTiming?this._totalTime:(b-this._startTime)/this._timeScale,this.render(b,b===this._totalTime,!0))),this._gc&&!a&&this._enabled(!0,!1),this};var F=t("core.SimpleTimeline",function(a){D.call(this,0,a),this.autoRemoveChildren=this.smoothChildTiming=!0});h=F.prototype=new D,h.constructor=F,h.kill()._gc=!1,h._first=h._last=h._recent=null,h._sortChildren=!1,h.add=h.insert=function(a,b,c,d){var e,f;if(a._startTime=Number(b||0)+a._delay,a._paused&&this!==a._timeline&&(a._pauseTime=a._startTime+(this.rawTime()-a._startTime)/a._timeScale),a.timeline&&a.timeline._remove(a,!0),a.timeline=a._timeline=this,a._gc&&a._enabled(!0,!0),e=this._last,this._sortChildren)for(f=a._startTime;e&&e._startTime>f;)e=e._prev;return e?(a._next=e._next,e._next=a):(a._next=this._first,this._first=a),a._next?a._next._prev=a:this._last=a,a._prev=e,this._recent=a,this._timeline&&this._uncache(!0),this},h._remove=function(a,b){return a.timeline===this&&(b||a._enabled(!1,!0),a._prev?a._prev._next=a._next:this._first===a&&(this._first=a._next),a._next?a._next._prev=a._prev:this._last===a&&(this._last=a._prev),a._next=a._prev=a.timeline=null,a===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},h.render=function(a,b,c){var d,e=this._first;for(this._totalTime=this._time=this._rawPrevTime=a;e;)d=e._next,(e._active||a>=e._startTime&&!e._paused&&!e._gc)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(a-e._startTime)*e._timeScale,b,c):e.render((a-e._startTime)*e._timeScale,b,c)),e=d},h.rawTime=function(){return j||i.wake(),this._totalTime};var G=t("TweenLite",function(b,c,d){if(D.call(this,c,d),this.render=G.prototype.render,null==b)throw"Cannot tween a null target.";this.target=b="string"!=typeof b?b:G.selector(b)||b;var e,f,g,h=b.jquery||b.length&&b!==a&&b[0]&&(b[0]===a||b[0].nodeType&&b[0].style&&!b.nodeType),i=this.vars.overwrite;if(this._overwrite=i=null==i?V[G.defaultOverwrite]:"number"==typeof i?i>>0:V[i],(h||b instanceof Array||b.push&&p(b))&&"number"!=typeof b[0])for(this._targets=g=n(b),this._propLookup=[],this._siblings=[],e=0;e<g.length;e++)f=g[e],f?"string"!=typeof f?f.length&&f!==a&&f[0]&&(f[0]===a||f[0].nodeType&&f[0].style&&!f.nodeType)?(g.splice(e--,1),this._targets=g=g.concat(n(f))):(this._siblings[e]=$(f,this,!1),1===i&&this._siblings[e].length>1&&aa(f,this,null,1,this._siblings[e])):(f=g[e--]=G.selector(f),"string"==typeof f&&g.splice(e+1,1)):g.splice(e--,1);else this._propLookup={},this._siblings=$(b,this,!1),1===i&&this._siblings.length>1&&aa(b,this,null,1,this._siblings);(this.vars.immediateRender||0===c&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-m,this.render(Math.min(0,-this._delay)))},!0),H=function(b){return b&&b.length&&b!==a&&b[0]&&(b[0]===a||b[0].nodeType&&b[0].style&&!b.nodeType)},I=function(a,b){var c,d={};for(c in a)U[c]||c in b&&"transform"!==c&&"x"!==c&&"y"!==c&&"width"!==c&&"height"!==c&&"className"!==c&&"border"!==c||!(!R[c]||R[c]&&R[c]._autoCSS)||(d[c]=a[c],delete a[c]);a.css=d};h=G.prototype=new D,h.constructor=G,h.kill()._gc=!1,h.ratio=0,h._firstPT=h._targets=h._overwrittenProps=h._startAt=null,h._notifyPluginsOfEnabled=h._lazy=!1,G.version="1.20.4",G.defaultEase=h._ease=new v(null,null,1,1),G.defaultOverwrite="auto",G.ticker=i,G.autoSleep=120,G.lagSmoothing=function(a,b){i.lagSmoothing(a,b)},G.selector=a.$||a.jQuery||function(b){var c=a.$||a.jQuery;return c?(G.selector=c,c(b)):"undefined"==typeof d?b:d.querySelectorAll?d.querySelectorAll(b):d.getElementById("#"===b.charAt(0)?b.substr(1):b)};var J=[],K={},L=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,M=/[\+-]=-?[\.\d]/,N=function(a){for(var b,c=this._firstPT,d=1e-6;c;)b=c.blob?1===a&&null!=this.end?this.end:a?this.join(""):this.start:c.c*a+c.s,c.m?b=c.m(b,this._target||c.t):d>b&&b>-d&&!c.blob&&(b=0),c.f?c.fp?c.t[c.p](c.fp,b):c.t[c.p](b):c.t[c.p]=b,c=c._next},O=function(a,b,c,d){var e,f,g,h,i,j,k,l=[],m=0,n="",o=0;for(l.start=a,l.end=b,a=l[0]=a+"",b=l[1]=b+"",c&&(c(l),a=l[0],b=l[1]),l.length=0,e=a.match(L)||[],f=b.match(L)||[],d&&(d._next=null,d.blob=1,l._firstPT=l._applyPT=d),i=f.length,h=0;i>h;h++)k=f[h],j=b.substr(m,b.indexOf(k,m)-m),n+=j||!h?j:",",m+=j.length,o?o=(o+1)%5:"rgba("===j.substr(-5)&&(o=1),k===e[h]||e.length<=h?n+=k:(n&&(l.push(n),n=""),g=parseFloat(e[h]),l.push(g),l._firstPT={_next:l._firstPT,t:l,p:l.length-1,s:g,c:("="===k.charAt(1)?parseInt(k.charAt(0)+"1",10)*parseFloat(k.substr(2)):parseFloat(k)-g)||0,f:0,m:o&&4>o?Math.round:0}),m+=k.length;return n+=b.substr(m),n&&l.push(n),l.setRatio=N,M.test(b)&&(l.end=null),l},P=function(a,b,c,d,e,f,g,h,i){"function"==typeof d&&(d=d(i||0,a));var j,k=typeof a[b],l="function"!==k?"":b.indexOf("set")||"function"!=typeof a["get"+b.substr(3)]?b:"get"+b.substr(3),m="get"!==c?c:l?g?a[l](g):a[l]():a[b],n="string"==typeof d&&"="===d.charAt(1),o={t:a,p:b,s:m,f:"function"===k,pg:0,n:e||b,m:f?"function"==typeof f?f:Math.round:0,pr:0,c:n?parseInt(d.charAt(0)+"1",10)*parseFloat(d.substr(2)):parseFloat(d)-m||0};return("number"!=typeof m||"number"!=typeof d&&!n)&&(g||isNaN(m)||!n&&isNaN(d)||"boolean"==typeof m||"boolean"==typeof d?(o.fp=g,j=O(m,n?parseFloat(o.s)+o.c+(o.s+"").replace(/[0-9\-\.]/g,""):d,h||G.defaultStringFilter,o),o={t:j,p:"setRatio",s:0,c:1,f:2,pg:0,n:e||b,pr:0,m:0}):(o.s=parseFloat(m),n||(o.c=parseFloat(d)-o.s||0))),o.c?((o._next=this._firstPT)&&(o._next._prev=o),this._firstPT=o,o):void 0},Q=G._internals={isArray:p,isSelector:H,lazyTweens:J,blobDif:O},R=G._plugins={},S=Q.tweenLookup={},T=0,U=Q.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1,yoyoEase:1},V={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},W=D._rootFramesTimeline=new F,X=D._rootTimeline=new F,Y=30,Z=Q.lazyRender=function(){var a,b=J.length;for(K={};--b>-1;)a=J[b],a&&a._lazy!==!1&&(a.render(a._lazy[0],a._lazy[1],!0),a._lazy=!1);J.length=0};X._startTime=i.time,W._startTime=i.frame,X._active=W._active=!0,setTimeout(Z,1),D._updateRoot=G.render=function(){var a,b,c;if(J.length&&Z(),X.render((i.time-X._startTime)*X._timeScale,!1,!1),W.render((i.frame-W._startTime)*W._timeScale,!1,!1),J.length&&Z(),i.frame>=Y){Y=i.frame+(parseInt(G.autoSleep,10)||120);for(c in S){for(b=S[c].tweens,a=b.length;--a>-1;)b[a]._gc&&b.splice(a,1);0===b.length&&delete S[c]}if(c=X._first,(!c||c._paused)&&G.autoSleep&&!W._first&&1===i._listeners.tick.length){for(;c&&c._paused;)c=c._next;c||i.sleep()}}},i.addEventListener("tick",D._updateRoot);var $=function(a,b,c){var d,e,f=a._gsTweenID;if(S[f||(a._gsTweenID=f="t"+T++)]||(S[f]={target:a,tweens:[]}),b&&(d=S[f].tweens,d[e=d.length]=b,c))for(;--e>-1;)d[e]===b&&d.splice(e,1);return S[f].tweens},_=function(a,b,c,d){var e,f,g=a.vars.onOverwrite;return g&&(e=g(a,b,c,d)),g=G.onOverwrite,g&&(f=g(a,b,c,d)),e!==!1&&f!==!1},aa=function(a,b,c,d,e){var f,g,h,i;if(1===d||d>=4){for(i=e.length,f=0;i>f;f++)if((h=e[f])!==b)h._gc||h._kill(null,a,b)&&(g=!0);else if(5===d)break;return g}var j,k=b._startTime+m,l=[],n=0,o=0===b._duration;for(f=e.length;--f>-1;)(h=e[f])===b||h._gc||h._paused||(h._timeline!==b._timeline?(j=j||ba(b,0,o),0===ba(h,j,o)&&(l[n++]=h)):h._startTime<=k&&h._startTime+h.totalDuration()/h._timeScale>k&&((o||!h._initted)&&k-h._startTime<=2e-10||(l[n++]=h)));for(f=n;--f>-1;)if(h=l[f],2===d&&h._kill(c,a,b)&&(g=!0),2!==d||!h._firstPT&&h._initted){if(2!==d&&!_(h,b))continue;h._enabled(!1,!1)&&(g=!0)}return g},ba=function(a,b,c){for(var d=a._timeline,e=d._timeScale,f=a._startTime;d._timeline;){if(f+=d._startTime,e*=d._timeScale,d._paused)return-100;d=d._timeline}return f/=e,f>b?f-b:c&&f===b||!a._initted&&2*m>f-b?m:(f+=a.totalDuration()/a._timeScale/e)>b+m?0:f-b-m};h._init=function(){var a,b,c,d,e,f,g=this.vars,h=this._overwrittenProps,i=this._duration,j=!!g.immediateRender,k=g.ease;if(g.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),e={};for(d in g.startAt)e[d]=g.startAt[d];if(e.data="isStart",e.overwrite=!1,e.immediateRender=!0,e.lazy=j&&g.lazy!==!1,e.startAt=e.delay=null,e.onUpdate=g.onUpdate,e.onUpdateParams=g.onUpdateParams,e.onUpdateScope=g.onUpdateScope||g.callbackScope||this,this._startAt=G.to(this.target,0,e),j)if(this._time>0)this._startAt=null;else if(0!==i)return}else if(g.runBackwards&&0!==i)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{0!==this._time&&(j=!1),c={};for(d in g)U[d]&&"autoCSS"!==d||(c[d]=g[d]);if(c.overwrite=0,c.data="isFromStart",c.lazy=j&&g.lazy!==!1,c.immediateRender=j,this._startAt=G.to(this.target,0,c),j){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=k=k?k instanceof v?k:"function"==typeof k?new v(k,g.easeParams):w[k]||G.defaultEase:G.defaultEase,g.easeParams instanceof Array&&k.config&&(this._ease=k.config.apply(k,g.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(f=this._targets.length,a=0;f>a;a++)this._initProps(this._targets[a],this._propLookup[a]={},this._siblings[a],h?h[a]:null,a)&&(b=!0);else b=this._initProps(this.target,this._propLookup,this._siblings,h,0);if(b&&G._onPluginEvent("_onInitAllProps",this),h&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),g.runBackwards)for(c=this._firstPT;c;)c.s+=c.c,c.c=-c.c,c=c._next;this._onUpdate=g.onUpdate,this._initted=!0},h._initProps=function(b,c,d,e,f){var g,h,i,j,k,l;if(null==b)return!1;K[b._gsTweenID]&&Z(),this.vars.css||b.style&&b!==a&&b.nodeType&&R.css&&this.vars.autoCSS!==!1&&I(this.vars,b);for(g in this.vars)if(l=this.vars[g],U[g])l&&(l instanceof Array||l.push&&p(l))&&-1!==l.join("").indexOf("{self}")&&(this.vars[g]=l=this._swapSelfInParams(l,this));else if(R[g]&&(j=new R[g])._onInitTween(b,this.vars[g],this,f)){for(this._firstPT=k={_next:this._firstPT,t:j,p:"setRatio",s:0,c:1,f:1,n:g,pg:1,pr:j._priority,m:0},h=j._overwriteProps.length;--h>-1;)c[j._overwriteProps[h]]=this._firstPT;(j._priority||j._onInitAllProps)&&(i=!0),(j._onDisable||j._onEnable)&&(this._notifyPluginsOfEnabled=!0),k._next&&(k._next._prev=k)}else c[g]=P.call(this,b,g,"get",l,g,0,null,this.vars.stringFilter,f);return e&&this._kill(e,b)?this._initProps(b,c,d,e,f):this._overwrite>1&&this._firstPT&&d.length>1&&aa(b,this,c,this._overwrite,d)?(this._kill(c,b),this._initProps(b,c,d,e,f)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(K[b._gsTweenID]=!0),i)},h.render=function(a,b,c){var d,e,f,g,h=this._time,i=this._duration,j=this._rawPrevTime;if(a>=i-1e-7&&a>=0)this._totalTime=this._time=i,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(d=!0,e="onComplete",c=c||this._timeline.autoRemoveChildren),0===i&&(this._initted||!this.vars.lazy||c)&&(this._startTime===this._timeline._duration&&(a=0),(0>j||0>=a&&a>=-1e-7||j===m&&"isPause"!==this.data)&&j!==a&&(c=!0,j>m&&(e="onReverseComplete")),this._rawPrevTime=g=!b||a||j===a?a:m);else if(1e-7>a)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==h||0===i&&j>0)&&(e="onReverseComplete",d=this._reversed),0>a&&(this._active=!1,0===i&&(this._initted||!this.vars.lazy||c)&&(j>=0&&(j!==m||"isPause"!==this.data)&&(c=!0),this._rawPrevTime=g=!b||a||j===a?a:m)),(!this._initted||this._startAt&&this._startAt.progress())&&(c=!0);else if(this._totalTime=this._time=a,this._easeType){var k=a/i,l=this._easeType,n=this._easePower;(1===l||3===l&&k>=.5)&&(k=1-k),3===l&&(k*=2),1===n?k*=k:2===n?k*=k*k:3===n?k*=k*k*k:4===n&&(k*=k*k*k*k),1===l?this.ratio=1-k:2===l?this.ratio=k:.5>a/i?this.ratio=k/2:this.ratio=1-k/2}else this.ratio=this._ease.getRatio(a/i);if(this._time!==h||c){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!c&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=h,this._rawPrevTime=j,J.push(this),void(this._lazy=[a,b]);this._time&&!d?this.ratio=this._ease.getRatio(this._time/i):d&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==h&&a>=0&&(this._active=!0),0===h&&(this._startAt&&(a>=0?this._startAt.render(a,!0,c):e||(e="_dummyGS")),this.vars.onStart&&(0!==this._time||0===i)&&(b||this._callback("onStart"))),f=this._firstPT;f;)f.f?f.t[f.p](f.c*this.ratio+f.s):f.t[f.p]=f.c*this.ratio+f.s,f=f._next;this._onUpdate&&(0>a&&this._startAt&&a!==-1e-4&&this._startAt.render(a,!0,c),b||(this._time!==h||d||c)&&this._callback("onUpdate")),e&&(!this._gc||c)&&(0>a&&this._startAt&&!this._onUpdate&&a!==-1e-4&&this._startAt.render(a,!0,c),d&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!b&&this.vars[e]&&this._callback(e),0===i&&this._rawPrevTime===m&&g!==m&&(this._rawPrevTime=0))}},h._kill=function(a,b,c){if("all"===a&&(a=null),null==a&&(null==b||b===this.target))return this._lazy=!1,this._enabled(!1,!1);b="string"!=typeof b?b||this._targets||this.target:G.selector(b)||b;var d,e,f,g,h,i,j,k,l,m=c&&this._time&&c._startTime===this._startTime&&this._timeline===c._timeline;if((p(b)||H(b))&&"number"!=typeof b[0])for(d=b.length;--d>-1;)this._kill(a,b[d],c)&&(i=!0);else{if(this._targets){for(d=this._targets.length;--d>-1;)if(b===this._targets[d]){h=this._propLookup[d]||{},this._overwrittenProps=this._overwrittenProps||[],e=this._overwrittenProps[d]=a?this._overwrittenProps[d]||{}:"all";break}}else{if(b!==this.target)return!1;h=this._propLookup,e=this._overwrittenProps=a?this._overwrittenProps||{}:"all"}if(h){if(j=a||h,k=a!==e&&"all"!==e&&a!==h&&("object"!=typeof a||!a._tempKill),c&&(G.onOverwrite||this.vars.onOverwrite)){for(f in j)h[f]&&(l||(l=[]),l.push(f));if((l||!a)&&!_(this,c,b,l))return!1}for(f in j)(g=h[f])&&(m&&(g.f?g.t[g.p](g.s):g.t[g.p]=g.s,i=!0),g.pg&&g.t._kill(j)&&(i=!0),g.pg&&0!==g.t._overwriteProps.length||(g._prev?g._prev._next=g._next:g===this._firstPT&&(this._firstPT=g._next),g._next&&(g._next._prev=g._prev),g._next=g._prev=null),delete h[f]),k&&(e[f]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return i},h.invalidate=function(){return this._notifyPluginsOfEnabled&&G._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],D.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-m,this.render(Math.min(0,-this._delay))),this},h._enabled=function(a,b){if(j||i.wake(),a&&this._gc){var c,d=this._targets;if(d)for(c=d.length;--c>-1;)this._siblings[c]=$(d[c],this,!0);else this._siblings=$(this.target,this,!0)}return D.prototype._enabled.call(this,a,b),this._notifyPluginsOfEnabled&&this._firstPT?G._onPluginEvent(a?"_onEnable":"_onDisable",this):!1},G.to=function(a,b,c){return new G(a,b,c)},G.from=function(a,b,c){return c.runBackwards=!0,c.immediateRender=0!=c.immediateRender,new G(a,b,c)},G.fromTo=function(a,b,c,d){return d.startAt=c,d.immediateRender=0!=d.immediateRender&&0!=c.immediateRender,new G(a,b,d)},G.delayedCall=function(a,b,c,d,e){return new G(b,0,{delay:a,onComplete:b,onCompleteParams:c,callbackScope:d,onReverseComplete:b,onReverseCompleteParams:c,immediateRender:!1,lazy:!1,useFrames:e,overwrite:0})},G.set=function(a,b){return new G(a,0,b)},G.getTweensOf=function(a,b){if(null==a)return[];a="string"!=typeof a?a:G.selector(a)||a;var c,d,e,f;if((p(a)||H(a))&&"number"!=typeof a[0]){for(c=a.length,d=[];--c>-1;)d=d.concat(G.getTweensOf(a[c],b));for(c=d.length;--c>-1;)for(f=d[c],e=c;--e>-1;)f===d[e]&&d.splice(c,1)}else if(a._gsTweenID)for(d=$(a).concat(),c=d.length;--c>-1;)(d[c]._gc||b&&!d[c].isActive())&&d.splice(c,1);return d||[]},G.killTweensOf=G.killDelayedCallsTo=function(a,b,c){"object"==typeof b&&(c=b,b=!1);for(var d=G.getTweensOf(a,b),e=d.length;--e>-1;)d[e]._kill(c,a)};var ca=t("plugins.TweenPlugin",function(a,b){this._overwriteProps=(a||"").split(","),this._propName=this._overwriteProps[0],this._priority=b||0,this._super=ca.prototype},!0);if(h=ca.prototype,ca.version="1.19.0",ca.API=2,h._firstPT=null,h._addTween=P,h.setRatio=N,h._kill=function(a){var b,c=this._overwriteProps,d=this._firstPT;if(null!=a[this._propName])this._overwriteProps=[];else for(b=c.length;--b>-1;)null!=a[c[b]]&&c.splice(b,1);for(;d;)null!=a[d.n]&&(d._next&&(d._next._prev=d._prev),d._prev?(d._prev._next=d._next,d._prev=null):this._firstPT===d&&(this._firstPT=d._next)),d=d._next;return!1},h._mod=h._roundProps=function(a){for(var b,c=this._firstPT;c;)b=a[this._propName]||null!=c.n&&a[c.n.split(this._propName+"_").join("")],b&&"function"==typeof b&&(2===c.f?c.t._applyPT.m=b:c.m=b),c=c._next},G._onPluginEvent=function(a,b){var c,d,e,f,g,h=b._firstPT;if("_onInitAllProps"===a){for(;h;){for(g=h._next,d=e;d&&d.pr>h.pr;)d=d._next;(h._prev=d?d._prev:f)?h._prev._next=h:e=h,(h._next=d)?d._prev=h:f=h,h=g}h=b._firstPT=e}for(;h;)h.pg&&"function"==typeof h.t[a]&&h.t[a]()&&(c=!0),h=h._next;return c},ca.activate=function(a){for(var b=a.length;--b>-1;)a[b].API===ca.API&&(R[(new a[b])._propName]=a[b]);return!0},s.plugin=function(a){if(!(a&&a.propName&&a.init&&a.API))throw"illegal plugin definition.";var b,c=a.propName,d=a.priority||0,e=a.overwriteProps,f={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},g=t("plugins."+c.charAt(0).toUpperCase()+c.substr(1)+"Plugin",function(){ca.call(this,c,d),this._overwriteProps=e||[]},a.global===!0),h=g.prototype=new ca(c);h.constructor=g,g.API=a.API;for(b in f)"function"==typeof a[b]&&(h[f[b]]=a[b]);return g.version=a.version,ca.activate([g]),g},f=a._gsQueue){for(g=0;g<f.length;g++)f[g]();for(h in q)q[h].func||a.console.log("GSAP encountered missing dependency: "+h)}j=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenLite");
/*!
 * VERSION: 0.2.2
 * DATE: 2018-02-15
 * UPDATES AND DOCS AT: http://greensock.com
 *
 * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
 * This work is subject to the terms at http://greensock.com/standard-license or for
 * Club GreenSock members, the software agreement that was issued with your membership.
 * 
 * @author: Jack Doyle, jack@greensock.com
 **/
var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";var a,b,c=/(\d|\.)+/g,d=["redMultiplier","greenMultiplier","blueMultiplier","alphaMultiplier","redOffset","greenOffset","blueOffset","alphaOffset"],e={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},f=function(a){return""===a||null==a||"none"===a?e.transparent:e[a]?e[a]:"number"==typeof a?[a>>16,a>>8&255,255&a]:"#"===a.charAt(0)?(4===a.length&&(a="#"+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2)+a.charAt(3)+a.charAt(3)),a=parseInt(a.substr(1),16),[a>>16,a>>8&255,255&a]):a.match(c)||e.transparent},g=function(b,c,e){if(!a&&(a=_gsScope.ColorFilter||_gsScope.createjs.ColorFilter,!a))throw"EaselPlugin error: The EaselJS ColorFilter JavaScript file wasn't loaded.";for(var g,h,i,j,k,l=b.filters||[],m=l.length;--m>-1;)if(l[m]instanceof a){h=l[m];break}if(h||(h=new a,l.push(h),b.filters=l),i=h.clone(),null!=c.tint)g=f(c.tint),j=null!=c.tintAmount?Number(c.tintAmount):1,i.redOffset=Number(g[0])*j,i.greenOffset=Number(g[1])*j,i.blueOffset=Number(g[2])*j,i.redMultiplier=i.greenMultiplier=i.blueMultiplier=1-j;else for(k in c)"exposure"!==k&&"brightness"!==k&&(i[k]=Number(c[k]));for(null!=c.exposure?(i.redOffset=i.greenOffset=i.blueOffset=255*(Number(c.exposure)-1),i.redMultiplier=i.greenMultiplier=i.blueMultiplier=1):null!=c.brightness&&(j=Number(c.brightness)-1,i.redOffset=i.greenOffset=i.blueOffset=j>0?255*j:0,i.redMultiplier=i.greenMultiplier=i.blueMultiplier=1-Math.abs(j)),m=8;--m>-1;)k=d[m],h[k]!==i[k]&&e._addTween(h,k,h[k],i[k],"easel_colorFilter");if(e._overwriteProps.push("easel_colorFilter"),!b.cacheID)throw"EaselPlugin warning: for filters to display in EaselJS, you must call the object's cache() method first. "+b},h=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],i=.212671,j=.71516,k=.072169,l=function(a,b){if(!(a instanceof Array&&b instanceof Array))return b;var c,d,e=[],f=0,g=0;for(c=0;4>c;c++){for(d=0;5>d;d++)g=4===d?a[f+4]:0,e[f+d]=a[f]*b[d]+a[f+1]*b[d+5]+a[f+2]*b[d+10]+a[f+3]*b[d+15]+g;f+=5}return e},m=function(a,b){if(isNaN(b))return a;var c=1-b,d=c*i,e=c*j,f=c*k;return l([d+b,e,f,0,0,d,e+b,f,0,0,d,e,f+b,0,0,0,0,0,1,0],a)},n=function(a,b,c){isNaN(c)&&(c=1);var d=f(b),e=d[0]/255,g=d[1]/255,h=d[2]/255,m=1-c;return l([m+c*e*i,c*e*j,c*e*k,0,0,c*g*i,m+c*g*j,c*g*k,0,0,c*h*i,c*h*j,m+c*h*k,0,0,0,0,0,1,0],a)},o=function(a,b){if(isNaN(b))return a;b*=Math.PI/180;var c=Math.cos(b),d=Math.sin(b);return l([i+c*(1-i)+d*-i,j+c*-j+d*-j,k+c*-k+d*(1-k),0,0,i+c*-i+.143*d,j+c*(1-j)+.14*d,k+c*-k+d*-.283,0,0,i+c*-i+d*-(1-i),j+c*-j+d*j,k+c*(1-k)+d*k,0,0,0,0,0,1,0,0,0,0,0,1],a)},p=function(a,b){return isNaN(b)?a:(b+=.01,l([b,0,0,0,128*(1-b),0,b,0,0,128*(1-b),0,0,b,0,128*(1-b),0,0,0,1,0],a))},q=function(a,c,d){if(!b&&(b=_gsScope.ColorMatrixFilter||_gsScope.createjs.ColorMatrixFilter,!b))throw"EaselPlugin error: The EaselJS ColorMatrixFilter JavaScript file wasn't loaded.";for(var e,f,g,i=a.filters||[],j=i.length;--j>-1;)if(i[j]instanceof b){g=i[j];break}for(g||(g=new b(h.slice()),i.push(g),a.filters=i),f=g.matrix,e=h.slice(),null!=c.colorize&&(e=n(e,c.colorize,Number(c.colorizeAmount))),null!=c.contrast&&(e=p(e,Number(c.contrast))),null!=c.hue&&(e=o(e,Number(c.hue))),null!=c.saturation&&(e=m(e,Number(c.saturation))),j=e.length;--j>-1;)e[j]!==f[j]&&d._addTween(f,j,f[j],e[j],"easel_colorMatrixFilter");if(d._overwriteProps.push("easel_colorMatrixFilter"),!a.cacheID)throw"EaselPlugin warning: for filters to display in EaselJS, you must call the object's cache() method first. "+a;d._matrix=f};_gsScope._gsDefine.plugin({propName:"easel",priority:-1,version:"0.2.2",API:2,init:function(a,b,c,d){this._target=a;var e,f,h,i,j,k,l;for(e in b)if(j=b[e],"function"==typeof j&&(j=j(d,a)),"colorFilter"===e||"tint"===e||"tintAmount"===e||"exposure"===e||"brightness"===e)h||(g(a,b.colorFilter||b,this),h=!0);else if("saturation"===e||"contrast"===e||"hue"===e||"colorize"===e||"colorizeAmount"===e)i||(q(a,b.colorMatrixFilter||b,this),i=!0);else if("frame"===e){if(this._firstPT=f={_next:this._firstPT,t:a,p:"gotoAndStop",s:a.currentFrame,f:!0,n:"frame",pr:0,type:0,m:Math.round},"string"==typeof j&&"="!==j.charAt(1)&&(k=a.labels))for(l=0;l<k.length;l++)k[l].label===j&&(j=k[l].position);f.c="number"==typeof j?j-f.s:parseFloat((j+"").split("=").join("")),f._next&&(f._next._prev=f)}else null!=a[e]&&(this._firstPT=f={_next:this._firstPT,t:a,p:e,f:"function"==typeof a[e],n:e,pr:0,type:0},f.s=f.f?a[e.indexOf("set")||"function"!=typeof a["get"+e.substr(3)]?e:"get"+e.substr(3)]():parseFloat(a[e]),f.c="number"==typeof j?j-f.s:"string"==typeof j?parseFloat(j.split("=").join("")):0,f._next&&(f._next._prev=f));return!0},set:function(a){for(var b,c=this._firstPT,d=1e-6;c;)b=c.c*a+c.s,c.m?b=c.m(b,c.t):d>b&&b>-d&&(b=0),c.f?c.t[c.p](b):c.t[c.p]=b,c=c._next;this._target.cacheID&&this._target.updateCache()}})}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(a){"use strict";var b=function(){return(_gsScope.GreenSockGlobals||_gsScope)[a]};"undefined"!=typeof module&&module.exports?(require("../TweenLite.min.js"),module.exports=b()):"function"==typeof define&&define.amd&&define(["TweenLite"],b)}("EaselPlugin");
/*!
 * VERSION: 1.20.4
 * DATE: 2018-02-15
 * UPDATES AND DOCS AT: http://greensock.com
 *
 * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
 * This work is subject to the terms at http://greensock.com/standard-license or for
 * Club GreenSock members, the software agreement that was issued with your membership.
 * 
 * @author: Jack Doyle, jack@greensock.com
 */
var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(a,b){var c,d,e,f,g=function(){a.call(this,"css"),this._overwriteProps.length=0,this.setRatio=g.prototype.setRatio},h=_gsScope._gsDefine.globals,i={},j=g.prototype=new a("css");j.constructor=g,g.version="1.20.4",g.API=2,g.defaultTransformPerspective=0,g.defaultSkewType="compensated",g.defaultSmoothOrigin=!0,j="px",g.suffixMap={top:j,right:j,bottom:j,left:j,width:j,height:j,fontSize:j,padding:j,margin:j,perspective:j,lineHeight:""};var k,l,m,n,o,p,q,r,s=/(?:\-|\.|\b)(\d|\.|e\-)+/g,t=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,u=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,v=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,w=/(?:\d|\-|\+|=|#|\.)*/g,x=/opacity *= *([^)]*)/i,y=/opacity:([^;]*)/i,z=/alpha\(opacity *=.+?\)/i,A=/^(rgb|hsl)/,B=/([A-Z])/g,C=/-([a-z])/gi,D=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,E=function(a,b){return b.toUpperCase()},F=/(?:Left|Right|Width)/i,G=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,H=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,I=/,(?=[^\)]*(?:\(|$))/gi,J=/[\s,\(]/i,K=Math.PI/180,L=180/Math.PI,M={},N={style:{}},O=_gsScope.document||{createElement:function(){return N}},P=function(a,b){return O.createElementNS?O.createElementNS(b||"http://www.w3.org/1999/xhtml",a):O.createElement(a)},Q=P("div"),R=P("img"),S=g._internals={_specialProps:i},T=(_gsScope.navigator||{}).userAgent||"",U=function(){var a=T.indexOf("Android"),b=P("a");return m=-1!==T.indexOf("Safari")&&-1===T.indexOf("Chrome")&&(-1===a||parseFloat(T.substr(a+8,2))>3),o=m&&parseFloat(T.substr(T.indexOf("Version/")+8,2))<6,n=-1!==T.indexOf("Firefox"),(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(T)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(T))&&(p=parseFloat(RegExp.$1)),b?(b.style.cssText="top:1px;opacity:.55;",/^0.55/.test(b.style.opacity)):!1}(),V=function(a){return x.test("string"==typeof a?a:(a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100:1},W=function(a){_gsScope.console&&console.log(a)},X="",Y="",Z=function(a,b){b=b||Q;var c,d,e=b.style;if(void 0!==e[a])return a;for(a=a.charAt(0).toUpperCase()+a.substr(1),c=["O","Moz","ms","Ms","Webkit"],d=5;--d>-1&&void 0===e[c[d]+a];);return d>=0?(Y=3===d?"ms":c[d],X="-"+Y.toLowerCase()+"-",Y+a):null},$=O.defaultView?O.defaultView.getComputedStyle:function(){},_=g.getStyle=function(a,b,c,d,e){var f;return U||"opacity"!==b?(!d&&a.style[b]?f=a.style[b]:(c=c||$(a))?f=c[b]||c.getPropertyValue(b)||c.getPropertyValue(b.replace(B,"-$1").toLowerCase()):a.currentStyle&&(f=a.currentStyle[b]),null==e||f&&"none"!==f&&"auto"!==f&&"auto auto"!==f?f:e):V(a)},aa=S.convertToPixels=function(a,c,d,e,f){if("px"===e||!e&&"lineHeight"!==c)return d;if("auto"===e||!d)return 0;var h,i,j,k=F.test(c),l=a,m=Q.style,n=0>d,o=1===d;if(n&&(d=-d),o&&(d*=100),"lineHeight"!==c||e)if("%"===e&&-1!==c.indexOf("border"))h=d/100*(k?a.clientWidth:a.clientHeight);else{if(m.cssText="border:0 solid red;position:"+_(a,"position")+";line-height:0;","%"!==e&&l.appendChild&&"v"!==e.charAt(0)&&"rem"!==e)m[k?"borderLeftWidth":"borderTopWidth"]=d+e;else{if(l=a.parentNode||O.body,-1!==_(l,"display").indexOf("flex")&&(m.position="absolute"),i=l._gsCache,j=b.ticker.frame,i&&k&&i.time===j)return i.width*d/100;m[k?"width":"height"]=d+e}l.appendChild(Q),h=parseFloat(Q[k?"offsetWidth":"offsetHeight"]),l.removeChild(Q),k&&"%"===e&&g.cacheWidths!==!1&&(i=l._gsCache=l._gsCache||{},i.time=j,i.width=h/d*100),0!==h||f||(h=aa(a,c,d,e,!0))}else i=$(a).lineHeight,a.style.lineHeight=d,h=parseFloat($(a).lineHeight),a.style.lineHeight=i;return o&&(h/=100),n?-h:h},ba=S.calculateOffset=function(a,b,c){if("absolute"!==_(a,"position",c))return 0;var d="left"===b?"Left":"Top",e=_(a,"margin"+d,c);return a["offset"+d]-(aa(a,b,parseFloat(e),e.replace(w,""))||0)},ca=function(a,b){var c,d,e,f={};if(b=b||$(a,null))if(c=b.length)for(;--c>-1;)e=b[c],(-1===e.indexOf("-transform")||Da===e)&&(f[e.replace(C,E)]=b.getPropertyValue(e));else for(c in b)(-1===c.indexOf("Transform")||Ca===c)&&(f[c]=b[c]);else if(b=a.currentStyle||a.style)for(c in b)"string"==typeof c&&void 0===f[c]&&(f[c.replace(C,E)]=b[c]);return U||(f.opacity=V(a)),d=Ra(a,b,!1),f.rotation=d.rotation,f.skewX=d.skewX,f.scaleX=d.scaleX,f.scaleY=d.scaleY,f.x=d.x,f.y=d.y,Fa&&(f.z=d.z,f.rotationX=d.rotationX,f.rotationY=d.rotationY,f.scaleZ=d.scaleZ),f.filters&&delete f.filters,f},da=function(a,b,c,d,e){var f,g,h,i={},j=a.style;for(g in c)"cssText"!==g&&"length"!==g&&isNaN(g)&&(b[g]!==(f=c[g])||e&&e[g])&&-1===g.indexOf("Origin")&&("number"==typeof f||"string"==typeof f)&&(i[g]="auto"!==f||"left"!==g&&"top"!==g?""!==f&&"auto"!==f&&"none"!==f||"string"!=typeof b[g]||""===b[g].replace(v,"")?f:0:ba(a,g),void 0!==j[g]&&(h=new sa(j,g,j[g],h)));if(d)for(g in d)"className"!==g&&(i[g]=d[g]);return{difs:i,firstMPT:h}},ea={width:["Left","Right"],height:["Top","Bottom"]},fa=["marginLeft","marginRight","marginTop","marginBottom"],ga=function(a,b,c){if("svg"===(a.nodeName+"").toLowerCase())return(c||$(a))[b]||0;if(a.getCTM&&Oa(a))return a.getBBox()[b]||0;var d=parseFloat("width"===b?a.offsetWidth:a.offsetHeight),e=ea[b],f=e.length;for(c=c||$(a,null);--f>-1;)d-=parseFloat(_(a,"padding"+e[f],c,!0))||0,d-=parseFloat(_(a,"border"+e[f]+"Width",c,!0))||0;return d},ha=function(a,b){if("contain"===a||"auto"===a||"auto auto"===a)return a+" ";(null==a||""===a)&&(a="0 0");var c,d=a.split(" "),e=-1!==a.indexOf("left")?"0%":-1!==a.indexOf("right")?"100%":d[0],f=-1!==a.indexOf("top")?"0%":-1!==a.indexOf("bottom")?"100%":d[1];if(d.length>3&&!b){for(d=a.split(", ").join(",").split(","),a=[],c=0;c<d.length;c++)a.push(ha(d[c]));return a.join(",")}return null==f?f="center"===e?"50%":"0":"center"===f&&(f="50%"),("center"===e||isNaN(parseFloat(e))&&-1===(e+"").indexOf("="))&&(e="50%"),a=e+" "+f+(d.length>2?" "+d[2]:""),b&&(b.oxp=-1!==e.indexOf("%"),b.oyp=-1!==f.indexOf("%"),b.oxr="="===e.charAt(1),b.oyr="="===f.charAt(1),b.ox=parseFloat(e.replace(v,"")),b.oy=parseFloat(f.replace(v,"")),b.v=a),b||a},ia=function(a,b){return"function"==typeof a&&(a=a(r,q)),"string"==typeof a&&"="===a.charAt(1)?parseInt(a.charAt(0)+"1",10)*parseFloat(a.substr(2)):parseFloat(a)-parseFloat(b)||0},ja=function(a,b){return"function"==typeof a&&(a=a(r,q)),null==a?b:"string"==typeof a&&"="===a.charAt(1)?parseInt(a.charAt(0)+"1",10)*parseFloat(a.substr(2))+b:parseFloat(a)||0},ka=function(a,b,c,d){var e,f,g,h,i,j=1e-6;return"function"==typeof a&&(a=a(r,q)),null==a?h=b:"number"==typeof a?h=a:(e=360,f=a.split("_"),i="="===a.charAt(1),g=(i?parseInt(a.charAt(0)+"1",10)*parseFloat(f[0].substr(2)):parseFloat(f[0]))*(-1===a.indexOf("rad")?1:L)-(i?0:b),f.length&&(d&&(d[c]=b+g),-1!==a.indexOf("short")&&(g%=e,g!==g%(e/2)&&(g=0>g?g+e:g-e)),-1!==a.indexOf("_cw")&&0>g?g=(g+9999999999*e)%e-(g/e|0)*e:-1!==a.indexOf("ccw")&&g>0&&(g=(g-9999999999*e)%e-(g/e|0)*e)),h=b+g),j>h&&h>-j&&(h=0),h},la={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},ma=function(a,b,c){return a=0>a?a+1:a>1?a-1:a,255*(1>6*a?b+(c-b)*a*6:.5>a?c:2>3*a?b+(c-b)*(2/3-a)*6:b)+.5|0},na=g.parseColor=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;if(a)if("number"==typeof a)c=[a>>16,a>>8&255,255&a];else{if(","===a.charAt(a.length-1)&&(a=a.substr(0,a.length-1)),la[a])c=la[a];else if("#"===a.charAt(0))4===a.length&&(d=a.charAt(1),e=a.charAt(2),f=a.charAt(3),a="#"+d+d+e+e+f+f),a=parseInt(a.substr(1),16),c=[a>>16,a>>8&255,255&a];else if("hsl"===a.substr(0,3))if(c=m=a.match(s),b){if(-1!==a.indexOf("="))return a.match(t)}else g=Number(c[0])%360/360,h=Number(c[1])/100,i=Number(c[2])/100,e=.5>=i?i*(h+1):i+h-i*h,d=2*i-e,c.length>3&&(c[3]=Number(c[3])),c[0]=ma(g+1/3,d,e),c[1]=ma(g,d,e),c[2]=ma(g-1/3,d,e);else c=a.match(s)||la.transparent;c[0]=Number(c[0]),c[1]=Number(c[1]),c[2]=Number(c[2]),c.length>3&&(c[3]=Number(c[3]))}else c=la.black;return b&&!m&&(d=c[0]/255,e=c[1]/255,f=c[2]/255,j=Math.max(d,e,f),k=Math.min(d,e,f),i=(j+k)/2,j===k?g=h=0:(l=j-k,h=i>.5?l/(2-j-k):l/(j+k),g=j===d?(e-f)/l+(f>e?6:0):j===e?(f-d)/l+2:(d-e)/l+4,g*=60),c[0]=g+.5|0,c[1]=100*h+.5|0,c[2]=100*i+.5|0),c},oa=function(a,b){var c,d,e,f=a.match(pa)||[],g=0,h="";if(!f.length)return a;for(c=0;c<f.length;c++)d=f[c],e=a.substr(g,a.indexOf(d,g)-g),g+=e.length+d.length,d=na(d,b),3===d.length&&d.push(1),h+=e+(b?"hsla("+d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:"rgba("+d.join(","))+")";return h+a.substr(g)},pa="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(j in la)pa+="|"+j+"\\b";pa=new RegExp(pa+")","gi"),g.colorStringFilter=function(a){var b,c=a[0]+" "+a[1];pa.test(c)&&(b=-1!==c.indexOf("hsl(")||-1!==c.indexOf("hsla("),a[0]=oa(a[0],b),a[1]=oa(a[1],b)),pa.lastIndex=0},b.defaultStringFilter||(b.defaultStringFilter=g.colorStringFilter);var qa=function(a,b,c,d){if(null==a)return function(a){return a};var e,f=b?(a.match(pa)||[""])[0]:"",g=a.split(f).join("").match(u)||[],h=a.substr(0,a.indexOf(g[0])),i=")"===a.charAt(a.length-1)?")":"",j=-1!==a.indexOf(" ")?" ":",",k=g.length,l=k>0?g[0].replace(s,""):"";return k?e=b?function(a){var b,m,n,o;if("number"==typeof a)a+=l;else if(d&&I.test(a)){for(o=a.replace(I,"|").split("|"),n=0;n<o.length;n++)o[n]=e(o[n]);return o.join(",")}if(b=(a.match(pa)||[f])[0],m=a.split(b).join("").match(u)||[],n=m.length,k>n--)for(;++n<k;)m[n]=c?m[(n-1)/2|0]:g[n];return h+m.join(j)+j+b+i+(-1!==a.indexOf("inset")?" inset":"")}:function(a){var b,f,m;if("number"==typeof a)a+=l;else if(d&&I.test(a)){for(f=a.replace(I,"|").split("|"),m=0;m<f.length;m++)f[m]=e(f[m]);return f.join(",")}if(b=a.match(u)||[],m=b.length,k>m--)for(;++m<k;)b[m]=c?b[(m-1)/2|0]:g[m];return h+b.join(j)+i}:function(a){return a}},ra=function(a){return a=a.split(","),function(b,c,d,e,f,g,h){var i,j=(c+"").split(" ");for(h={},i=0;4>i;i++)h[a[i]]=j[i]=j[i]||j[(i-1)/2>>0];return e.parse(b,h,f,g)}},sa=(S._setPluginRatio=function(a){this.plugin.setRatio(a);for(var b,c,d,e,f,g=this.data,h=g.proxy,i=g.firstMPT,j=1e-6;i;)b=h[i.v],i.r?b=Math.round(b):j>b&&b>-j&&(b=0),i.t[i.p]=b,i=i._next;if(g.autoRotate&&(g.autoRotate.rotation=g.mod?g.mod(h.rotation,this.t):h.rotation),1===a||0===a)for(i=g.firstMPT,f=1===a?"e":"b";i;){if(c=i.t,c.type){if(1===c.type){for(e=c.xs0+c.s+c.xs1,d=1;d<c.l;d++)e+=c["xn"+d]+c["xs"+(d+1)];c[f]=e}}else c[f]=c.s+c.xs0;i=i._next}},function(a,b,c,d,e){this.t=a,this.p=b,this.v=c,this.r=e,d&&(d._prev=this,this._next=d)}),ta=(S._parseToProxy=function(a,b,c,d,e,f){var g,h,i,j,k,l=d,m={},n={},o=c._transform,p=M;for(c._transform=null,M=b,d=k=c.parse(a,b,d,e),M=p,f&&(c._transform=o,l&&(l._prev=null,l._prev&&(l._prev._next=null)));d&&d!==l;){if(d.type<=1&&(h=d.p,n[h]=d.s+d.c,m[h]=d.s,f||(j=new sa(d,"s",h,j,d.r),d.c=0),1===d.type))for(g=d.l;--g>0;)i="xn"+g,h=d.p+"_"+i,n[h]=d.data[i],m[h]=d[i],f||(j=new sa(d,i,h,j,d.rxp[i]));d=d._next}return{proxy:m,end:n,firstMPT:j,pt:k}},S.CSSPropTween=function(a,b,d,e,g,h,i,j,k,l,m){this.t=a,this.p=b,this.s=d,this.c=e,this.n=i||b,a instanceof ta||f.push(this.n),this.r=j,this.type=h||0,k&&(this.pr=k,c=!0),this.b=void 0===l?d:l,this.e=void 0===m?d+e:m,g&&(this._next=g,g._prev=this)}),ua=function(a,b,c,d,e,f){var g=new ta(a,b,c,d-c,e,-1,f);return g.b=c,g.e=g.xs0=d,g},va=g.parseComplex=function(a,b,c,d,e,f,h,i,j,l){c=c||f||"","function"==typeof d&&(d=d(r,q)),h=new ta(a,b,0,0,h,l?2:1,null,!1,i,c,d),d+="",e&&pa.test(d+c)&&(d=[c,d],g.colorStringFilter(d),c=d[0],d=d[1]);var m,n,o,p,u,v,w,x,y,z,A,B,C,D=c.split(", ").join(",").split(" "),E=d.split(", ").join(",").split(" "),F=D.length,G=k!==!1;for((-1!==d.indexOf(",")||-1!==c.indexOf(","))&&(-1!==(d+c).indexOf("rgb")||-1!==(d+c).indexOf("hsl")?(D=D.join(" ").replace(I,", ").split(" "),E=E.join(" ").replace(I,", ").split(" ")):(D=D.join(" ").split(",").join(", ").split(" "),E=E.join(" ").split(",").join(", ").split(" ")),F=D.length),F!==E.length&&(D=(f||"").split(" "),F=D.length),h.plugin=j,h.setRatio=l,pa.lastIndex=0,m=0;F>m;m++)if(p=D[m],u=E[m],x=parseFloat(p),x||0===x)h.appendXtra("",x,ia(u,x),u.replace(t,""),G&&-1!==u.indexOf("px"),!0);else if(e&&pa.test(p))B=u.indexOf(")")+1,B=")"+(B?u.substr(B):""),C=-1!==u.indexOf("hsl")&&U,z=u,p=na(p,C),u=na(u,C),y=p.length+u.length>6,y&&!U&&0===u[3]?(h["xs"+h.l]+=h.l?" transparent":"transparent",h.e=h.e.split(E[m]).join("transparent")):(U||(y=!1),C?h.appendXtra(z.substr(0,z.indexOf("hsl"))+(y?"hsla(":"hsl("),p[0],ia(u[0],p[0]),",",!1,!0).appendXtra("",p[1],ia(u[1],p[1]),"%,",!1).appendXtra("",p[2],ia(u[2],p[2]),y?"%,":"%"+B,!1):h.appendXtra(z.substr(0,z.indexOf("rgb"))+(y?"rgba(":"rgb("),p[0],u[0]-p[0],",",!0,!0).appendXtra("",p[1],u[1]-p[1],",",!0).appendXtra("",p[2],u[2]-p[2],y?",":B,!0),y&&(p=p.length<4?1:p[3],h.appendXtra("",p,(u.length<4?1:u[3])-p,B,!1))),pa.lastIndex=0;else if(v=p.match(s)){if(w=u.match(t),!w||w.length!==v.length)return h;for(o=0,n=0;n<v.length;n++)A=v[n],z=p.indexOf(A,o),h.appendXtra(p.substr(o,z-o),Number(A),ia(w[n],A),"",G&&"px"===p.substr(z+A.length,2),0===n),o=z+A.length;h["xs"+h.l]+=p.substr(o)}else h["xs"+h.l]+=h.l||h["xs"+h.l]?" "+u:u;if(-1!==d.indexOf("=")&&h.data){for(B=h.xs0+h.data.s,m=1;m<h.l;m++)B+=h["xs"+m]+h.data["xn"+m];h.e=B+h["xs"+m]}return h.l||(h.type=-1,h.xs0=h.e),h.xfirst||h},wa=9;for(j=ta.prototype,j.l=j.pr=0;--wa>0;)j["xn"+wa]=0,j["xs"+wa]="";j.xs0="",j._next=j._prev=j.xfirst=j.data=j.plugin=j.setRatio=j.rxp=null,j.appendXtra=function(a,b,c,d,e,f){var g=this,h=g.l;return g["xs"+h]+=f&&(h||g["xs"+h])?" "+a:a||"",c||0===h||g.plugin?(g.l++,g.type=g.setRatio?2:1,g["xs"+g.l]=d||"",h>0?(g.data["xn"+h]=b+c,g.rxp["xn"+h]=e,g["xn"+h]=b,g.plugin||(g.xfirst=new ta(g,"xn"+h,b,c,g.xfirst||g,0,g.n,e,g.pr),g.xfirst.xs0=0),g):(g.data={s:b+c},g.rxp={},g.s=b,g.c=c,g.r=e,g)):(g["xs"+h]+=b+(d||""),g)};var xa=function(a,b){b=b||{},this.p=b.prefix?Z(a)||a:a,i[a]=i[this.p]=this,this.format=b.formatter||qa(b.defaultValue,b.color,b.collapsible,b.multi),b.parser&&(this.parse=b.parser),this.clrs=b.color,this.multi=b.multi,this.keyword=b.keyword,this.dflt=b.defaultValue,this.pr=b.priority||0},ya=S._registerComplexSpecialProp=function(a,b,c){"object"!=typeof b&&(b={parser:c});var d,e,f=a.split(","),g=b.defaultValue;for(c=c||[g],d=0;d<f.length;d++)b.prefix=0===d&&b.prefix,b.defaultValue=c[d]||g,e=new xa(f[d],b)},za=S._registerPluginProp=function(a){if(!i[a]){var b=a.charAt(0).toUpperCase()+a.substr(1)+"Plugin";ya(a,{parser:function(a,c,d,e,f,g,j){var k=h.com.greensock.plugins[b];return k?(k._cssRegister(),i[d].parse(a,c,d,e,f,g,j)):(W("Error: "+b+" js file not loaded."),f)}})}};j=xa.prototype,j.parseComplex=function(a,b,c,d,e,f){var g,h,i,j,k,l,m=this.keyword;if(this.multi&&(I.test(c)||I.test(b)?(h=b.replace(I,"|").split("|"),i=c.replace(I,"|").split("|")):m&&(h=[b],i=[c])),i){for(j=i.length>h.length?i.length:h.length,g=0;j>g;g++)b=h[g]=h[g]||this.dflt,c=i[g]=i[g]||this.dflt,m&&(k=b.indexOf(m),l=c.indexOf(m),k!==l&&(-1===l?h[g]=h[g].split(m).join(""):-1===k&&(h[g]+=" "+m)));b=h.join(", "),c=i.join(", ")}return va(a,this.p,b,c,this.clrs,this.dflt,d,this.pr,e,f)},j.parse=function(a,b,c,d,f,g,h){return this.parseComplex(a.style,this.format(_(a,this.p,e,!1,this.dflt)),this.format(b),f,g)},g.registerSpecialProp=function(a,b,c){ya(a,{parser:function(a,d,e,f,g,h,i){var j=new ta(a,e,0,0,g,2,e,!1,c);return j.plugin=h,j.setRatio=b(a,d,f._tween,e),j},priority:c})},g.useSVGTransformAttr=!0;var Aa,Ba="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),Ca=Z("transform"),Da=X+"transform",Ea=Z("transformOrigin"),Fa=null!==Z("perspective"),Ga=S.Transform=function(){this.perspective=parseFloat(g.defaultTransformPerspective)||0,this.force3D=g.defaultForce3D!==!1&&Fa?g.defaultForce3D||"auto":!1},Ha=_gsScope.SVGElement,Ia=function(a,b,c){var d,e=O.createElementNS("http://www.w3.org/2000/svg",a),f=/([a-z])([A-Z])/g;for(d in c)e.setAttributeNS(null,d.replace(f,"$1-$2").toLowerCase(),c[d]);return b.appendChild(e),e},Ja=O.documentElement||{},Ka=function(){var a,b,c,d=p||/Android/i.test(T)&&!_gsScope.chrome;return O.createElementNS&&!d&&(a=Ia("svg",Ja),b=Ia("rect",a,{width:100,height:50,x:100}),c=b.getBoundingClientRect().width,b.style[Ea]="50% 50%",b.style[Ca]="scaleX(0.5)",d=c===b.getBoundingClientRect().width&&!(n&&Fa),Ja.removeChild(a)),d}(),La=function(a,b,c,d,e,f){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=a._gsTransform,w=Qa(a,!0);v&&(t=v.xOrigin,u=v.yOrigin),(!d||(h=d.split(" ")).length<2)&&(n=a.getBBox(),0===n.x&&0===n.y&&n.width+n.height===0&&(n={x:parseFloat(a.hasAttribute("x")?a.getAttribute("x"):a.hasAttribute("cx")?a.getAttribute("cx"):0)||0,y:parseFloat(a.hasAttribute("y")?a.getAttribute("y"):a.hasAttribute("cy")?a.getAttribute("cy"):0)||0,width:0,height:0}),b=ha(b).split(" "),h=[(-1!==b[0].indexOf("%")?parseFloat(b[0])/100*n.width:parseFloat(b[0]))+n.x,(-1!==b[1].indexOf("%")?parseFloat(b[1])/100*n.height:parseFloat(b[1]))+n.y]),c.xOrigin=k=parseFloat(h[0]),c.yOrigin=l=parseFloat(h[1]),d&&w!==Pa&&(m=w[0],n=w[1],o=w[2],p=w[3],q=w[4],r=w[5],s=m*p-n*o,s&&(i=k*(p/s)+l*(-o/s)+(o*r-p*q)/s,j=k*(-n/s)+l*(m/s)-(m*r-n*q)/s,k=c.xOrigin=h[0]=i,l=c.yOrigin=h[1]=j)),v&&(f&&(c.xOffset=v.xOffset,c.yOffset=v.yOffset,v=c),e||e!==!1&&g.defaultSmoothOrigin!==!1?(i=k-t,j=l-u,v.xOffset+=i*w[0]+j*w[2]-i,v.yOffset+=i*w[1]+j*w[3]-j):v.xOffset=v.yOffset=0),f||a.setAttribute("data-svg-origin",h.join(" "))},Ma=function(a){var b,c=P("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),d=this.parentNode,e=this.nextSibling,f=this.style.cssText;if(Ja.appendChild(c),c.appendChild(this),this.style.display="block",a)try{b=this.getBBox(),this._originalGetBBox=this.getBBox,this.getBBox=Ma}catch(g){}else this._originalGetBBox&&(b=this._originalGetBBox());return e?d.insertBefore(this,e):d.appendChild(this),Ja.removeChild(c),this.style.cssText=f,b},Na=function(a){try{return a.getBBox()}catch(b){return Ma.call(a,!0)}},Oa=function(a){return!(!Ha||!a.getCTM||a.parentNode&&!a.ownerSVGElement||!Na(a))},Pa=[1,0,0,1,0,0],Qa=function(a,b){var c,d,e,f,g,h,i=a._gsTransform||new Ga,j=1e5,k=a.style;if(Ca?d=_(a,Da,null,!0):a.currentStyle&&(d=a.currentStyle.filter.match(G),d=d&&4===d.length?[d[0].substr(4),Number(d[2].substr(4)),Number(d[1].substr(4)),d[3].substr(4),i.x||0,i.y||0].join(","):""),c=!d||"none"===d||"matrix(1, 0, 0, 1, 0, 0)"===d,!Ca||!(h=!$(a)||"none"===$(a).display)&&a.parentNode||(h&&(f=k.display,k.display="block"),a.parentNode||(g=1,Ja.appendChild(a)),d=_(a,Da,null,!0),c=!d||"none"===d||"matrix(1, 0, 0, 1, 0, 0)"===d,f?k.display=f:h&&Va(k,"display"),g&&Ja.removeChild(a)),(i.svg||a.getCTM&&Oa(a))&&(c&&-1!==(k[Ca]+"").indexOf("matrix")&&(d=k[Ca],c=0),e=a.getAttribute("transform"),c&&e&&(e=a.transform.baseVal.consolidate().matrix,d="matrix("+e.a+","+e.b+","+e.c+","+e.d+","+e.e+","+e.f+")",c=0)),c)return Pa;for(e=(d||"").match(s)||[],wa=e.length;--wa>-1;)f=Number(e[wa]),e[wa]=(g=f-(f|=0))?(g*j+(0>g?-.5:.5)|0)/j+f:f;return b&&e.length>6?[e[0],e[1],e[4],e[5],e[12],e[13]]:e},Ra=S.getTransform=function(a,c,d,e){if(a._gsTransform&&d&&!e)return a._gsTransform;var f,h,i,j,k,l,m=d?a._gsTransform||new Ga:new Ga,n=m.scaleX<0,o=2e-5,p=1e5,q=Fa?parseFloat(_(a,Ea,c,!1,"0 0 0").split(" ")[2])||m.zOrigin||0:0,r=parseFloat(g.defaultTransformPerspective)||0;if(m.svg=!(!a.getCTM||!Oa(a)),m.svg&&(La(a,_(a,Ea,c,!1,"50% 50%")+"",m,a.getAttribute("data-svg-origin")),Aa=g.useSVGTransformAttr||Ka),f=Qa(a),f!==Pa){if(16===f.length){var s,t,u,v,w,x=f[0],y=f[1],z=f[2],A=f[3],B=f[4],C=f[5],D=f[6],E=f[7],F=f[8],G=f[9],H=f[10],I=f[12],J=f[13],K=f[14],M=f[11],N=Math.atan2(D,H);m.zOrigin&&(K=-m.zOrigin,I=F*K-f[12],J=G*K-f[13],K=H*K+m.zOrigin-f[14]),m.rotationX=N*L,N&&(v=Math.cos(-N),w=Math.sin(-N),s=B*v+F*w,t=C*v+G*w,u=D*v+H*w,F=B*-w+F*v,G=C*-w+G*v,H=D*-w+H*v,M=E*-w+M*v,B=s,C=t,D=u),N=Math.atan2(-z,H),m.rotationY=N*L,N&&(v=Math.cos(-N),w=Math.sin(-N),s=x*v-F*w,t=y*v-G*w,u=z*v-H*w,G=y*w+G*v,H=z*w+H*v,M=A*w+M*v,x=s,y=t,z=u),N=Math.atan2(y,x),m.rotation=N*L,N&&(v=Math.cos(N),w=Math.sin(N),s=x*v+y*w,t=B*v+C*w,u=F*v+G*w,y=y*v-x*w,C=C*v-B*w,G=G*v-F*w,x=s,B=t,F=u),m.rotationX&&Math.abs(m.rotationX)+Math.abs(m.rotation)>359.9&&(m.rotationX=m.rotation=0,m.rotationY=180-m.rotationY),N=Math.atan2(B,C),m.scaleX=(Math.sqrt(x*x+y*y+z*z)*p+.5|0)/p,m.scaleY=(Math.sqrt(C*C+D*D)*p+.5|0)/p,m.scaleZ=(Math.sqrt(F*F+G*G+H*H)*p+.5|0)/p,x/=m.scaleX,B/=m.scaleY,y/=m.scaleX,C/=m.scaleY,Math.abs(N)>o?(m.skewX=N*L,B=0,"simple"!==m.skewType&&(m.scaleY*=1/Math.cos(N))):m.skewX=0,m.perspective=M?1/(0>M?-M:M):0,m.x=I,m.y=J,m.z=K,m.svg&&(m.x-=m.xOrigin-(m.xOrigin*x-m.yOrigin*B),m.y-=m.yOrigin-(m.yOrigin*y-m.xOrigin*C))}else if(!Fa||e||!f.length||m.x!==f[4]||m.y!==f[5]||!m.rotationX&&!m.rotationY){var O=f.length>=6,P=O?f[0]:1,Q=f[1]||0,R=f[2]||0,S=O?f[3]:1;m.x=f[4]||0,m.y=f[5]||0,i=Math.sqrt(P*P+Q*Q),j=Math.sqrt(S*S+R*R),k=P||Q?Math.atan2(Q,P)*L:m.rotation||0,l=R||S?Math.atan2(R,S)*L+k:m.skewX||0,m.scaleX=i,m.scaleY=j,m.rotation=k,m.skewX=l,Fa&&(m.rotationX=m.rotationY=m.z=0,m.perspective=r,m.scaleZ=1),m.svg&&(m.x-=m.xOrigin-(m.xOrigin*P+m.yOrigin*R),m.y-=m.yOrigin-(m.xOrigin*Q+m.yOrigin*S))}Math.abs(m.skewX)>90&&Math.abs(m.skewX)<270&&(n?(m.scaleX*=-1,m.skewX+=m.rotation<=0?180:-180,m.rotation+=m.rotation<=0?180:-180):(m.scaleY*=-1,m.skewX+=m.skewX<=0?180:-180)),m.zOrigin=q;for(h in m)m[h]<o&&m[h]>-o&&(m[h]=0)}return d&&(a._gsTransform=m,m.svg&&(Aa&&a.style[Ca]?b.delayedCall(.001,function(){Va(a.style,Ca)}):!Aa&&a.getAttribute("transform")&&b.delayedCall(.001,function(){a.removeAttribute("transform")}))),m},Sa=function(a){var b,c,d=this.data,e=-d.rotation*K,f=e+d.skewX*K,g=1e5,h=(Math.cos(e)*d.scaleX*g|0)/g,i=(Math.sin(e)*d.scaleX*g|0)/g,j=(Math.sin(f)*-d.scaleY*g|0)/g,k=(Math.cos(f)*d.scaleY*g|0)/g,l=this.t.style,m=this.t.currentStyle;if(m){c=i,i=-j,j=-c,b=m.filter,l.filter="";var n,o,q=this.t.offsetWidth,r=this.t.offsetHeight,s="absolute"!==m.position,t="progid:DXImageTransform.Microsoft.Matrix(M11="+h+", M12="+i+", M21="+j+", M22="+k,u=d.x+q*d.xPercent/100,v=d.y+r*d.yPercent/100;if(null!=d.ox&&(n=(d.oxp?q*d.ox*.01:d.ox)-q/2,o=(d.oyp?r*d.oy*.01:d.oy)-r/2,u+=n-(n*h+o*i),v+=o-(n*j+o*k)),s?(n=q/2,o=r/2,t+=", Dx="+(n-(n*h+o*i)+u)+", Dy="+(o-(n*j+o*k)+v)+")"):t+=", sizingMethod='auto expand')",-1!==b.indexOf("DXImageTransform.Microsoft.Matrix(")?l.filter=b.replace(H,t):l.filter=t+" "+b,(0===a||1===a)&&1===h&&0===i&&0===j&&1===k&&(s&&-1===t.indexOf("Dx=0, Dy=0")||x.test(b)&&100!==parseFloat(RegExp.$1)||-1===b.indexOf(b.indexOf("Alpha"))&&l.removeAttribute("filter")),!s){var y,z,A,B=8>p?1:-1;for(n=d.ieOffsetX||0,o=d.ieOffsetY||0,d.ieOffsetX=Math.round((q-((0>h?-h:h)*q+(0>i?-i:i)*r))/2+u),d.ieOffsetY=Math.round((r-((0>k?-k:k)*r+(0>j?-j:j)*q))/2+v),wa=0;4>wa;wa++)z=fa[wa],y=m[z],c=-1!==y.indexOf("px")?parseFloat(y):aa(this.t,z,parseFloat(y),y.replace(w,""))||0,A=c!==d[z]?2>wa?-d.ieOffsetX:-d.ieOffsetY:2>wa?n-d.ieOffsetX:o-d.ieOffsetY,l[z]=(d[z]=Math.round(c-A*(0===wa||2===wa?1:B)))+"px"}}},Ta=S.set3DTransformRatio=S.setTransformRatio=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z=this.data,A=this.t.style,B=z.rotation,C=z.rotationX,D=z.rotationY,E=z.scaleX,F=z.scaleY,G=z.scaleZ,H=z.x,I=z.y,J=z.z,L=z.svg,M=z.perspective,N=z.force3D,O=z.skewY,P=z.skewX;if(O&&(P+=O,B+=O),((1===a||0===a)&&"auto"===N&&(this.tween._totalTime===this.tween._totalDuration||!this.tween._totalTime)||!N)&&!J&&!M&&!D&&!C&&1===G||Aa&&L||!Fa)return void(B||P||L?(B*=K,x=P*K,y=1e5,c=Math.cos(B)*E,f=Math.sin(B)*E,d=Math.sin(B-x)*-F,g=Math.cos(B-x)*F,x&&"simple"===z.skewType&&(b=Math.tan(x-O*K),b=Math.sqrt(1+b*b),d*=b,g*=b,O&&(b=Math.tan(O*K),b=Math.sqrt(1+b*b),c*=b,f*=b)),L&&(H+=z.xOrigin-(z.xOrigin*c+z.yOrigin*d)+z.xOffset,I+=z.yOrigin-(z.xOrigin*f+z.yOrigin*g)+z.yOffset,Aa&&(z.xPercent||z.yPercent)&&(q=this.t.getBBox(),H+=.01*z.xPercent*q.width,I+=.01*z.yPercent*q.height),q=1e-6,q>H&&H>-q&&(H=0),q>I&&I>-q&&(I=0)),u=(c*y|0)/y+","+(f*y|0)/y+","+(d*y|0)/y+","+(g*y|0)/y+","+H+","+I+")",L&&Aa?this.t.setAttribute("transform","matrix("+u):A[Ca]=(z.xPercent||z.yPercent?"translate("+z.xPercent+"%,"+z.yPercent+"%) matrix(":"matrix(")+u):A[Ca]=(z.xPercent||z.yPercent?"translate("+z.xPercent+"%,"+z.yPercent+"%) matrix(":"matrix(")+E+",0,0,"+F+","+H+","+I+")");if(n&&(q=1e-4,q>E&&E>-q&&(E=G=2e-5),q>F&&F>-q&&(F=G=2e-5),!M||z.z||z.rotationX||z.rotationY||(M=0)),B||P)B*=K,r=c=Math.cos(B),s=f=Math.sin(B),P&&(B-=P*K,r=Math.cos(B),s=Math.sin(B),"simple"===z.skewType&&(b=Math.tan((P-O)*K),b=Math.sqrt(1+b*b),r*=b,s*=b,z.skewY&&(b=Math.tan(O*K),b=Math.sqrt(1+b*b),c*=b,f*=b))),d=-s,g=r;else{if(!(D||C||1!==G||M||L))return void(A[Ca]=(z.xPercent||z.yPercent?"translate("+z.xPercent+"%,"+z.yPercent+"%) translate3d(":"translate3d(")+H+"px,"+I+"px,"+J+"px)"+(1!==E||1!==F?" scale("+E+","+F+")":""));c=g=1,d=f=0}k=1,e=h=i=j=l=m=0,o=M?-1/M:0,p=z.zOrigin,q=1e-6,v=",",w="0",B=D*K,B&&(r=Math.cos(B),s=Math.sin(B),i=-s,l=o*-s,e=c*s,h=f*s,k=r,o*=r,c*=r,f*=r),B=C*K,B&&(r=Math.cos(B),s=Math.sin(B),b=d*r+e*s,t=g*r+h*s,j=k*s,m=o*s,e=d*-s+e*r,h=g*-s+h*r,k*=r,o*=r,d=b,g=t),1!==G&&(e*=G,h*=G,k*=G,o*=G),1!==F&&(d*=F,g*=F,j*=F,m*=F),1!==E&&(c*=E,f*=E,i*=E,l*=E),(p||L)&&(p&&(H+=e*-p,I+=h*-p,J+=k*-p+p),L&&(H+=z.xOrigin-(z.xOrigin*c+z.yOrigin*d)+z.xOffset,I+=z.yOrigin-(z.xOrigin*f+z.yOrigin*g)+z.yOffset),q>H&&H>-q&&(H=w),q>I&&I>-q&&(I=w),q>J&&J>-q&&(J=0)),u=z.xPercent||z.yPercent?"translate("+z.xPercent+"%,"+z.yPercent+"%) matrix3d(":"matrix3d(",u+=(q>c&&c>-q?w:c)+v+(q>f&&f>-q?w:f)+v+(q>i&&i>-q?w:i),u+=v+(q>l&&l>-q?w:l)+v+(q>d&&d>-q?w:d)+v+(q>g&&g>-q?w:g),C||D||1!==G?(u+=v+(q>j&&j>-q?w:j)+v+(q>m&&m>-q?w:m)+v+(q>e&&e>-q?w:e),u+=v+(q>h&&h>-q?w:h)+v+(q>k&&k>-q?w:k)+v+(q>o&&o>-q?w:o)+v):u+=",0,0,0,0,1,0,",u+=H+v+I+v+J+v+(M?1+-J/M:1)+")",A[Ca]=u};j=Ga.prototype,j.x=j.y=j.z=j.skewX=j.skewY=j.rotation=j.rotationX=j.rotationY=j.zOrigin=j.xPercent=j.yPercent=j.xOffset=j.yOffset=0,j.scaleX=j.scaleY=j.scaleZ=1,ya("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",{parser:function(a,b,c,d,f,h,i){if(d._lastParsedTransform===i)return f;d._lastParsedTransform=i;var j,k=i.scale&&"function"==typeof i.scale?i.scale:0;"function"==typeof i[c]&&(j=i[c],i[c]=b),k&&(i.scale=k(r,a));var l,m,n,o,p,s,t,u,v,w=a._gsTransform,x=a.style,y=1e-6,z=Ba.length,A=i,B={},C="transformOrigin",D=Ra(a,e,!0,A.parseTransform),E=A.transform&&("function"==typeof A.transform?A.transform(r,q):A.transform);if(D.skewType=A.skewType||D.skewType||g.defaultSkewType,d._transform=D,E&&"string"==typeof E&&Ca)m=Q.style,m[Ca]=E,m.display="block",m.position="absolute",O.body.appendChild(Q),l=Ra(Q,null,!1),"simple"===D.skewType&&(l.scaleY*=Math.cos(l.skewX*K)),D.svg&&(s=D.xOrigin,t=D.yOrigin,l.x-=D.xOffset,l.y-=D.yOffset,(A.transformOrigin||A.svgOrigin)&&(E={},La(a,ha(A.transformOrigin),E,A.svgOrigin,A.smoothOrigin,!0),s=E.xOrigin,t=E.yOrigin,l.x-=E.xOffset-D.xOffset,l.y-=E.yOffset-D.yOffset),(s||t)&&(u=Qa(Q,!0),l.x-=s-(s*u[0]+t*u[2]),l.y-=t-(s*u[1]+t*u[3]))),O.body.removeChild(Q),l.perspective||(l.perspective=D.perspective),null!=A.xPercent&&(l.xPercent=ja(A.xPercent,D.xPercent)),null!=A.yPercent&&(l.yPercent=ja(A.yPercent,D.yPercent));else if("object"==typeof A){if(l={scaleX:ja(null!=A.scaleX?A.scaleX:A.scale,D.scaleX),scaleY:ja(null!=A.scaleY?A.scaleY:A.scale,D.scaleY),scaleZ:ja(A.scaleZ,D.scaleZ),x:ja(A.x,D.x),y:ja(A.y,D.y),z:ja(A.z,D.z),xPercent:ja(A.xPercent,D.xPercent),yPercent:ja(A.yPercent,D.yPercent),perspective:ja(A.transformPerspective,D.perspective)},p=A.directionalRotation,null!=p)if("object"==typeof p)for(m in p)A[m]=p[m];else A.rotation=p;"string"==typeof A.x&&-1!==A.x.indexOf("%")&&(l.x=0,l.xPercent=ja(A.x,D.xPercent)),"string"==typeof A.y&&-1!==A.y.indexOf("%")&&(l.y=0,l.yPercent=ja(A.y,D.yPercent)),l.rotation=ka("rotation"in A?A.rotation:"shortRotation"in A?A.shortRotation+"_short":"rotationZ"in A?A.rotationZ:D.rotation,D.rotation,"rotation",B),Fa&&(l.rotationX=ka("rotationX"in A?A.rotationX:"shortRotationX"in A?A.shortRotationX+"_short":D.rotationX||0,D.rotationX,"rotationX",B),l.rotationY=ka("rotationY"in A?A.rotationY:"shortRotationY"in A?A.shortRotationY+"_short":D.rotationY||0,D.rotationY,"rotationY",B)),l.skewX=ka(A.skewX,D.skewX),l.skewY=ka(A.skewY,D.skewY)}for(Fa&&null!=A.force3D&&(D.force3D=A.force3D,o=!0),n=D.force3D||D.z||D.rotationX||D.rotationY||l.z||l.rotationX||l.rotationY||l.perspective,n||null==A.scale||(l.scaleZ=1);--z>-1;)v=Ba[z],E=l[v]-D[v],(E>y||-y>E||null!=A[v]||null!=M[v])&&(o=!0,f=new ta(D,v,D[v],E,f),v in B&&(f.e=B[v]),f.xs0=0,f.plugin=h,d._overwriteProps.push(f.n));return E=A.transformOrigin,D.svg&&(E||A.svgOrigin)&&(s=D.xOffset,t=D.yOffset,La(a,ha(E),l,A.svgOrigin,A.smoothOrigin),f=ua(D,"xOrigin",(w?D:l).xOrigin,l.xOrigin,f,C),f=ua(D,"yOrigin",(w?D:l).yOrigin,l.yOrigin,f,C),(s!==D.xOffset||t!==D.yOffset)&&(f=ua(D,"xOffset",w?s:D.xOffset,D.xOffset,f,C),f=ua(D,"yOffset",w?t:D.yOffset,D.yOffset,f,C)),E="0px 0px"),(E||Fa&&n&&D.zOrigin)&&(Ca?(o=!0,v=Ea,E=(E||_(a,v,e,!1,"50% 50%"))+"",f=new ta(x,v,0,0,f,-1,C),f.b=x[v],f.plugin=h,Fa?(m=D.zOrigin,E=E.split(" "),D.zOrigin=(E.length>2&&(0===m||"0px"!==E[2])?parseFloat(E[2]):m)||0,f.xs0=f.e=E[0]+" "+(E[1]||"50%")+" 0px",f=new ta(D,"zOrigin",0,0,f,-1,f.n),f.b=m,f.xs0=f.e=D.zOrigin):f.xs0=f.e=E):ha(E+"",D)),o&&(d._transformType=D.svg&&Aa||!n&&3!==this._transformType?2:3),j&&(i[c]=j),k&&(i.scale=k),f},prefix:!0}),ya("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),ya("borderRadius",{defaultValue:"0px",parser:function(a,b,c,f,g,h){b=this.format(b);var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],z=a.style;for(q=parseFloat(a.offsetWidth),r=parseFloat(a.offsetHeight),i=b.split(" "),j=0;j<y.length;j++)this.p.indexOf("border")&&(y[j]=Z(y[j])),m=l=_(a,y[j],e,!1,"0px"),-1!==m.indexOf(" ")&&(l=m.split(" "),m=l[0],l=l[1]),n=k=i[j],o=parseFloat(m),t=m.substr((o+"").length),u="="===n.charAt(1),u?(p=parseInt(n.charAt(0)+"1",10),n=n.substr(2),p*=parseFloat(n),s=n.substr((p+"").length-(0>p?1:0))||""):(p=parseFloat(n),s=n.substr((p+"").length)),""===s&&(s=d[c]||t),s!==t&&(v=aa(a,"borderLeft",o,t),w=aa(a,"borderTop",o,t),"%"===s?(m=v/q*100+"%",l=w/r*100+"%"):"em"===s?(x=aa(a,"borderLeft",1,"em"),m=v/x+"em",l=w/x+"em"):(m=v+"px",l=w+"px"),u&&(n=parseFloat(m)+p+s,k=parseFloat(l)+p+s)),g=va(z,y[j],m+" "+l,n+" "+k,!1,"0px",g);return g},prefix:!0,formatter:qa("0px 0px 0px 0px",!1,!0)}),ya("borderBottomLeftRadius,borderBottomRightRadius,borderTopLeftRadius,borderTopRightRadius",{defaultValue:"0px",parser:function(a,b,c,d,f,g){return va(a.style,c,this.format(_(a,c,e,!1,"0px 0px")),this.format(b),!1,"0px",f)},prefix:!0,formatter:qa("0px 0px",!1,!0)}),ya("backgroundPosition",{defaultValue:"0 0",parser:function(a,b,c,d,f,g){var h,i,j,k,l,m,n="background-position",o=e||$(a,null),q=this.format((o?p?o.getPropertyValue(n+"-x")+" "+o.getPropertyValue(n+"-y"):o.getPropertyValue(n):a.currentStyle.backgroundPositionX+" "+a.currentStyle.backgroundPositionY)||"0 0"),r=this.format(b);if(-1!==q.indexOf("%")!=(-1!==r.indexOf("%"))&&r.split(",").length<2&&(m=_(a,"backgroundImage").replace(D,""),m&&"none"!==m)){for(h=q.split(" "),i=r.split(" "),R.setAttribute("src",m),j=2;--j>-1;)q=h[j],k=-1!==q.indexOf("%"),k!==(-1!==i[j].indexOf("%"))&&(l=0===j?a.offsetWidth-R.width:a.offsetHeight-R.height,h[j]=k?parseFloat(q)/100*l+"px":parseFloat(q)/l*100+"%");q=h.join(" ")}return this.parseComplex(a.style,q,r,f,g)},formatter:ha}),ya("backgroundSize",{defaultValue:"0 0",formatter:function(a){return a+="",ha(-1===a.indexOf(" ")?a+" "+a:a)}}),ya("perspective",{defaultValue:"0px",prefix:!0
}),ya("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),ya("transformStyle",{prefix:!0}),ya("backfaceVisibility",{prefix:!0}),ya("userSelect",{prefix:!0}),ya("margin",{parser:ra("marginTop,marginRight,marginBottom,marginLeft")}),ya("padding",{parser:ra("paddingTop,paddingRight,paddingBottom,paddingLeft")}),ya("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(a,b,c,d,f,g){var h,i,j;return 9>p?(i=a.currentStyle,j=8>p?" ":",",h="rect("+i.clipTop+j+i.clipRight+j+i.clipBottom+j+i.clipLeft+")",b=this.format(b).split(",").join(j)):(h=this.format(_(a,this.p,e,!1,this.dflt)),b=this.format(b)),this.parseComplex(a.style,h,b,f,g)}}),ya("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),ya("autoRound,strictUnits",{parser:function(a,b,c,d,e){return e}}),ya("border",{defaultValue:"0px solid #000",parser:function(a,b,c,d,f,g){var h=_(a,"borderTopWidth",e,!1,"0px"),i=this.format(b).split(" "),j=i[0].replace(w,"");return"px"!==j&&(h=parseFloat(h)/aa(a,"borderTopWidth",1,j)+j),this.parseComplex(a.style,this.format(h+" "+_(a,"borderTopStyle",e,!1,"solid")+" "+_(a,"borderTopColor",e,!1,"#000")),i.join(" "),f,g)},color:!0,formatter:function(a){var b=a.split(" ");return b[0]+" "+(b[1]||"solid")+" "+(a.match(pa)||["#000"])[0]}}),ya("borderWidth",{parser:ra("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),ya("float,cssFloat,styleFloat",{parser:function(a,b,c,d,e,f){var g=a.style,h="cssFloat"in g?"cssFloat":"styleFloat";return new ta(g,h,0,0,e,-1,c,!1,0,g[h],b)}});var Ua=function(a){var b,c=this.t,d=c.filter||_(this.data,"filter")||"",e=this.s+this.c*a|0;100===e&&(-1===d.indexOf("atrix(")&&-1===d.indexOf("radient(")&&-1===d.indexOf("oader(")?(c.removeAttribute("filter"),b=!_(this.data,"filter")):(c.filter=d.replace(z,""),b=!0)),b||(this.xn1&&(c.filter=d=d||"alpha(opacity="+e+")"),-1===d.indexOf("pacity")?0===e&&this.xn1||(c.filter=d+" alpha(opacity="+e+")"):c.filter=d.replace(x,"opacity="+e))};ya("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(a,b,c,d,f,g){var h=parseFloat(_(a,"opacity",e,!1,"1")),i=a.style,j="autoAlpha"===c;return"string"==typeof b&&"="===b.charAt(1)&&(b=("-"===b.charAt(0)?-1:1)*parseFloat(b.substr(2))+h),j&&1===h&&"hidden"===_(a,"visibility",e)&&0!==b&&(h=0),U?f=new ta(i,"opacity",h,b-h,f):(f=new ta(i,"opacity",100*h,100*(b-h),f),f.xn1=j?1:0,i.zoom=1,f.type=2,f.b="alpha(opacity="+f.s+")",f.e="alpha(opacity="+(f.s+f.c)+")",f.data=a,f.plugin=g,f.setRatio=Ua),j&&(f=new ta(i,"visibility",0,0,f,-1,null,!1,0,0!==h?"inherit":"hidden",0===b?"hidden":"inherit"),f.xs0="inherit",d._overwriteProps.push(f.n),d._overwriteProps.push(c)),f}});var Va=function(a,b){b&&(a.removeProperty?(("ms"===b.substr(0,2)||"webkit"===b.substr(0,6))&&(b="-"+b),a.removeProperty(b.replace(B,"-$1").toLowerCase())):a.removeAttribute(b))},Wa=function(a){if(this.t._gsClassPT=this,1===a||0===a){this.t.setAttribute("class",0===a?this.b:this.e);for(var b=this.data,c=this.t.style;b;)b.v?c[b.p]=b.v:Va(c,b.p),b=b._next;1===a&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};ya("className",{parser:function(a,b,d,f,g,h,i){var j,k,l,m,n,o=a.getAttribute("class")||"",p=a.style.cssText;if(g=f._classNamePT=new ta(a,d,0,0,g,2),g.setRatio=Wa,g.pr=-11,c=!0,g.b=o,k=ca(a,e),l=a._gsClassPT){for(m={},n=l.data;n;)m[n.p]=1,n=n._next;l.setRatio(1)}return a._gsClassPT=g,g.e="="!==b.charAt(1)?b:o.replace(new RegExp("(?:\\s|^)"+b.substr(2)+"(?![\\w-])"),"")+("+"===b.charAt(0)?" "+b.substr(2):""),a.setAttribute("class",g.e),j=da(a,k,ca(a),i,m),a.setAttribute("class",o),g.data=j.firstMPT,a.style.cssText=p,g=g.xfirst=f.parse(a,j.difs,g,h)}});var Xa=function(a){if((1===a||0===a)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var b,c,d,e,f,g=this.t.style,h=i.transform.parse;if("all"===this.e)g.cssText="",e=!0;else for(b=this.e.split(" ").join("").split(","),d=b.length;--d>-1;)c=b[d],i[c]&&(i[c].parse===h?e=!0:c="transformOrigin"===c?Ea:i[c].p),Va(g,c);e&&(Va(g,Ca),f=this.t._gsTransform,f&&(f.svg&&(this.t.removeAttribute("data-svg-origin"),this.t.removeAttribute("transform")),delete this.t._gsTransform))}};for(ya("clearProps",{parser:function(a,b,d,e,f){return f=new ta(a,d,0,0,f,2),f.setRatio=Xa,f.e=b,f.pr=-10,f.data=e._tween,c=!0,f}}),j="bezier,throwProps,physicsProps,physics2D".split(","),wa=j.length;wa--;)za(j[wa]);j=g.prototype,j._firstPT=j._lastParsedTransform=j._transform=null,j._onInitTween=function(a,b,h,j){if(!a.nodeType)return!1;this._target=q=a,this._tween=h,this._vars=b,r=j,k=b.autoRound,c=!1,d=b.suffixMap||g.suffixMap,e=$(a,""),f=this._overwriteProps;var n,p,s,t,u,v,w,x,z,A=a.style;if(l&&""===A.zIndex&&(n=_(a,"zIndex",e),("auto"===n||""===n)&&this._addLazySet(A,"zIndex",0)),"string"==typeof b&&(t=A.cssText,n=ca(a,e),A.cssText=t+";"+b,n=da(a,n,ca(a)).difs,!U&&y.test(b)&&(n.opacity=parseFloat(RegExp.$1)),b=n,A.cssText=t),b.className?this._firstPT=p=i.className.parse(a,b.className,"className",this,null,null,b):this._firstPT=p=this.parse(a,b,null),this._transformType){for(z=3===this._transformType,Ca?m&&(l=!0,""===A.zIndex&&(w=_(a,"zIndex",e),("auto"===w||""===w)&&this._addLazySet(A,"zIndex",0)),o&&this._addLazySet(A,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(z?"visible":"hidden"))):A.zoom=1,s=p;s&&s._next;)s=s._next;x=new ta(a,"transform",0,0,null,2),this._linkCSSP(x,null,s),x.setRatio=Ca?Ta:Sa,x.data=this._transform||Ra(a,e,!0),x.tween=h,x.pr=-1,f.pop()}if(c){for(;p;){for(v=p._next,s=t;s&&s.pr>p.pr;)s=s._next;(p._prev=s?s._prev:u)?p._prev._next=p:t=p,(p._next=s)?s._prev=p:u=p,p=v}this._firstPT=t}return!0},j.parse=function(a,b,c,f){var g,h,j,l,m,n,o,p,s,t,u=a.style;for(g in b){if(n=b[g],"function"==typeof n&&(n=n(r,q)),h=i[g])c=h.parse(a,n,g,this,c,f,b);else{if("--"===g.substr(0,2)){this._tween._propLookup[g]=this._addTween.call(this._tween,a.style,"setProperty",$(a).getPropertyValue(g)+"",n+"",g,!1,g);continue}m=_(a,g,e)+"",s="string"==typeof n,"color"===g||"fill"===g||"stroke"===g||-1!==g.indexOf("Color")||s&&A.test(n)?(s||(n=na(n),n=(n.length>3?"rgba(":"rgb(")+n.join(",")+")"),c=va(u,g,m,n,!0,"transparent",c,0,f)):s&&J.test(n)?c=va(u,g,m,n,!0,null,c,0,f):(j=parseFloat(m),o=j||0===j?m.substr((j+"").length):"",(""===m||"auto"===m)&&("width"===g||"height"===g?(j=ga(a,g,e),o="px"):"left"===g||"top"===g?(j=ba(a,g,e),o="px"):(j="opacity"!==g?0:1,o="")),t=s&&"="===n.charAt(1),t?(l=parseInt(n.charAt(0)+"1",10),n=n.substr(2),l*=parseFloat(n),p=n.replace(w,"")):(l=parseFloat(n),p=s?n.replace(w,""):""),""===p&&(p=g in d?d[g]:o),n=l||0===l?(t?l+j:l)+p:b[g],o!==p&&(""!==p||"lineHeight"===g)&&(l||0===l)&&j&&(j=aa(a,g,j,o),"%"===p?(j/=aa(a,g,100,"%")/100,b.strictUnits!==!0&&(m=j+"%")):"em"===p||"rem"===p||"vw"===p||"vh"===p?j/=aa(a,g,1,p):"px"!==p&&(l=aa(a,g,l,p),p="px"),t&&(l||0===l)&&(n=l+j+p)),t&&(l+=j),!j&&0!==j||!l&&0!==l?void 0!==u[g]&&(n||n+""!="NaN"&&null!=n)?(c=new ta(u,g,l||j||0,0,c,-1,g,!1,0,m,n),c.xs0="none"!==n||"display"!==g&&-1===g.indexOf("Style")?n:m):W("invalid "+g+" tween value: "+b[g]):(c=new ta(u,g,j,l-j,c,0,g,k!==!1&&("px"===p||"zIndex"===g),0,m,n),c.xs0=p))}f&&c&&!c.plugin&&(c.plugin=f)}return c},j.setRatio=function(a){var b,c,d,e=this._firstPT,f=1e-6;if(1!==a||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(a||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;e;){if(b=e.c*a+e.s,e.r?b=Math.round(b):f>b&&b>-f&&(b=0),e.type)if(1===e.type)if(d=e.l,2===d)e.t[e.p]=e.xs0+b+e.xs1+e.xn1+e.xs2;else if(3===d)e.t[e.p]=e.xs0+b+e.xs1+e.xn1+e.xs2+e.xn2+e.xs3;else if(4===d)e.t[e.p]=e.xs0+b+e.xs1+e.xn1+e.xs2+e.xn2+e.xs3+e.xn3+e.xs4;else if(5===d)e.t[e.p]=e.xs0+b+e.xs1+e.xn1+e.xs2+e.xn2+e.xs3+e.xn3+e.xs4+e.xn4+e.xs5;else{for(c=e.xs0+b+e.xs1,d=1;d<e.l;d++)c+=e["xn"+d]+e["xs"+(d+1)];e.t[e.p]=c}else-1===e.type?e.t[e.p]=e.xs0:e.setRatio&&e.setRatio(a);else e.t[e.p]=b+e.xs0;e=e._next}else for(;e;)2!==e.type?e.t[e.p]=e.b:e.setRatio(a),e=e._next;else for(;e;){if(2!==e.type)if(e.r&&-1!==e.type)if(b=Math.round(e.s+e.c),e.type){if(1===e.type){for(d=e.l,c=e.xs0+b+e.xs1,d=1;d<e.l;d++)c+=e["xn"+d]+e["xs"+(d+1)];e.t[e.p]=c}}else e.t[e.p]=b+e.xs0;else e.t[e.p]=e.e;else e.setRatio(a);e=e._next}},j._enableTransforms=function(a){this._transform=this._transform||Ra(this._target,e,!0),this._transformType=this._transform.svg&&Aa||!a&&3!==this._transformType?2:3};var Ya=function(a){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};j._addLazySet=function(a,b,c){var d=this._firstPT=new ta(a,b,0,0,this._firstPT,2);d.e=c,d.setRatio=Ya,d.data=this},j._linkCSSP=function(a,b,c,d){return a&&(b&&(b._prev=a),a._next&&(a._next._prev=a._prev),a._prev?a._prev._next=a._next:this._firstPT===a&&(this._firstPT=a._next,d=!0),c?c._next=a:d||null!==this._firstPT||(this._firstPT=a),a._next=b,a._prev=c),a},j._mod=function(a){for(var b=this._firstPT;b;)"function"==typeof a[b.p]&&a[b.p]===Math.round&&(b.r=1),b=b._next},j._kill=function(b){var c,d,e,f=b;if(b.autoAlpha||b.alpha){f={};for(d in b)f[d]=b[d];f.opacity=1,f.autoAlpha&&(f.visibility=1)}for(b.className&&(c=this._classNamePT)&&(e=c.xfirst,e&&e._prev?this._linkCSSP(e._prev,c._next,e._prev._prev):e===this._firstPT&&(this._firstPT=c._next),c._next&&this._linkCSSP(c._next,c._next._next,e._prev),this._classNamePT=null),c=this._firstPT;c;)c.plugin&&c.plugin!==d&&c.plugin._kill&&(c.plugin._kill(b),d=c.plugin),c=c._next;return a.prototype._kill.call(this,f)};var Za=function(a,b,c){var d,e,f,g;if(a.slice)for(e=a.length;--e>-1;)Za(a[e],b,c);else for(d=a.childNodes,e=d.length;--e>-1;)f=d[e],g=f.type,f.style&&(b.push(ca(f)),c&&c.push(f)),1!==g&&9!==g&&11!==g||!f.childNodes.length||Za(f,b,c)};return g.cascadeTo=function(a,c,d){var e,f,g,h,i=b.to(a,c,d),j=[i],k=[],l=[],m=[],n=b._internals.reservedProps;for(a=i._targets||i.target,Za(a,k,m),i.render(c,!0,!0),Za(a,l),i.render(0,!0,!0),i._enabled(!0),e=m.length;--e>-1;)if(f=da(m[e],k[e],l[e]),f.firstMPT){f=f.difs;for(g in d)n[g]&&(f[g]=d[g]);h={};for(g in f)h[g]=k[e][g];j.push(b.fromTo(m[e],c,h,f))}return j},a.activate([g]),g},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(a){"use strict";var b=function(){return(_gsScope.GreenSockGlobals||_gsScope)[a]};"undefined"!=typeof module&&module.exports?(require("../TweenLite.min.js"),module.exports=b()):"function"==typeof define&&define.amd&&define(["TweenLite"],b)}("CSSPlugin");
!function(a){var b=/iPhone/i,c=/iPod/i,d=/iPad/i,e=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,f=/Android/i,g=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,h=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,i=/Windows Phone/i,j=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,k=/BlackBerry/i,l=/BB10/i,m=/Opera Mini/i,n=/(CriOS|Chrome)(?=.*\bMobile\b)/i,o=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,p=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),q=function(a,b){return a.test(b)},r=function(a){var r=a||navigator.userAgent,s=r.split("[FBAN");if("undefined"!=typeof s[1]&&(r=s[0]),s=r.split("Twitter"),"undefined"!=typeof s[1]&&(r=s[0]),this.apple={phone:q(b,r),ipod:q(c,r),tablet:!q(b,r)&&q(d,r),device:q(b,r)||q(c,r)||q(d,r)},this.amazon={phone:q(g,r),tablet:!q(g,r)&&q(h,r),device:q(g,r)||q(h,r)},this.android={phone:q(g,r)||q(e,r),tablet:!q(g,r)&&!q(e,r)&&(q(h,r)||q(f,r)),device:q(g,r)||q(h,r)||q(e,r)||q(f,r)},this.windows={phone:q(i,r),tablet:q(j,r),device:q(i,r)||q(j,r)},this.other={blackberry:q(k,r),blackberry10:q(l,r),opera:q(m,r),firefox:q(o,r),chrome:q(n,r),device:q(k,r)||q(l,r)||q(m,r)||q(o,r)||q(n,r)},this.seven_inch=q(p,r),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},s=function(){var a=new r;return a.Class=r,a};"undefined"!=typeof module&&module.exports&&"undefined"==typeof window?module.exports=r:"undefined"!=typeof module&&module.exports&&"undefined"!=typeof window?module.exports=s():"function"==typeof define&&define.amd?define("isMobile",[],a.isMobile=s()):a.isMobile=s()}(this);
function DeviceOrientation( onOrientationChange ) {
	
 	var scope = this;
 	var PORTRAIT = scope.PORTRAIT = 1;
	var LANDSCAPE = scope.LANDSCAPE = 2;
	scope.orientation = 0;

 	var accelerationIncludingGravity = scope.accelerationIncludingGravity = newVector();
 	var accelerationIncludingGravity_i = scope.accelerationIncludingGravity_i = newVector();
 	// console.log("accelerationIncludingGravity", accelerationIncludingGravity );
 	var rotationRate = scope.rotationRate = {
 		alpha: 0,
 		beta: 0,
 		gamma: 0
 	};
 	var rotationRate_i = scope.rotationRate_i = {
 		alpha: 0,
 		beta: 0,
 		gamma: 0
 	};

 	scope.has_rotation_rate = false;
 	scope.inertion = .125;

 // 	var x = 0, y = 0,
 //    vx = 0, vy = 0,
	// ax = 0, ay = 0;

	var _rotationRate;

	if (window.DeviceMotionEvent != undefined) {

		window.ondevicemotion = function(e) {
			// ax = event.accelerationIncludingGravity.x * 5;
			// ay = event.accelerationIncludingGravity.y * 5;
			// console.log("e.accelerationIncludingGravity", e.accelerationIncludingGravity );
			if( e.accelerationIncludingGravity.x != null){
				copyVector( accelerationIncludingGravity, e.accelerationIncludingGravity );
			}
			// document.getElementById("accelerationX").innerHTML = e.accelerationIncludingGravity.x;
			// document.getElementById("accelerationY").innerHTML = e.accelerationIncludingGravity.y;
			// document.getElementById("accelerationZ").innerHTML = e.accelerationIncludingGravity.z;

			if ( e.rotationRate && e.rotationRate.alpha != null ) {
				scope.has_rotation_rate = true;
				_rotationRate = e.rotationRate;
				rotationRate.alpha = e.rotationRate.alpha;
				rotationRate.beta = e.rotationRate.beta;
				rotationRate.gamma = e.rotationRate.gamma;
				// document.getElementById("rotationAlpha").innerHTML = e.rotationRate.alpha;
				// document.getElementById("rotationBeta").innerHTML = e.rotationRate.beta;
				// document.getElementById("rotationGamma").innerHTML = e.rotationRate.gamma;
			}		
		}

		/*
		setInterval( function() {

			var landscapeOrientation = window.innerWidth/window.innerHeight > 1;
			if ( landscapeOrientation) {
				vx = vx + ay;
				vy = vy + ax;
			} else {
				vy = vy - ay;
				vx = vx + ax;
			}
			vx = vx * 0.98;
			vy = vy * 0.98;
			y = parseInt(y + vy / 50);
			x = parseInt(x + vx / 50);
			
			boundingBoxCheck();
			
			sphere.style.top = y + "px";
			sphere.style.left = x + "px";
			
		}, 25);

		*/
	}
	
	scope.update = function() {

		accelerationIncludingGravity_i.x += ( accelerationIncludingGravity.x - accelerationIncludingGravity_i.x ) * scope.inertion;
		accelerationIncludingGravity_i.y += ( accelerationIncludingGravity.y - accelerationIncludingGravity_i.y ) * scope.inertion;
		accelerationIncludingGravity_i.z += ( accelerationIncludingGravity.z - accelerationIncludingGravity_i.z ) * scope.inertion;

		rotationRate_i.alpha = ( rotationRate.alpha - rotationRate_i.alpha ) * scope.inertion;
		rotationRate_i.beta = ( rotationRate.beta - rotationRate_i.beta ) * scope.inertion;
		rotationRate_i.gamma = ( rotationRate.gamma - rotationRate_i.gamma ) * scope.inertion;
	}

	function newVector () {
		return {
			x: 0,
			y: 0,
			z: 0
		}
	}

	function copyVector ( v1, v2 ) {
		v1.x = v2.x;
		v1.y = v2.y;
		v1.z = v2.z;
	}
	// function boundingBoxCheck(){
	// 	if (x<0) { x = 0; vx = -vx; }
	// 	if (y<0) { y = 0; vy = -vy; }
	// 	if (x>document.documentElement.clientWidth-20) { x = document.documentElement.clientWidth-20; vx = -vx; }
	// 	if (y>document.documentElement.clientHeight-20) { y = document.documentElement.clientHeight-20; vy = -vy; }

  function checkOrientation () {

    if( window.orientation == 90 || window.orientation == -90 ){
      scope.orientation = LANDSCAPE;
    }else{
      scope.orientation = PORTRAIT;
    }
    
  }

  window.addEventListener("orientationchange", function(e) {
    checkOrientation();
    if( onOrientationChange ) onOrientationChange();
  }, false);

  checkOrientation();

	//
	return scope;
} 
var PSprites = (function() {
	
	var scope = this;

	scope.SPRITE_VIS_COEF = 1;
	scope.GRADIENT_POSITIONS = [ .3, .7 ];





	scope.createSprite = function( _size, _size_blured, _sprite_gradient, _blur, _show_debug ){

		// console.log("createSprite", _size, _size_blured, _sprite_gradient, _blur, _no_shadow );
		
		var _size_inner = _size_blured * scope.SPRITE_VIS_COEF;

		var _sprite = new createjs.Shape();

			// Sprite
		_sprite.graphics
			.beginLinearGradientFill( _sprite_gradient, scope.GRADIENT_POSITIONS, 0, _size_blured - _size_inner, 0, _size_blured + _size_inner )
			.drawRect(0, 0, _size*2, _size*2 );


		if( _show_debug ){
			_sprite.graphics
				 .setStrokeStyle(2)
	 			.beginStroke("#000000")
				.drawCircle( _size, _size, _size_inner );
		}

		// MASK
		var _msk = new createjs.Shape();

		_msk.graphics
			.beginFill( "#ff0000" )
			.drawCircle( _size, _size, _size_inner );

		var blurFilterBounds = {x:0,y:0}
		if( _blur ){
			var blurFilter = new createjs.BlurFilter( _blur, _blur, 10);
			console.log(">>>>", blurFilter );
			console.log(">>>>", blurFilter.getBounds() );
			blurFilterBounds = blurFilter.getBounds();
			_msk.filters = [blurFilter];
		}else{
			// particle.cache();
		}
		_msk.cache( -blurFilterBounds.x, -blurFilterBounds.y, _size_blured*2, _size_blured*2 );


		_sprite.filters = [
		  new createjs.AlphaMaskFilter(_msk.cacheCanvas)
		];
		

		_sprite.cache( 0, 0, _size*2, _size*2 );

		return _sprite;

	}



	scope.createMixedSprite = function( sprite_settings, max_size, show_id ){

		var mixed_sprite = new createjs.Container();
		var dyn_size_coef = .01;

		mixed_sprite.settings = sprite_settings;

		mixed_sprite.images = [];

		for( var j=0; j<sprite_settings.length; j++ ){

			var sprite_data = sprite_settings[j];

			var _size = !max_size ? sprite_data.size : max_size;
			var _size_blured = _size;
			// if( sprite_data.blur ) _size += sprite_data.blur * 1 + _size * .1;

			var image = scope.createSprite( _size + sprite_data.blur, _size_blured, sprite_data.gradient, sprite_data.blur );
			image.visible = j==0;
			image.alpha = j==0 ? 1 : 0;
			// image.x = image.y = -_size - ( _size - _size_blured )*2;
			// image.x = image.y = sprite_data.blur ? (- _size - ( _size - _size_blured) * .5 ) : -_size;
			image.x = image.y =  -_size - sprite_data.blur;
			image._original_scale = !max_size ? 1 : sprite_data.size / max_size;
			image._original_size = sprite_data.size;
			mixed_sprite.images.push( image );
			mixed_sprite.addChild( image );
		}

		mixed_sprite._current_scale = 1;
		mixed_sprite._size = mixed_sprite.images[0]._original_size;
		mixed_sprite._dyn_size = mixed_sprite._size * dyn_size_coef;

		if( show_id ){
			var text = new createjs.Text( "#"+sprite_data.id, "20px Arial", "#000");
	 		text.x = 0;
	 		text.textBaseline = "alphabetic";
	 		mixed_sprite.addChild( text );
	 	}

		mixed_sprite.setState = function( index ){
			
			var _scale = 1;
			var _size = 1;
			var t = .5;

			for (var i = 0; i < mixed_sprite.images.length; i++) {
				
				var img = mixed_sprite.images[i];

				TweenLite.killTweensOf( img );

				if( i == index ){
					img.visible = true;
					img.alpha = 0;
					_scale = img._original_scale;
					_size = img._original_size;

					TweenLite.to( img, t*.7, {
						alpha: 1,
						ease: Quad.easeInOut
					});

				}else{

					if( img.visible ){
						TweenLite.to( img, t*.7, {
							delay: t*.3,
							alpha: 0,
							ease: Quad.easeInOut,
							onComplete:function(){
								this.visible = false;
							}
						});
					}else{
						img.visible = false;
						img.alpha = 0;
					}

				}

			};

			TweenLite.killTweensOf( mixed_sprite );
			TweenLite.to( mixed_sprite, t, {
				_current_scale: _scale,
				// scaleX: _scale,
				// scaleY: _scale,
				_size: _size,
				_dyn_size: _size * dyn_size_coef,
				ease: Quad.easeInOut
			});

		}

		mixed_sprite.setSize = function( scalex, scaley ){
			mixed_sprite._size = scalex;
			mixed_sprite._dyn_size = mixed_sprite._size * dyn_size_coef;
			mixed_sprite.scaleX = scalex;
			mixed_sprite.scaleY = scaley === undefined ? scalex : scaley;
		}

		return mixed_sprite;
	}



	//
	return scope;

})();
$(function(){
	
	// $.fn.changeColor = changeColor;

	var scope = this;

	// !!!!
	// var $debug = $("<div style='position:fixed;top:0;left:0;font-size:20xp;'>DEBUG</div>").appendTo($("body"));
	// !!!!

	var $container = $( ".bg-animation" );
	if( !$container.length ) return;

	var PIXEL_RATIO = Math.min( getDevicePixelRatio(), 2 );
	var STAGE_W, STAGE_WH, STAGE_H, STAGE_HH;
	var CENTER_COLLIDER_W, CENTER_COLLIDER_H;
	var SCROLL_MAX;
	var $win = $(window);
	var $body = $("body");
	var deg2rad = 180 / Math.PI;
	var deviceOrientation;

	// PARAMS
	var particles_data = $container.data( "particles" );
	var sprite_url = particles_data.sprite;
	var sprite_gradients = particles_data.gradient || ["#f00","#0f0"];
	var layers_data = particles_data.layers;
	var count = particles_data.count || 10;
	var mouse_radius = particles_data.mouse_radius || 100;
	var center_collider_proportion = particles_data.center_collider_proportion || .7;
	var max_depths = layers_data.length;
	var BORDER = 300;
	var AIM_OFFSET = -400;
	var SPRITE_VIS_COEF = .73;
	var current_color_index, next_color_index, color_is_animating;
	// console.log("animation!");

	scope.is_hided = false;
	var current_section_index;
	var $current_section, $prev_section, $next_section;
	var section_coefs = [];

/*
██████╗ ███████╗███████╗██╗███████╗███████╗
██╔══██╗██╔════╝██╔════╝██║╚══███╔╝██╔════╝
██████╔╝█████╗  ███████╗██║  ███╔╝ █████╗  
██╔══██╗██╔══╝  ╚════██║██║ ███╔╝  ██╔══╝  
██║  ██║███████╗███████║██║███████╗███████╗
╚═╝  ╚═╝╚══════╝╚══════╝╚═╝╚══════╝╚══════╝
*/
	// RESIZE
	var resize_timeout;

	function resize(){

		clearTimeout( resize_timeout );
		resize_timeout = setTimeout( _resize, 5 );
		_resize();
	}

	var canvas_threshold = isMobile ? 100 : 0;

	function _resize( skip_h_check ){
		
		// if( $debug ) $debug.text( STAGE_H +" : " + ( Math.abs( STAGE_H - $container.height() ) ) +" > " + canvas_threshold + ">>"+canvas.height + ~~(Math.random()*100) );

		// if( isMobile.any && !skip_h_check && STAGE_W ==  window.innerWidth && Math.abs( STAGE_H - window.innerHeight ) < canvas_threshold ) return;
		// if( skip_h_check ) return;
		var w = $container.width();
		var h = $container.height();

		if( h == STAGE_H && w == STAGE_W ) return;

		STAGE_W = w;
		STAGE_H = h;
		// if( isMobile.any ) STAGE_H += canvas_threshold;
		STAGE_WH = STAGE_W/2;
		STAGE_HH = STAGE_H/2;

		// if( $debug ) $debug.text( $debug.text() + " : " + STAGE_H );

		canvas.width = ~~STAGE_W;
		canvas.height = ~~STAGE_H + canvas_threshold;

		mx = STAGE_W/2;
		my = STAGE_H/2;

		CENTER_COLLIDER_W = STAGE_WH * center_collider_proportion;
		CENTER_COLLIDER_H = STAGE_HH * center_collider_proportion;
		SCROLL_MAX = $body.outerHeight() - STAGE_H;


		stage.update();
		// console.log(STAGE_W,STAGE_H);
	}

/*
██████╗ ███████╗███╗   ██╗██████╗ ███████╗██████╗ 
██╔══██╗██╔════╝████╗  ██║██╔══██╗██╔════╝██╔══██╗
██████╔╝█████╗  ██╔██╗ ██║██║  ██║█████╗  ██████╔╝
██╔══██╗██╔══╝  ██║╚██╗██║██║  ██║██╔══╝  ██╔══██╗
██║  ██║███████╗██║ ╚████║██████╔╝███████╗██║  ██║
╚═╝  ╚═╝╚══════╝╚═╝  ╚═══╝╚═════╝ ╚══════╝╚═╝  ╚═╝
*/

	//	RENDER
	var c = canvas = document.createElement('canvas');
	$container.append( canvas );
	ctx = canvas.getContext('2d');

	stage = new createjs.Stage(canvas);

	var loop = function(){

	  requestAnimationFrame(loop, c);
	  // ctx.clearRect(0, 0, STAGE_W, STAGE_H);
	  updateSections();
	  updateParticles();

	  stage.update();
	  // clearDebug();
	  // renderParticles();
	  // renderMRadius();
	}




/*
███████╗██████╗ ██████╗ ██╗████████╗███████╗
██╔════╝██╔══██╗██╔══██╗██║╚══██╔══╝██╔════╝
███████╗██████╔╝██████╔╝██║   ██║   █████╗  
╚════██║██╔═══╝ ██╔══██╗██║   ██║   ██╔══╝  
███████║██║     ██║  ██║██║   ██║   ███████╗
╚══════╝╚═╝     ╚═╝  ╚═╝╚═╝   ╚═╝   ╚══════╝
*/
	// Sprite
	// var _gradient_pos = sprite_gradients.pop();
	// console.log("sprite_gradient:", sprite_gradients, _gradient_pos );
	
	PSprites.GRADIENT_POSITIONS = [ .2, .8 ];
	PSprites.SPRITE_VIS_COEF = SPRITE_VIS_COEF;

	var _gradient_pos = [ .2, .8 ];


	sprite_gradients = [];
	var sections$ = [];

	$(".section")
		.each(function(i,e){
			var $e = $(e);
			sections$.push( $e );
			var gradient = $e.data("bg-color");
			if( !gradient ) return;
			gradient = gradient.split(";");
			sprite_gradients.push( gradient );
			console.log(i,"->", gradient, e );
		});



	//

	var sprites = [];
	var layers = [];

	for (var i = 0; i < max_depths; i++) {
		
		var layer = new createjs.Container();
		stage.addChild( layer );
		layers.push( layer );

		var ld = layers_data[i].split(":");
		var size = parseFloat(ld[1]);
		// var sprite = PSprites.createSprite( size, size, parseFloat(ld[3]) );
		var sprite = {};
		sprite._count = parseFloat(ld[0]);
		sprite._size = size;
		sprite._blur = parseFloat(ld[2]);
		sprite._use_center_collider = ld[4] == 'true';
		
		var mixed_sprite = sprite.mixed_sprite = new createjs.Container();

		// background circle
		var image_flat = PSprites.createSprite( size, size - sprite._blur * 1 - size * .01, ["#ffffff", "#ffffff" ], sprite._blur );
		mixed_sprite.addChild( image_flat );
		image_flat.alpha = .4;
		// image_flat.visible = false;

		//
		mixed_sprite.images = [];
		for( var j=0; j<sprite_gradients.length; j++ ){
			var image = PSprites.createSprite( size, size, sprite_gradients[j], sprite._blur );
			image.visible = j==0;
			image.alpha = j==0 ? 1 : 0;
			mixed_sprite.images.push( image );
			mixed_sprite.addChild( image );
		}

		mixed_sprite.current_image_index = current_color_index = 0;
		mixed_sprite.current_image = mixed_sprite.images[ mixed_sprite.current_image_index ];
		// console.log("--> ", mixed_sprite.current_image );
		mixed_sprite._cache = function( _mixed_sprite, _size ){
			// console.log("_cache", _mixed_sprite, _size );
			_mixed_sprite.cache( 0, 0, _size*2, _size*2 );
		}.bind(this, mixed_sprite, size );

		mixed_sprite._cache();

		// !!!
		// stage.addChild( mixed_sprite );
		// mixed_sprite.x = i * 300;
		// mixed_sprite.y = 300;
		// // !!!
		
		sprites.push( sprite );
		// console.log( "sprite:", i, sprite, image.getBounds(), mixed_sprite.images );
	};



	// ===================================================
	function createParticle( image, layer_index, _size ){
		
		var particle = new createjs.Container();
		    
    var image = new createjs.Bitmap( image );
    // var image = new createjs.Bitmap( sprite.mixed_sprite.images[0].cacheCanvas );
    particle.addChild( image );
    console.log("IMG: ", image );
    var _bounds = image.getBounds();
    image.x = -_bounds.width/2;
    image.y = -_bounds.height/2;
    // console.log(">>>", image.getBounds() );
   	
    layers[ layer_index ].addChild( particle );

    var scale_coef = ( Math.random() *.4 + .8 );
		particle.radius = _size * SPRITE_VIS_COEF * scale_coef;
		particle.scaleX = particle.scaleY = scale_coef;
	  particles.push( particle );

    return particle;
	}



/*
      ██████╗ ███████╗███████╗██╗  ██╗████████╗ ██████╗ ██████╗       
▄ ██╗▄██╔══██╗██╔════╝██╔════╝██║ ██╔╝╚══██╔══╝██╔═══██╗██╔══██╗▄ ██╗▄
 ████╗██║  ██║█████╗  ███████╗█████╔╝    ██║   ██║   ██║██████╔╝ ████╗
▀╚██╔▀██║  ██║██╔══╝  ╚════██║██╔═██╗    ██║   ██║   ██║██╔═══╝ ▀╚██╔▀
  ╚═╝ ██████╔╝███████╗███████║██║  ██╗   ██║   ╚██████╔╝██║       ╚═╝ 
      ╚═════╝ ╚══════╝╚══════╝╚═╝  ╚═╝   ╚═╝    ╚═════╝ ╚═╝           
*/
	
	// Particles
	var mx = -STAGE_W,
	my = -STAGE_H,
	pi2 = Math.PI * 2,
	// attract = !true,
	particles = [],
	thingCount = 75,
	minSpeed = .2,
	maxSpeed = 3,
	GRAV = 0.98,
	DAMPING = 0.7;
	
	function initDesktop(){

		for (var j = 0; j < layers.length; j++) {
			
			var sprite = sprites[ j ];
			// console.log(j);

			for (var i = 0; i < sprite._count; i++) {

		    // var particle = sprite.clone();
		   	var particle = createParticle( sprite.mixed_sprite.cacheCanvas, j, sprite._size );

		    particle._use_center_collider = sprite._use_center_collider;
		    // particle._use_center_collider = false;// !!!

		    particle.vx = 0;// (rand(0, 1000)-500)/200;
				particle.vy = 0;// (rand(0, 1000)-500)/200;

				// position
				if( particle._use_center_collider ){

					var angle = Math.random()*30;
					var v_oval = { x: Math.cos( angle ) * CENTER_COLLIDER_W, y: Math.sin( angle ) * CENTER_COLLIDER_H };
					var _coef = Math.random()*.4 + 1;
					
					var offset = 30;
					v_oval.x = v_oval.x *_coef + STAGE_WH;
					if( v_oval.x <= offset ) { v_oval.x = offset; }
					else if( v_oval.x >= STAGE_W - offset ) { v_oval.x = STAGE_W - offset; }

					v_oval.y = v_oval.y * _coef + STAGE_HH;
					if( v_oval.y <= offset ) { v_oval.y = offset; }
					else if( v_oval.y >= STAGE_H -offset ) { v_oval.y = STAGE_H - offset; }

					particle.x = particle.px = v_oval.x;
					particle.y = particle.py = v_oval.y;
					// var oval_d = Math.sqrt( v_oval.x * v_oval.x + v_oval.y * v_oval.y );
					// drawDebugPoint( STAGE_WH - v_oval.x, STAGE_HH - v_oval.y, "green" );

				}else{
					particle.x = particle.px = rand(0, STAGE_W);
					particle.y = particle.py = rand(0, STAGE_H); 
				}

				//
				particle.t = Math.random() * 10;
				particle.t_speed = Math.random() * .003 + .001;
				particle.chaos_speed = Math.random() * .003 + .001;

			}

		}

	}

/*
██╗   ██╗██████╗ ██████╗  █████╗ ████████╗███████╗
██║   ██║██╔══██╗██╔══██╗██╔══██╗╚══██╔══╝██╔════╝
██║   ██║██████╔╝██║  ██║███████║   ██║   █████╗  
██║   ██║██╔═══╝ ██║  ██║██╔══██║   ██║   ██╔══╝  
╚██████╔╝██║     ██████╔╝██║  ██║   ██║   ███████╗
 ╚═════╝ ╚═╝     ╚═════╝ ╚═╝  ╚═╝   ╚═╝   ╚══════╝
*/
	  
	function updateParticlesDesktop(){
	 	
	 	if( scope.is_hided ) return;

	 	var i = particles.length;
	 	while(i--){
		    
	    var particle = particles[i];

	    var dx = particle.x - mx;
	    var dy = particle.y - my;
	    var dist = Math.sqrt(dx * dx + dy * dy);

			var force =  - Math.min( dist - particle.radius, 0 ) / particle.radius;
			force *= 1.5;

			// push from walls
			var _radius = particle.radius * .1;
			var _push_force = .005;
	    if (particle.x < _radius) {
	        particle.vx -= ( particle.x - _radius) * _push_force;
	    }else if (particle.x > STAGE_W - _radius) {
	        particle.vx -= ( particle.x - (STAGE_W - _radius)) * _push_force;
	    }

	    if (particle.y < _radius) {
	        particle.vy -= ( particle.y - _radius) * _push_force;
	    }else if (particle.y > STAGE_H - _radius) {
	        particle.vy -= ( particle.y - (STAGE_H - _radius)) * _push_force;
	    }

		  // apply_force
			particle.vx += ((dx / dist) * force);
      particle.vy += ((dy / dist) * force);
        	
      // chaos
      particle.t += particle.t_speed;
  		particle.vx += Math.sin( particle.t ) * particle.chaos_speed;
  		particle.vy += Math.cos( particle.t ) * particle.chaos_speed;

    	particle.x += particle.vx;
  		particle.y += particle.vy;	
  		particle.vx = particle.vy = 0;

	    var nx = particle.x + (particle.x - particle.px) * .99;
	    var ny = particle.y + (particle.y - particle.py) * .99;
	    particle.px = particle.x;
	    particle.py = particle.y;

	    particle.x = nx;
	    particle.y = ny;


		  // Center collider
		  if( particle._use_center_collider ){

		    var repulsion_v = { x: STAGE_WH - particle.x, y: STAGE_HH - particle.y };
		    var repulsion_d = Math.sqrt( repulsion_v.x * repulsion_v.x + repulsion_v.y * repulsion_v.y );
				drawDebugPoint( particle.x, particle.y, "red" );

				var oval_d = getOvalDistance( repulsion_v.x, repulsion_v.y );

				if( repulsion_d < oval_d ){
					// var coef = easeInQuint( 1 - repulsion_d / oval_d );
					var coef = 1 - repulsion_d / oval_d;
					// console.log( coef );
					var repulsion_force = coef;// * 100;
					
					normalizeVector( repulsion_v );
					negateVector( repulsion_v );
					multiplyVector( repulsion_v, repulsion_force );
					// console.log("repulsion_v", repulsion_v );

					// particle.y = STAGE_HH - v_oval.y;
					particle.vx += repulsion_v.x;
					particle.vy += repulsion_v.y;
				}

			}

	    // Rotation
	    particle.rotation = Math.atan2( AIM_OFFSET - particle.y, STAGE_WH - particle.x ) * deg2rad + 90;

	  }

	}

	function getOvalDistance(x,y){
		var angle = Math.atan2( y, x );
		var v_oval = { x: Math.cos( angle ) * CENTER_COLLIDER_W, y: Math.sin( angle ) * CENTER_COLLIDER_H };
		var oval_d = Math.sqrt( v_oval.x * v_oval.x + v_oval.y * v_oval.y );
		drawDebugPoint( STAGE_WH - v_oval.x, STAGE_HH - v_oval.y, "green" );
		return oval_d;
	}



/*
      ███╗   ███╗ ██████╗ ██████╗ ██╗██╗     ███████╗      
▄ ██╗▄████╗ ████║██╔═══██╗██╔══██╗██║██║     ██╔════╝▄ ██╗▄
 ████╗██╔████╔██║██║   ██║██████╔╝██║██║     █████╗   ████╗
▀╚██╔▀██║╚██╔╝██║██║   ██║██╔══██╗██║██║     ██╔══╝  ▀╚██╔▀
  ╚═╝ ██║ ╚═╝ ██║╚██████╔╝██████╔╝██║███████╗███████╗  ╚═╝ 
      ╚═╝     ╚═╝ ╚═════╝ ╚═════╝ ╚═╝╚══════╝╚══════╝      
*/
	function initMobile(){
		
		var page_height = $body.outerHeight();
		console.log("page_height:", page_height );
		var layers_h = layers.length;

		for (var j = 0; j < layers.length; j++) {
			
			var sprite = sprites[ j ];
			var yy = -_getStep();
			console.log( sprite._size );

			for (var i = 0; i < page_height + sprite._size; i+= _getStep() ) {
			// for (var i = 0; i < sprite._count; i++) {

		    // var particle = sprite.clone();
		    var particle = createParticle( sprite.mixed_sprite.cacheCanvas, j, sprite._size );
				// particle.px = randFloat(-0.2, 1.2);
				particle.px = randFloat(-.2, 1.2);
				// particle.py = randFloat(-.1, 1.1); 
				particle.py = i / page_height; 
				particle.scaleX *= .6;
				particle.scaleY *= .6;

				particle.depth = ( j + Math.random() - layers_h ) * .1;

			}

		}

		function _getStep(){
			return Math.random()*sprite._size + sprite._size * 1.5;
		}

	}

	var hyro_x, hyro_y, hyro_coef;
	function updateParticlesMobile(){
	 	
	 	deviceOrientation.update();


	 	if( deviceOrientation.orientation == deviceOrientation.PORTRAIT ){
      hyro_coef = window.orientation == 0 ? 1 : -1;
      hyro_x = deviceOrientation.accelerationIncludingGravity_i.x * -40 * hyro_coef;
      hyro_y = deviceOrientation.accelerationIncludingGravity_i.y * 40 * hyro_coef;

    }else{
      hyro_coef = window.orientation == 90 ? 1 : -1;
      hyro_x = deviceOrientation.accelerationIncludingGravity_i.y * 40 * hyro_coef;
      hyro_y = deviceOrientation.accelerationIncludingGravity_i.x * 40 * hyro_coef;
    }

	 	var page_width = ~~($body.width());
	 	var page_height = ~~($body.outerHeight());
	 	var scroll = $win.scrollTop();// / SCROLL_MAX;
	 	var center = scroll + STAGE_HH;
	 	// console.log("scroll", scroll );

	 	// $(".debug").text(""+page_width+" : "+page_height );

	 	var i = particles.length;
	 	
	 	while(i--){
		    
	    var particle = particles[i];
	    particle.x = particle.px * page_width;
	    particle.y = particle.py * page_height - scroll;

	    var depth_coef = (particle.y - center ) * particle.depth;
	    particle.y += depth_coef;

	    particle.x += hyro_x * particle.depth;
	    particle.y += hyro_y * particle.depth;

	  }

	}
	

/*
██╗  ██╗██╗██████╗ ███████╗    ██████╗  █████╗ ██╗     ██╗     ███████╗
██║  ██║██║██╔══██╗██╔════╝    ██╔══██╗██╔══██╗██║     ██║     ██╔════╝
███████║██║██║  ██║█████╗      ██████╔╝███████║██║     ██║     ███████╗
██╔══██║██║██║  ██║██╔══╝      ██╔══██╗██╔══██║██║     ██║     ╚════██║
██║  ██║██║██████╔╝███████╗    ██████╔╝██║  ██║███████╗███████╗███████║
╚═╝  ╚═╝╚═╝╚═════╝ ╚══════╝    ╚═════╝ ╚═╝  ╚═╝╚══════╝╚══════╝╚══════╝
*/

	$container
		.on("bg:hide",function(e,params){
			// console.log("bg:hide",e,params);
			params = params || {};
			var duration = params.duration !== undefined ? params.duration : 1;

			scope.is_hided = true;

			var count = 0;
			var i = particles.length;
		 	while(i--){
			    
		    var particle = particles[i];
		    particle._x_before_hide = particle.x;
		    particle._y_before_hide = particle.y;

		    var xx = particle.x - STAGE_WH;
		    var yy = particle.y - STAGE_HH;
		    var length = Math.sqrt(xx * xx + yy * yy);
		    var new_length = STAGE_WH * (Math.random() * .2 + 1.3);
		    xx = STAGE_WH + xx / length * new_length;
		    yy = STAGE_HH + yy / length * new_length;
				
		    count++;
		    TweenLite.killTweensOf(particle);
		    TweenLite.to(particle, duration, {
		    	x: xx,
		    	y: yy,
		    	ease: Quad.easeIn,
		    	onComplete: function(_particle){
		    		_particle.visible = false;
		    		count--;
		    		if( count <= 0 && params.onComplete ) params.onComplete();
		    	}.bind(this, particle)
		    });
		  }

		})
		.on("bg:show",function(e,params){
			// console.log("bg:show",e,params);
			params = params || {};
			var duration = params.duration !== undefined ? params.duration : 1;
			
			var count = 0;
			var i = particles.length;
		 	while(i--){
		 		
		 		var particle = particles[i];
		 		particle.visible = true;
		 		count++;

		 		TweenLite.killTweensOf(particle);
		    TweenLite.to(particle, duration, {
		    	x: particle._x_before_hide,
		    	y: particle._y_before_hide,
		    	ease: Quad.easeOut,
		    	onComplete: function(_particle){
		    		count--;
		    		if( count <= 0 ) {
		    			scope.is_hided = false;
		    			if( params.onComplete ) params.onComplete();
		    		}
		    	}
		    });

		 	}

		});




/*
███╗   ███╗ ██████╗ ██╗   ██╗███████╗███████╗
████╗ ████║██╔═══██╗██║   ██║██╔════╝██╔════╝
██╔████╔██║██║   ██║██║   ██║███████╗█████╗  
██║╚██╔╝██║██║   ██║██║   ██║╚════██║██╔══╝  
██║ ╚═╝ ██║╚██████╔╝╚██████╔╝███████║███████╗
╚═╝     ╚═╝ ╚═════╝  ╚═════╝ ╚══════╝╚══════╝
*/
	// Mouse
	var mousemove = function(e){
	  mx = e.clientX;
	  my = e.clientY;
	}

	// var mousedown = function(){
	//   attract = (attract) ? false : true;
	// }

	var mouseleave = function(){
		mx = -10000;
		my = -10000;
	}
	 
	




/*
███████╗████████╗ █████╗ ██████╗ ████████╗
██╔════╝╚══██╔══╝██╔══██╗██╔══██╗╚══██╔══╝
███████╗   ██║   ███████║██████╔╝   ██║   
╚════██║   ██║   ██╔══██║██╔══██╗   ██║   
███████║   ██║   ██║  ██║██║  ██║   ██║   
╚══════╝   ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═╝   ╚═╝   
*/
	// START
	
	$win.on('resize', resize);
	_resize( true );

	
	if( isMobile.any ){

		deviceOrientation = new DeviceOrientation( function(){
			setTimeout( function(){_resize(true)}, 100 );
		});
		initMobile();
		updateParticles = updateParticlesMobile;

		// setInterval( _resize, 50 );

	}else{


		$win.on('mousemove', mousemove)
			.on('mouseleave', mouseleave);

		initDesktop();
		updateParticles = updateParticlesDesktop;

		// $container.trigger("bg:hide",{duration:0,
		// 	onComplete: function(){
		// 		$container.trigger("bg:show",{duration:2});
		// 	}
		// });
		
	}

	// initDebug();// !!!
	loop();


// DEBUG
	var debug;
	function initDebug(){
		debug = new createjs.Shape();
		stage.addChild( debug );
	}
	
	function clearDebug(){
		if(!debug) return;
		debug.graphics.clear();
	}

	function drawDebugPoint(x,y,color){
		if(!debug) return;
		var g = debug.graphics;
		g.beginFill( color || "red" );
		g.drawCircle( x, y, 20 );
		g.endFill();
	}






/*
███████╗███████╗ ██████╗████████╗██╗ ██████╗ ███╗   ██╗███████╗
██╔════╝██╔════╝██╔════╝╚══██╔══╝██║██╔═══██╗████╗  ██║██╔════╝
███████╗█████╗  ██║        ██║   ██║██║   ██║██╔██╗ ██║███████╗
╚════██║██╔══╝  ██║        ██║   ██║██║   ██║██║╚██╗██║╚════██║
███████║███████╗╚██████╗   ██║   ██║╚██████╔╝██║ ╚████║███████║
╚══════╝╚══════╝ ╚═════╝   ╚═╝   ╚═╝ ╚═════╝ ╚═╝  ╚═══╝╚══════╝
*/
	
	
	// getCurrentSection();
	console.log("--> ", $current_section );

	function updateSections(){
		
		// var scroll = $win.scrollTop();
		// console.log("updateSections");
		for (var i = 0; i < sections$.length; i++) {
			var $section = sections$[i];
			var rect = $section[0].getBoundingClientRect();
			var height_h = rect.height/2;
			var yy = rect.y || rect.top;
			var coef = 1 - Math.min( Math.abs( STAGE_HH - ( yy + height_h) ) / rect.height, 1 );
			var coef = Math.min( 1, coef * 1.5 );
			// if( i == 1 && $debug ) $debug.text( STAGE_HH+" : " + rect.top + '->' + height_h );
			section_coefs[i] = coef;
		};

		for (var i = 0; i < sprites.length; i++) {

			var sprite = sprites[i];
			var mixed_sprite = sprite.mixed_sprite;
			var _images = mixed_sprite.images;

			for (var j = 0; j < _images.length; j++) {

				var image = _images[j];

				image.alpha = section_coefs[j];
				image.visible = image.alpha > .01;

			};

			mixed_sprite._cache();

		};
		
	}




	// ===================================================

/*
██╗   ██╗████████╗██╗██╗     ███████╗
██║   ██║╚══██╔══╝██║██║     ██╔════╝
██║   ██║   ██║   ██║██║     ███████╗
██║   ██║   ██║   ██║██║     ╚════██║
╚██████╔╝   ██║   ██║███████╗███████║
 ╚═════╝    ╚═╝   ╚═╝╚══════╝╚══════╝
*/
	// Utils

	/* requestAnimationFrame */
	/*
	var lastTime = 0;
	var vendors = ['ms', 'moz', 'webkit', 'o'];
	for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x){
	  window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
	  window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame'] || window[vendors[x]+'CancelRequestAnimationFrame'];
	};

	if(!window.requestAnimationFrame){
	  window.requestAnimationFrame = function(callback, element){
	    var currTime = new Date().getTime();
	    var timeToCall = Math.max(0, 16 - (currTime - lastTime));
	    var id = window.setTimeout(function() { callback(currTime + timeToCall); }, timeToCall);
	    lastTime = currTime + timeToCall;
	    return id;
	  };
	};

	if (!window.cancelAnimationFrame){
	  window.cancelAnimationFrame = function(id){
	    clearTimeout(id);
	  };
	};
	*/
	//

	function rand(a,b){return ~~((Math.random()*(b-a+1))+a); };
	function randFloat(a,b){return (Math.random()*(b-a))+a; };

	function getDevicePixelRatio() {
      var ratio = 1;
      // To account for zoom, change to use deviceXDPI instead of systemXDPI
      if (window.screen.systemXDPI !== undefined && window.screen.logicalXDPI !== undefined && window.screen.systemXDPI > window.screen.logicalXDPI) {
          // Only allow for values > 1
          ratio = window.screen.systemXDPI / window.screen.logicalXDPI;
      }
      else if (window.devicePixelRatio !== undefined) {
          ratio = window.devicePixelRatio;
      }
      return ratio;
  };

	// Vector
	function cloneVector( v ){
		return { x: v.x, y: v.y };
	}

	function normalizeVector( v ){
		var length = Math.sqrt( v.x * v.x + v.y * v.y );
		length = 1 / length;
		v.x *= length;
		v.y *= length;
		/* // 3 //
		var length = Math.sqrt( v.x * v.x + v.y * v.y + v.z * v.z );
		length = 1 / length;
		v.x *= length;
		v.y *= length;
		v.z *= length;
		*/
	}

	function multiplyVector( v, scalar ){
		v.x *= scalar;
		v.y *= scalar;
	}

	function negateVector( v ){
		v.x = - v.x;
		v.y = - v.y;
	}



	//
	function increase_brightness(hex, percent){
    	// strip the leading # if it's there
	    hex = hex.replace(/^\s*#|\s*$/g, '');

	    // convert 3 STAGE_Har codes --> 6, e.g. `E0F` --> `EE00FF`
	    if(hex.length == 3){
	        hex = hex.replace(/(.)/g, '$1$1');
	    }

	    var r = parseInt(hex.substr(0, 2), 16),
	        g = parseInt(hex.substr(2, 2), 16),
	        b = parseInt(hex.substr(4, 2), 16);
	    // console.log( "color", hex, r, g, b);

	    r = Math.max( 0, Math.min( 255, ~~( r * percent ) ) );
	    g = Math.max( 0, Math.min( 255, ~~( g * percent ) ) );
	    b = Math.max( 0, Math.min( 255, ~~( b * percent ) ) );
	   	var result = '#' + r.toString(16) + g.toString(16) + b.toString(16);
	   	// console.log( result, r, g, b );

	    return result;
	}

	function easeInQuint(t) { return t*t*t*t*t };
  function easeOutQuint(t) { return 1+(--t)*t*t*t*t };


});
$(function() {
	
	var $container = $(".bg-animation-main");
	if( !$container.length ) return;

	// $container.on( "bg-animation:switch", function(e,data){
	// 	// console.log( "bg-animation:switch", data );
	// });

	var scope = this;
	
	var assets_prefix = $container.data("assets") || "assets/images/";

	var STAGE_W, STAGE_WH, STAGE_H, STAGE_HH;
	
	var PIXEL_RATIO = Math.min( getDevicePixelRatio(), 2 );
	var ANIMATION_ORIGINAL_W = 1440;
	var ANIMATION_ORIGINAL_H = 810;

	var PHONE_W = 375;
	var PHONE_W_MAX = 480;
	var TABLET_W = 768;
	var TABLET_H = 1024;

	var isVertical = false;
	var DEVICE_COEF = 1;
	// var isPhone = false;

	// var aspect_ratio;
	var SCROLL_MAX;
	var $win = $(window);
	var $body = $("body");
	var deg2rad = 180 / Math.PI;
	Math.PI2 = Math.PI*2;
	var deviceOrientation;
	var current_state;
	var current_state_data;

	var is_started = false;
	var switchState;
	var updateParticles;
	var mx = 0;
	var my = 0;
	
	var images;

	var chaos_amp_multiplier_default = .5;
	scope.chaos_amp_multiplier = chaos_amp_multiplier_default;
	
	var anim_switch_time = .8;
	var images_switch_time = 1.3;

	var movement_type;
	var movement_params;
	var proportion_type = $body.data("proportion_type");

	// corrects the stage on a phone
	var current_stage_bounds = {
		x: 0,
		y: 0,
		width: 1,
		height: 1,
		scale_coef: 1,
		canvas_width_coef: 1,
		canvas_height_coef: 1
		// ,width_inverted: 0
		// ,height_inverted: 0
	};


	/*
██████╗ ███████╗███████╗██╗███████╗███████╗
██╔══██╗██╔════╝██╔════╝██║╚══███╔╝██╔════╝
██████╔╝█████╗  ███████╗██║  ███╔╝ █████╗  
██╔══██╗██╔══╝  ╚════██║██║ ███╔╝  ██╔══╝  
██║  ██║███████╗███████║██║███████╗███████╗
╚═╝  ╚═╝╚══════╝╚══════╝╚═╝╚══════╝╚══════╝
*/
	// RESIZE
	var resize_timeout;

	function resize(){

		clearTimeout( resize_timeout );
		resize_timeout = setTimeout( _resize, 5 );
		_resize();
	}

	// var canvas_threshold = isVertical ? 100 : 0;

	function _resize( skip_h_check ){
		
		// if( $debug ) $debug.text( STAGE_H +" : " + ( Math.abs( STAGE_H - $container.height() ) ) +" > " + canvas_threshold + ">>"+canvas.height + ~~(Math.random()*100) );

		// if( isMobile.any && !skip_h_check && STAGE_W ==  window.innerWidth && Math.abs( STAGE_H - window.innerHeight ) < canvas_threshold ) return;
		// if( skip_h_check ) return;
		var w = $container.width();
		var h = $container.height();

		// isVertical = window.innerWidth <= 1024 && window.innerWidth < window.innerHeight;
		// isPhone = window.innerHeight <= 750;

		// aspect_ratio = isVertical ? 1.7 : w/h;

		if( h == STAGE_H && w == STAGE_W ) return;

		STAGE_W = w;
		STAGE_H = h;
		// if( isMobile.any ) STAGE_H += canvas_threshold;
		STAGE_WH = STAGE_W/2;
		STAGE_HH = STAGE_H/2;

		// if( $debug ) $debug.text( $debug.text() + " : " + STAGE_H );

		canvas.width = ~~STAGE_W * PIXEL_RATIO;
		canvas.height = ~~STAGE_H * PIXEL_RATIO;

		// mx = STAGE_W/2;
		// my = STAGE_H/2;

		var is_portrait = w < h;

		DEVICE_COEF = 1;

		if( isMobile.apple.tablet ){
			console.log("####", w, h );
			if( w > TABLET_W || h < TABLET_W ){
				console.log("IPAD PRO");
				DEVICE_COEF = 1.33;
			}else{
				console.log("IPAD");
			}
		}
		// if( window.innerWidth <= PHONE_W_MAX ){
				
		// 	scl = 1;

		// }else if( window.innerWidth <= TABLET_W ){

		// 	if( !is_portrait ) _class = "phone_horizontal";
		// 	else _class = "tablet_vertical";

		// }else if( window.innerWidth <= TABLET_H ){

		// 	if( !is_portrait ) _class = "tablet_horizontal";
		// 	else _class = "tablet_vertical";
		// 	// console.log("!!!!!!!!!!!!!", window.innerWidth );

		// }

		// particle_container.scaleX = particle_container.scaleY = scl;
		

		stage.update();

		if( solid_particles ) solid_particles.setSize();
		// console.log(STAGE_W,STAGE_H);
		changeCurrentStageBounds(0, true);
	}

	$(window).on("intro:resize", function ( e, _proportion_type ){
		proportion_type = _proportion_type;
		console.log("resize_proportion: ", proportion_type );
		changeCurrentStageBounds(0, true);
	});





/*
██████╗ ███████╗███╗   ██╗██████╗ ███████╗██████╗ 
██╔══██╗██╔════╝████╗  ██║██╔══██╗██╔════╝██╔══██╗
██████╔╝█████╗  ██╔██╗ ██║██║  ██║█████╗  ██████╔╝
██╔══██╗██╔══╝  ██║╚██╗██║██║  ██║██╔══╝  ██╔══██╗
██║  ██║███████╗██║ ╚████║██████╔╝███████╗██║  ██║
╚═╝  ╚═╝╚══════╝╚═╝  ╚═══╝╚═════╝ ╚══════╝╚═╝  ╚═╝
*/

	//	RENDER
	var c = canvas = document.createElement('canvas');
	$container.append( canvas );
	ctx = canvas.getContext('2d');

	stage = new createjs.Stage(canvas);
	var particle_container = new createjs.Container();
	stage.addChild( particle_container );

	var loop = function(){

	  requestAnimationFrame(loop, c);
	  // ctx.clearRect(0, 0, STAGE_W, STAGE_H);
	  updateParticles();

	  stage.update();
	  // clearDebug();
	  // renderParticles();
	  // renderMRadius();
	}


	/*
███████╗██████╗ ██████╗ ██╗████████╗███████╗
██╔════╝██╔══██╗██╔══██╗██║╚══██╔══╝██╔════╝
███████╗██████╔╝██████╔╝██║   ██║   █████╗  
╚════██║██╔═══╝ ██╔══██╗██║   ██║   ██╔══╝  
███████║██║     ██║  ██║██║   ██║   ███████╗
╚══════╝╚═╝     ╚═╝  ╚═╝╚═╝   ╚═╝   ╚══════╝
*/

// Sprite
	
	var sprites = [];

	var states = 
[{"chaos_amp":0.1,"gradient":["#ffd9af","#fab7d1"],"bounds":{"phone_vertical":{"height":2184,"x":89.1,"width":1227.9,"y":-1680.25},"phone_horizontal":{"height":653.6,"x":53.2,"width":1162.5,"y":271.1},"desktop":{"height":818.1,"x":0,"width":1454.4,"y":0},"tablet_horizontal":{"height":921.1,"x":27.5,"width":1228.2,"y":-25},"tablet_vertical":{"height":1454.55,"x":157.1,"width":1090.9,"y":-537.2}},"particles":[{"x":243.2,"speed_coef":0.2,"y":1221.05,"blur":0,"size":70,"id":1},{"x":753.15,"speed_coef":0.5,"y":1393.05,"blur":0,"size":231.1,"id":2},{"x":1006.25,"speed_coef":0.4,"y":1200,"blur":0,"size":145.1,"id":3},{"x":1011,"blur":0,"size":0.1,"id":4,"y":871.05},{"x":1011,"blur":0,"size":0.1,"id":5,"y":871.05},{"x":1011,"blur":0,"size":0.5,"id":6,"y":871.05},{"x":1011,"blur":0,"size":0.1,"id":7,"y":871.05},{"x":1011,"blur":0,"size":0.2,"id":8,"y":871.05}]},{"gradient":["#ffd9af","#fab7d1"],"bounds":{"phone_vertical":{"height":1541.65,"x":222,"width":866.75,"y":108.95},"phone_horizontal":{"height":653.6,"x":53.2,"width":1162.5,"y":111.1},"desktop":{"height":818.1,"x":0,"width":1454.4,"y":0},"tablet_horizontal":{"height":921.1,"x":-12.5,"width":1228.2,"y":-25},"tablet_vertical":{"height":1259.4,"x":237.1,"width":944.55,"y":-185.15}},"particles":[{"x":243.2,"blur":0,"size":70,"id":1,"y":161.05},{"x":753.15,"gradient":["#ffb1c9","#c2d5ff"],"y":473.05,"blur":0,"size":231.1,"id":2},{"x":1006.25,"speed_coef":0.5,"y":340,"blur":0,"size":145.1,"id":3},{"x":1011,"blur":0,"size":0.1,"id":4,"y":431.05},{"x":1011,"blur":0,"size":0.1,"id":5,"y":431.05},{"x":1011,"blur":0,"size":0.5,"id":6,"y":431.05},{"x":1011,"blur":0,"size":0.1,"id":7,"y":431.05},{"x":1011,"blur":0,"size":0.2,"id":8,"y":431.05}]},{"gradient":["#ffb1c9","#c2d5ff"],"chaos_amp":4,"bounds":{"phone_vertical":{"height":1247.25,"x":670,"width":701.2,"y":108.95},"phone_horizontal":{"height":590.7,"x":189.2,"width":1050.6,"y":115.1},"desktop":{"height":818.1,"x":0,"width":1454.4,"y":0},"tablet_horizontal":{"height":921.1,"x":67.5,"width":1228.2,"y":-41},"tablet_vertical":{"height":1022.6,"x":633.15,"width":766.95,"y":102.9}},"is_solid":true,"particles":[{"x":1013.4,"blur":0,"size":160.1,"id":1,"y":435.05},{"x":1011.5,"blur":0,"size":112.1,"id":2,"y":431.05},{"x":1029.25,"blur":0,"size":132,"id":3,"y":438.05},{"x":1003.6,"blur":0,"size":132,"id":4,"y":438.05},{"x":991.5,"blur":0,"size":119.9,"id":5,"y":426},{"x":1025.25,"blur":0,"size":138.1,"id":6,"y":413.05},{"x":1009.25,"blur":0,"size":136.1,"id":7,"y":443.95},{"x":1016.2,"blur":0,"size":93.1,"id":8,"y":425}]},{"gradient":["#ffd9af","#fab7d1"],"bounds":{"phone_vertical":{"height":1615.25,"x":197.9,"width":908.1,"y":-120},"phone_horizontal":{"height":947.65,"x":-410.9,"width":1685.45,"y":-116.95},"desktop":{"height":818.1,"x":0,"width":1454.4,"y":0},"tablet_horizontal":{"height":904.95,"x":7.5,"width":1206.6,"y":-1},"tablet_vertical":{"height":1470,"x":145,"width":1102.45,"y":-9.15}},"particles":[{"x":197.2,"blur":19.5,"size":99.6,"id":1,"y":207.05},{"x":-539,"blur":0,"size":28,"id":2,"y":416.65},{"x":793.35,"blur":18.5,"size":100.5,"id":3,"y":42},{"x":1211.15,"blur":0,"size":75,"id":4,"y":274.1},{"x":1060.15,"blur":22.9,"size":145,"id":5,"y":570.1},{"x":671.15,"blur":15.3,"size":64.2,"id":6,"y":452.85},{"x":1968.65,"blur":0,"size":112,"id":7,"y":1340.65},{"x":394.15,"blur":0,"size":96,"id":8,"y":670.05}]},{"movement_params":{"x":952,"r":295.5,"y":421,"speed":0.01},"movement_type":"circular","gradient":["#d7e8fd","#eedafd"],"bounds":{"phone_vertical":{"height":1917.65,"x":421.3,"width":1078.1,"y":-24},"phone_horizontal":{"height":947.65,"x":-330.9,"width":1685.45,"y":-48.95},"desktop":{"height":818.1,"x":0,"width":1454.4,"y":0},"tablet_horizontal":{"height":962.85,"x":-36.5,"width":1283.85,"y":-61},"tablet_vertical":{"height":1667.4,"x":361.05,"width":1250.55,"y":0}},"particles":[{"x":1067.25,"blur":0,"size":57.5,"id":1,"y":150.95},{"x":1212.25,"blur":0,"size":57.5,"id":2,"y":307},{"x":1212.25,"blur":0,"size":57.5,"id":3,"y":518.15},{"x":1084,"blur":0,"size":57.5,"id":4,"y":670.15},{"x":876.2,"blur":0,"size":57.5,"id":5,"y":692.05},{"x":720.2,"blur":0,"size":57.5,"id":6,"y":587.05},{"x":681.25,"blur":0,"size":57.5,"id":7,"y":337},{"x":839.2,"blur":0,"size":57.5,"id":8,"y":158.95}]},{"gradient":["#ffebc2","#7adadb"],"bounds":{"phone_vertical":{"height":1836.95,"x":329.95,"width":1032.75,"y":0},"phone_horizontal":{"height":979.35,"x":-342.9,"width":1741.9,"y":-144.95},"desktop":{"height":818.1,"x":0,"width":1454.4,"y":0},"tablet_horizontal":{"height":932.25,"x":107.5,"width":1243.1,"y":-125},"tablet_vertical":{"height":1618.3,"x":205.85,"width":1213.7,"y":-56}},"particles":[{"x":1174.85,"blur":0,"size":120,"id":1,"y":296.95},{"x":960.45,"blur":0,"size":74.5,"id":2,"y":541.6},{"x":757.7,"blur":0,"size":53.2,"id":3,"y":654.65},{"x":570.4,"blur":0,"size":39.5,"id":4,"y":693.7},{"x":413.6,"blur":0,"size":29.1,"id":5,"y":697.1},{"x":-707.65,"blur":0,"size":49.5,"id":6,"y":566.6},{"x":1140.35,"blur":0,"size":38.5,"id":7,"y":-291.65},{"x":50,"blur":0,"size":50,"id":8,"y":-348.65}]},{"gradient":["#eeb181","#cf8bc6"],"images":[{"name":"phone_shadow.png","x":987.2,"at_back":0,"y":667.15},{"name":"macbook.png","x":986.7,"time_out_coef":1.4,"at_back":-2,"y":277.05},{"name":"ipad.png","x":1325,"time_out_coef":1,"time_in_coef":1.4,"y":565.65},{"name":"phone.png","x":1003.7,"time_out_coef":1.2,"time_in_coef":1.2,"y":552.75,"chaos_amp":1}],"bounds":{"phone_vertical":{"height":1593.75,"x":670.15,"width":896,"y":0.9},"phone_horizontal":{"height":913.7,"x":-318.9,"width":1625.2,"y":-80.95},"desktop":{"height":818.1,"x":0,"width":1454.4,"y":0},"tablet_horizontal":{"height":979.2,"x":63.5,"width":1305.65,"y":-65},"tablet_vertical":{"height":1295.55,"x":564.15,"width":971.65,"y":52}},"particles":[{"x":2104.05,"blur":0,"size":94,"id":1,"y":-471.1},{"x":890.9,"blur":0,"size":78,"id":2,"y":615.1},{"x":815.2,"blur":0,"size":93.1,"id":3,"y":62.75},{"x":948.45,"blur":0,"size":0.5,"id":4,"y":346.6},{"x":971.7,"blur":0,"size":2.3,"id":5,"y":281.55},{"x":-835.75,"blur":0,"size":49.5,"id":6,"y":1842},{"x":1030.5,"blur":0,"size":38.5,"id":7,"y":-639.65},{"x":-896.2,"blur":0,"size":27.5,"id":8,"y":-157.65}]}]
;


		// !!! TEST !!!
		// var size = 200;
		// var blur = 0;//22;
		// var sprite = PSprites.createSprite( size, size - blur, ["#ff0000", "#0000ff" ], blur );
		// stage.addChild( sprite );
		// sprite.x = size;
		// sprite.y = size;
		// sprite.graphics.s
		// !!! TEST !!!

/*
      ██████╗ ███████╗███████╗██╗  ██╗████████╗ ██████╗ ██████╗       
▄ ██╗▄██╔══██╗██╔════╝██╔════╝██║ ██╔╝╚══██╔══╝██╔═══██╗██╔══██╗▄ ██╗▄
 ████╗██║  ██║█████╗  ███████╗█████╔╝    ██║   ██║   ██║██████╔╝ ████╗
▀╚██╔▀██║  ██║██╔══╝  ╚════██║██╔═██╗    ██║   ██║   ██║██╔═══╝ ▀╚██╔▀
  ╚═╝ ██████╔╝███████╗███████║██║  ██╗   ██║   ╚██████╔╝██║       ╚═╝ 
      ╚═════╝ ╚══════╝╚══════╝╚═╝  ╚═╝   ╚═╝    ╚═════╝ ╚═╝           
*/
	

/*
██╗███╗   ██╗██╗████████╗    ██████╗ ███████╗██╗  ██╗████████╗██████╗ 
██║████╗  ██║██║╚══██╔══╝    ██╔══██╗██╔════╝██║ ██╔╝╚══██╔══╝██╔══██╗
██║██╔██╗ ██║██║   ██║       ██║  ██║███████╗█████╔╝    ██║   ██████╔╝
██║██║╚██╗██║██║   ██║       ██║  ██║╚════██║██╔═██╗    ██║   ██╔═══╝ 
██║██║ ╚████║██║   ██║       ██████╔╝███████║██║  ██╗   ██║   ██║     
╚═╝╚═╝  ╚═══╝╚═╝   ╚═╝       ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝   ╚═╝     
*/	

	function initDesktop(){

		console.log("#initDesktop" );



		//  ------------- PARTICLES ------------- 
		for (var i = 0; i < states.length; i++) {
			
			var state = states[i];
			
			for (var j = 0; j < state.particles.length; j++) {
				var particle = state.particles[j];
				var _sprite = sprites[ particle.id ];
				if( !_sprite ) sprites[ particle.id ] = _sprite = { id: particle.id, states: [], max_size: 0 };
				if( !particle.gradient ) particle.gradient = state.gradient;
				particle.size *= 1.15;
				_sprite.states.push( particle );
				if( particle.size > _sprite.max_size ) _sprite.max_size = particle.size;
			};

		};

		sprites.shift();

		var init_state_index = 1;
		var dynamic_scale_coef = 1000;

		for (var i = 0; i < sprites.length; i++) {
			
			var _sprite = sprites[i];
			var mixed_sprite = _sprite.mixed_sprite = PSprites.createMixedSprite( _sprite.states, _sprite.max_size, !true /* show particle index */ );
			
			mixed_sprite.angle = Math.random();
			mixed_sprite.speed = 0;

			// var r = Math.random()*Math.PI*2;
			// mixed_sprite.cx = Math.cos(r)*1.2;
			// mixed_sprite.cy = Math.sin(r)*1.2;
			// console.log("!!!", _sprite.states);
			mixed_sprite.cx = _sprite.states[0].x;
			mixed_sprite.cy = _sprite.states[0].y * 2;// !!! *2 is a screw patch
			// console.log("!!!", mixed_sprite.cx, mixed_sprite.cy );
			mixed_sprite.setSize( 0 );

			mixed_sprite.vx = 0; // Math.random() * .05 - .025;
			mixed_sprite.vy = 0; // Math.random() * .05 - .025;
			// mixed_sprite.target_x = .5;
			// mixed_sprite.target_y = .5;
			mixed_sprite.t = Math.random() * 6;
			mixed_sprite.t_speed = Math.random() * .05 + .005;
			mixed_sprite.chaos_amp = (Math.random() * .0001 + .0001)*dynamic_scale_coef;
			
			mixed_sprite.speed_coef = 1;

			mixed_sprite.target_max_dist = (Math.random() * .3 + .5)*dynamic_scale_coef; // 1
			mixed_sprite.target_force_max = (Math.random() * .02 + .02)*dynamic_scale_coef; // .04;

			mixed_sprite.mouse_max_dist = .1*dynamic_scale_coef;
			mixed_sprite.mouse_force_max = mixed_sprite.target_force_max * 2;

			particle_container.addChildAt( mixed_sprite, 0 );
		};

		console.log( sprites );
		//  ------------- PARTICLES ------------- 



		// ------------- SOLID PARTICLES ------------- 
		initSolidParticles();
		// ------------- SOLID PARTICLES ------------- 



		// ------------- IMAGES ------------- 
		images = {};

		for (var i = 0; i < states.length; i++) {
			
			var state = states[i];
			if( !state.images ) continue;

			for (var j = 0; j < state.images.length; j++) {
				
				var image_data = state.images[j];
				// console.log(j, "image_data: ", image_data );
				
				var image_object = images[ image_data.name ];

				// Create a new image object if not exist
				if( !image_object ){

					var img = new createjs.Bitmap( assets_prefix + image_data.name );
					img.visible = false;

					if( image_data.at_back != undefined ){
						// stage.addChildAt( img, 0 );// drop image to the back
						console.log("stage.numChildren", particle_container.numChildren );
						particle_container.addChildAt( img, image_data.at_back == 0 ? image_data.at_back : Math.max(0, particle_container.numChildren + image_data.at_back ) );
					}else{
						particle_container.addChild( img );
					}

					images[ image_data.name ] = image_object = {
						name: image_data,
						image: img,
						states: {},
						is_active: false,
						is_moveout: false,
						is_movein: false,
						t: Math.random()*6
					};
				}

				// add frame data
				image_object.states[ i ] = image_data;

			};

		};

		console.log("IMAGES:", images );


		//  ------------- INIT ------------- 
		switchStateDesktop(0);
		
	}





/*
███████╗██╗    ██╗██╗████████╗ ██████╗██╗  ██╗    ██████╗ ███████╗██╗  ██╗████████╗██████╗ 
██╔════╝██║    ██║██║╚══██╔══╝██╔════╝██║  ██║    ██╔══██╗██╔════╝██║ ██╔╝╚══██╔══╝██╔══██╗
███████╗██║ █╗ ██║██║   ██║   ██║     ███████║    ██║  ██║███████╗█████╔╝    ██║   ██████╔╝
╚════██║██║███╗██║██║   ██║   ██║     ██╔══██║    ██║  ██║╚════██║██╔═██╗    ██║   ██╔═══╝ 
███████║╚███╔███╔╝██║   ██║   ╚██████╗██║  ██║    ██████╔╝███████║██║  ██╗   ██║   ██║     
╚══════╝ ╚══╝╚══╝ ╚═╝   ╚═╝    ╚═════╝╚═╝  ╚═╝    ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝   ╚═╝     
*/

	function switchStateDesktop( state ){
		
		if( state == current_state ) return;

		current_state = state;
		current_state_data = states[ state ];
		console.log("switchState: ", current_state_data );

		changeCurrentStageBounds( anim_switch_time * .5 );

		// -------------- MOVEMENT -------------------
		// Movement
		movement_type = current_state_data.movement_type;
		movement_params = current_state_data.movement_params;
		if( movement_params ) {
			movement_params.t = 0;
			movement_params.radius_offset = Math.PI * 2 / sprites.length;
		}
		// -------------- MOVEMENT -------------------


		// -------------- SOLID PARTICLES -------------------
		if( solid_particles ) solid_particles.changeGradient( sprites[0].states[state].gradient, anim_switch_time, current_state_data.is_solid );
		// -------------- SOLID PARTICLES -------------------
		
		
		// -------------- FRAME ATTRIBUTES -------------------
		
		// Frame attributes
		TweenLite.to( scope, anim_switch_time, {
			chaos_amp_multiplier: current_state_data.chaos_amp || chaos_amp_multiplier_default,
			ease: Quad.easeInOut
		});
		// -------------- FRAME ATTRIBUTES -------------------


		// -------------- PARTICLES -------------------
		// Particles
		for (var i = 0; i < sprites.length; i++) {
			var _sprite = sprites[i];
			var mixed_sprite = _sprite.mixed_sprite;
			var _state = _sprite.states[state];
			mixed_sprite.target_x = _state.x;
			mixed_sprite.target_y = _state.y;
			mixed_sprite.setState( state );

			TweenLite.to( mixed_sprite, anim_switch_time, {
				speed_coef: _state.speed_coef !== undefined ? _state.speed_coef : 1,
				ease: Quad.easeInOut
			});

		}
		// -------------- PARTICLES -------------------


		// -------------- IMAGES -------------------
		// Images. Not the Particles!
		var _offsetx = ANIMATION_ORIGINAL_W * .5;
		var _offsety = _offsetx;// * aspect_ratio;
		
		for (var i in images ) {

			var image_data = images[i];
			var img = image_data.image;
			var _state = image_data.states[current_state];
			
			if( _state && !image_data.is_movein ){ // show image

				image_data.cx = _state.x + _offsetx;
				image_data.cy = _state.y + _offsety;
				image_data.prev_state = _state;
				image_data.is_active = true;
				image_data.is_moveout = false;
				image_data.is_movein = true;
				img.visible = true;

				var time_in_coef = _state.time_in_coef !== undefined ? _state.time_in_coef : 1;

				TweenLite.to( image_data, images_switch_time * time_in_coef, {
					cx: _state.x,
					cy: _state.y,
					chaos_amp: _state.chaos_amp || 0,
					ease: Cubic.easeOut,
					onComplete: function( _image_data ){
						_image_data.is_movein  = false;
					}.bind( this, image_data )
				});

			}else{

				if( image_data.is_active && !image_data.is_moveout ){

					image_data.is_moveout = true;
					image_data.is_movein = false;

					var prev_state = image_data.prev_state;

					var time_out_coef = prev_state.time_out_coef !== undefined ? prev_state.time_out_coef : 1;

					TweenLite.to( image_data, images_switch_time * .5 * time_out_coef, {
						cx: prev_state.x + _offsetx,
						cy: prev_state.y + _offsety,
						chaos_amp: 0,
						ease: Cubic.easeIn,
						onComplete: function(_image_data){
							_image_data.is_active = false;
							_image_data.is_moveout = false;
							_image_data.image.visible = false;
						}.bind(this, image_data )
					});

				}

			}

			// console.log("IMG: ", _state);

		};
		// -------------- IMAGES -------------------

	}




	//
	var proportion_scale_coefs = {
		phone_vertical: .39,
		phone_horizontal:.45,
		tablet_vertical: .7,
		tablet_horizontal: .75,
		desktop: 1,
		screen_ratio: 1
	}

	function changeCurrentStageBounds( t, update_targets ){
		
		if( !current_state_data ) return;
		var _bounds = current_state_data.bounds[ proportion_type ];
		if( !_bounds ) return;
		
		console.log("changeCurrentStageBounds", window.innerWidth, window.innerHeight, proportion_type );

		t = t !== undefined ? t : anim_switch_time;

		TweenLite.killTweensOf( current_stage_bounds );
		TweenLite.to( current_stage_bounds, t, {
			x: _bounds.x,
			y: _bounds.y,
			width: _bounds.width,
			height: _bounds.height,
			canvas_width_coef: canvas.width / _bounds.width,
			canvas_height_coef: canvas.height / _bounds.height,
			scale_coef: proportion_scale_coefs[ proportion_type ],
			screen_ratio: _bounds.height / _bounds.width * ( canvas.width / canvas.height ),
			ease: Quad.easeInOut
		});

		// recalculate bounds
		// current_stage_bounds.x = _bounds.x;
		// current_stage_bounds.y = _bounds.y;
		// current_stage_bounds.width = _bounds.width;
		// current_stage_bounds.height = _bounds.height;
		// current_stage_bounds.canvas_width_coef = canvas.width / _bounds.width;
		// current_stage_bounds.canvas_height_coef = canvas.height / _bounds.height;
		// current_stage_bounds.scale_coef = ( _bounds.width > _bounds.height ) ? (_bounds.width/ANIMATION_ORIGINAL_W) : (_bounds.height/810);


		// current_stage_bounds.scale_coef = proportion_scale_coefs[ proportion_type ];//_bounds.width / ANIMATION_ORIGINAL_W;

		console.log("::>", current_stage_bounds, _bounds );
		// replace particle targets
		if( update_targets ){

			for (var i = 0; i < sprites.length; i++) {
				
				var _sprite = sprites[i];
				var particle = _sprite.mixed_sprite;
				var _state = _sprite.states[current_state];
				
				if( movement_type == "circular" ){
					var mt = movement_params.t + movement_params.radius_offset * i;
					particle.cx = ( movement_params.x - _bounds.x ) + Math.cos( mt ) * movement_params.r;
					particle.cy = ( movement_params.y - _bounds.y ) + Math.sin( mt ) * movement_params.r;
				}else{
					particle.cx = (particle.target_x - _bounds.x );
					particle.cy = (particle.target_y - _bounds.y );
				}

			}

		}

	}





/*
██╗   ██╗██████╗ ██████╗  █████╗ ████████╗███████╗    ██████╗ ███████╗██╗  ██╗████████╗██████╗ 
██║   ██║██╔══██╗██╔══██╗██╔══██╗╚══██╔══╝██╔════╝    ██╔══██╗██╔════╝██║ ██╔╝╚══██╔══╝██╔══██╗
██║   ██║██████╔╝██║  ██║███████║   ██║   █████╗      ██║  ██║███████╗█████╔╝    ██║   ██████╔╝
██║   ██║██╔═══╝ ██║  ██║██╔══██║   ██║   ██╔══╝      ██║  ██║╚════██║██╔═██╗    ██║   ██╔═══╝ 
╚██████╔╝██║     ██████╔╝██║  ██║   ██║   ███████╗    ██████╔╝███████║██║  ██╗   ██║   ██║     
 ╚═════╝ ╚═╝     ╚═════╝ ╚═╝  ╚═╝   ╚═╝   ╚══════╝    ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝   ╚═╝     
*/
	var max_dist = .3;
	var ease_corrector = 1.5;

	function updateParticlesDesktop(){
		// console.log("=====");
		
		var dx, dy, dist, vx, vy;

		// var current_bounds = current_state_data.bounds
		var _mobile_scale_coef = (canvas.width / ANIMATION_ORIGINAL_W ) * PIXEL_RATIO;
		// var _mobile_img_scale_coef = _mobile_scale_coef * 1.4;
		
		// var _horizontal_scale_coef = _mobile_scale_coef;

		if( movement_type == "circular" ){
			movement_params.t += movement_params.speed;
		}

		// var _orig_h = canvas.width * current_stage_bounds.height;
		// var _h_coef = (canvas.height /2 - _orig_h ) /2;

		// ------------- PARTICLES -------------------
		for (var i = 0; i < sprites.length; i++) {
			
			var _sprite = sprites[i];
			var particle = _sprite.mixed_sprite;

			var particle_target_x = (particle.target_x - current_stage_bounds.x );
			var particle_target_y = (particle.target_y - current_stage_bounds.y );
			// particle.x = cx * current_stage_bounds.canvas_width_coef;
			// particle.y = cy * current_stage_bounds.canvas_height_coef;
			// if(i==0) console.log( particle.target_x +" - "+ current_stage_bounds.x+" / "+current_stage_bounds.width, particle.x, particle.y );
			// if(i==0) console.log( particle._size / current_stage_bounds.width, particle._current_scale );

			
			var particle_mass_coef = (300 - Math.min( particle._size, 300) ) / 300;
			var particle_inertion_coef = ( particle_mass_coef * .5 ) + .5;
			// if( i==0 ) console.log("->", particle._size, particle_mass_coef );
			// if( i==0 ) console.log("->", particle.speed_coef );

			if( movement_type == "circular" ){
				var mt = movement_params.t + movement_params.radius_offset * i;
				particle_target_x = ( movement_params.x - current_stage_bounds.x ) + Math.cos( mt ) * movement_params.r;
				particle_target_y = ( movement_params.y - current_stage_bounds.y ) + Math.sin( mt ) * (movement_params.r * current_stage_bounds.screen_ratio);
			}

			vx = 0;
			vy = 0;

			// movement to a target
			dx = particle_target_x - particle.cx;
			dy = particle_target_y - particle.cy;
			dist = Math.sqrt(dx*dx + dy*dy);
			
			// console.log( "2", dx, dy, dist );
			if( dist>0 ){
				var target_force = easeOutQuad( Math.min( dist, particle.target_max_dist ), 0, particle.target_force_max, particle.target_max_dist );
				vx += dx / dist * target_force;
				vy += dy / dist * target_force;
			}

			// mouse
			dx = mx - particle.x;
			dy = my - particle.y;
			dist = Math.sqrt(dx*dx + dy*dy);
			if( dist > 0 ){
				var mouse_force_max = particle.mouse_force_max * particle._dyn_size;
				var mouse_max_dist = particle.mouse_max_dist * particle._dyn_size;
				var mouse_force = ( mouse_force_max - easeOutQuad( Math.min( dist, mouse_max_dist ), 0, mouse_force_max, mouse_max_dist ) ) * particle_mass_coef;
				vx -= dx / dist * mouse_force;
				vy -= dy / dist * mouse_force;
			}

			// chaos
			particle.t += particle.t_speed;
			particle.vx += Math.sin( particle.t ) * particle.chaos_amp * scope.chaos_amp_multiplier * particle_mass_coef;
		  particle.vy += Math.cos( particle.t / 2 ) * particle.chaos_amp * scope.chaos_amp_multiplier * particle_mass_coef;
			
			// apply speed
			vx *= particle_inertion_coef * particle.speed_coef;
			vy *= particle_inertion_coef * particle.speed_coef;
			particle.vx += (vx - particle.vx) / 12;
			particle.vy += (vy - particle.vy) / 12;
			
			// position
			particle.cx += particle.vx;
			particle.cy += particle.vy;
				
			particle.x = particle.cx * current_stage_bounds.canvas_width_coef;
			particle.y = particle.cy * current_stage_bounds.canvas_height_coef;
			// particle.scaleX = particle.scaleY = particle._current_scale * _horizontal_scale_coef;
			particle.scaleX = particle.scaleY = particle._current_scale * PIXEL_RATIO * current_stage_bounds.scale_coef * DEVICE_COEF;

			// console.log( particle._size );
		}

		
		// ------------- SOLID PARTICLES -------------------
		if( solid_particles ) solid_particles.update();
		// ------------- SOLID PARTICLES -------------------


		// ------------- IMAGES -------------------
		for (var i in images ) {

			var image_data = images[i];
			if( !image_data.is_active ) continue;

			var img = image_data.image;

				img.scaleX = img.scaleY =  current_stage_bounds.scale_coef * PIXEL_RATIO * DEVICE_COEF;

				img.x = (image_data.cx - current_stage_bounds.x) * current_stage_bounds.canvas_width_coef - img.image.width * img.scaleX / 2;
				img.y = (image_data.cy - current_stage_bounds.y) * current_stage_bounds.canvas_height_coef - img.image.height * img.scaleX / 2;
				
			// }

			if( image_data.chaos_amp ){
				image_data.t += .1;
				var _chaos_amp = image_data.chaos_amp * 2;
				img.x += Math.cos( image_data.t ) * _chaos_amp;
				img.y += Math.sin( image_data.t * .65 ) * _chaos_amp;
			}

		}

	}





/*
███████╗ ██████╗ ██╗     ██╗██████╗     ██████╗ ██████╗ ████████╗ ██████╗██╗     ███████╗
██╔════╝██╔═══██╗██║     ██║██╔══██╗    ██╔══██╗██╔══██╗╚══██╔══╝██╔════╝██║     ██╔════╝
███████╗██║   ██║██║     ██║██║  ██║    ██████╔╝██████╔╝   ██║   ██║     ██║     ███████╗
╚════██║██║   ██║██║     ██║██║  ██║    ██╔═══╝ ██╔══██╗   ██║   ██║     ██║     ╚════██║
███████║╚██████╔╝███████╗██║██████╔╝    ██║     ██║  ██║   ██║   ╚██████╗███████╗███████║
╚══════╝ ╚═════╝ ╚══════╝╚═╝╚═════╝     ╚═╝     ╚═╝  ╚═╝   ╚═╝    ╚═════╝╚══════╝╚══════╝
*/
	// SOLID PARTICLES
	var solid_particles;

	function initSolidParticles(){
		
		var _container;
		// var _gradient;
		var _gradient_width = 400;
		var _particles = [];
		var _current_gradient;

		solid_particles =  (function() {
			
			var scope = this;

			_container = new createjs.Container();
			_container.visible = false;
			_container.alpha = 0;
			stage.addChildAt( _container, 0 );

			// _gradient = new createjs.Shape();
			// stage.addChild( _gradient );

			for (var i = 0; i < sprites.length; i++) {
				
				var _sprite = sprites[i];
				// console.log(i,":::", _sprite);
				var _particle = new createjs.Shape();
				_particle.graphics.beginFill("#ff0000").drawCircle( 0, 0, _sprite.max_size );
				_particle.max_size = _sprite.max_size;
				_particle.target_sprite = _sprite.mixed_sprite;

				_container.addChild( _particle );

				_particles.push( _particle );

			};


			//
			scope.setGradient = function ( _sprite_gradient ) {
				console.log("setGradient: ", _sprite_gradient );
				_current_gradient = _sprite_gradient;
				// _gradient.graphics
				// 	.beginLinearGradientFill( _sprite_gradient, [.3,.7], 0, 0, 0, _gradient_width )
				// 	.drawRect(0, 0, _gradient_width, _gradient_width );
			}

			//
			scope.changeGradient = function ( _sprite_gradient, _time, _is_solid ) {
				
				// console.log("changeGradient", _is_solid );

				var _time_long = _time * .7;
				var _time_short = _time * .3;

				if( !_is_solid && !_container.visible ) return; // is hidden and no need to show

				if( _container.visible ){ // if visible

					particle_container.visible = true;

					TweenLite.to( _container, _time_long, {
						delay: _time_short,
						alpha: 0,
						ease: Quad.easeOut
					});

					TweenLite.to( particle_container, _time_long, {
						alpha: 1,
						ease: Quad.easeOut,
						onComplete: function() {
							
							_show();

						}
					});

				}else{ // if hidden - only show
					_show();
				}
				
				//
				function _show () {

					if( !_is_solid ){
						_container.visible = false;
						return;
					}

					scope.setGradient( _sprite_gradient );

					_container.visible = true;

					TweenLite.to( _container, _time_long, {
						alpha: 1,
						ease: Quad.easeOut
					});

					TweenLite.to( particle_container, _time_long, {
						delay: _time_short,
						alpha: 0,
						ease: Quad.easeIn,
						onComplete: function() {
							particle_container.visible = false;
						}
					});

				}

			}

			//
			scope.setSize = function(){
				// _gradient.scaleX = canvas.width / _gradient_width;
				// _gradient.scaleY = canvas.height / _gradient_width;
			}

			//
			scope.update = function () {
				
				if( !_current_gradient ) return;

				for (var i = 0; i < _particles.length; i++) {
					
					var _particle = _particles[i];
					var _target_sprite = _particle.target_sprite;

					// _particle.x = _target_sprite.x;
					// _particle.y = _target_sprite.y;
					// _particle.scaleX = _target_sprite.scaleX;
					// _particle.scaleY = _target_sprite.scaleY;

					_particle.graphics
						.clear()
						.beginLinearGradientFill( _current_gradient, [.3,.7], 0, 0, 0, (isVertical ? canvas.height/2 : canvas.height ) )
						.drawCircle( _target_sprite.x, _target_sprite.y, _target_sprite.scaleX * _particle.max_size )
						.endFill();


				};

			}

			//
			scope.setSize();
			return scope;

		})();
		
	}



	
	/*
███╗   ███╗ ██████╗ ██╗   ██╗███████╗███████╗
████╗ ████║██╔═══██╗██║   ██║██╔════╝██╔════╝
██╔████╔██║██║   ██║██║   ██║███████╗█████╗  
██║╚██╔╝██║██║   ██║██║   ██║╚════██║██╔══╝  
██║ ╚═╝ ██║╚██████╔╝╚██████╔╝███████║███████╗
╚═╝     ╚═╝ ╚═════╝  ╚═════╝ ╚══════╝╚══════╝
*/
	// Mouse
	var mousemove = function(e){
	  mx = e.clientX;
	  my = e.clientY;
	}

	// var mousedown = function(){
	//   attract = (attract) ? false : true;
	// }

	var mouseleave = function(){
		mx = -10000;
		my = -10000;
	}
	mouseleave();

/*
███████╗████████╗ █████╗ ██████╗ ████████╗
██╔════╝╚══██╔══╝██╔══██╗██╔══██╗╚══██╔══╝
███████╗   ██║   ███████║██████╔╝   ██║   
╚════██║   ██║   ██╔══██║██╔══██╗   ██║   
███████║   ██║   ██║  ██║██║  ██║   ██║   
╚══════╝   ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═╝   ╚═╝   
*/
	// START
	
	$win.on('resize', resize);
	_resize( true );

	
	if( isMobile.any ){

		deviceOrientation = new DeviceOrientation( function(){
			setTimeout( function(){_resize(true)}, 150 );
		});
		// initMobile();
		// updateParticles = updateParticlesMobile;
		// switchState = switchStateMobile;
		initDesktop();
		updateParticles = updateParticlesDesktop;
		switchState = switchStateDesktop;
		// setInterval( _resize, 50 );

	}else{


		$win.on('mousemove', mousemove)
			.on('mouseleave', mouseleave);

		initDesktop();
		updateParticles = updateParticlesDesktop;
		switchState = switchStateDesktop;
		// $container.trigger("bg:hide",{duration:0,
		// 	onComplete: function(){
		// 		$container.trigger("bg:show",{duration:2});
		// 	}
		// });
		
	}

	
	$container
		.on( "bg:switch", function(e, id){
			switchState( id );
			// console.log( "id", id );
		})
		.on("bg:start", function(e){
			if( is_started ) return;
			console.log("!!! bg:start");
			is_started = true;
			loop();
		});

	$container.trigger("bg:ready");



/*
██╗   ██╗████████╗██╗██╗     ███████╗
██║   ██║╚══██╔══╝██║██║     ██╔════╝
██║   ██║   ██║   ██║██║     ███████╗
██║   ██║   ██║   ██║██║     ╚════██║
╚██████╔╝   ██║   ██║███████╗███████║
 ╚═════╝    ╚═╝   ╚═╝╚══════╝╚══════╝
*/
	function rand(a,b){return ~~((Math.random()*(b-a+1))+a); };
	function randFloat(a,b){return (Math.random()*(b-a))+a; };

	function getDevicePixelRatio() {
      var ratio = 1;
      // To account for zoom, change to use deviceXDPI instead of systemXDPI
      if (window.screen.systemXDPI !== undefined && window.screen.logicalXDPI !== undefined && window.screen.systemXDPI > window.screen.logicalXDPI) {
          // Only allow for values > 1
          ratio = window.screen.systemXDPI / window.screen.logicalXDPI;
      }
      else if (window.devicePixelRatio !== undefined) {
          ratio = window.devicePixelRatio;
      }
      return ratio;
  };

  function easeInQuad (t, b, c, d) {
		t /= d;
		return c*t*t + b;
	};

	function easeOutQuad(t, b, c, d) {
		t /= d;
		return -c * t*(t-2) + b;
	};

  

});
$(function() {
	
	var $element = $(".page-content");
	if( !$element.length ) return;

	var $body = $("body");

	var $slides = $(".intro__slide", $element );
	console.log("intro inited", $slides );
	var $current_slide;
	
	var is_animated = false;
	var current_slide_id;

	var $animation = $(".bg-animation-main");
	var PIXEL_RATIO = Math.min( getDevicePixelRatio(), 2 );





/*
███████╗██╗██╗  ██╗     ██████╗ ██████╗ ██╗ ██████╗ ██╗███╗   ██╗ █████╗ ██╗     
██╔════╝██║╚██╗██╔╝    ██╔═══██╗██╔══██╗██║██╔════╝ ██║████╗  ██║██╔══██╗██║     
█████╗  ██║ ╚███╔╝     ██║   ██║██████╔╝██║██║  ███╗██║██╔██╗ ██║███████║██║     
██╔══╝  ██║ ██╔██╗     ██║   ██║██╔══██╗██║██║   ██║██║██║╚██╗██║██╔══██║██║     
██║     ██║██╔╝ ██╗    ╚██████╔╝██║  ██║██║╚██████╔╝██║██║ ╚████║██║  ██║███████╗
╚═╝     ╚═╝╚═╝  ╚═╝     ╚═════╝ ╚═╝  ╚═╝╚═╝ ╚═════╝ ╚═╝╚═╝  ╚═══╝╚═╝  ╚═╝╚══════╝
*/


	// SIDE NAVIGATOR
	var $nav = $(".navigator-nav");
	
	var wait_nav_timer = setInterval(function() {
		var $nav_items = $(".navigator-nav__item");
		// console.log("NAVS!", $nav_items.length );
		if( !$nav_items.length ) return;
		clearInterval( wait_nav_timer );

		$nav_items.each(function(i,e) {
			
			var $e = $(e);
			// console.log( "NAVS: ", i, e, $e.hasClass("active") );

			$e.data("id", i);

			if( i==0 ){
				$e.hide();
			}else{
				// $(".navigator-nav__link-nmbr", $e).text( i<10 ? "0"+i : i );
				$(".navigator-nav__link-nmbr", $e).text( i );// change menu items count
				$(".navigator-nav__link-text", $e).css("visibility","hidden");// hide menu item title
			}
		});

		$nav_items.click(function (e) {
			var id = $(this).data("id");
			// console.log("click",id);
			$(window).trigger("side-paginator:switched", id );
			setActiveItem( id );
		});

		$(window).on("side-paginator:set", function(e,id) {
			console.log("SET: ", id );
			setActiveItem( id );
		});

		function setActiveItem ( id ) {
			$nav_items.each(function (i,e) {
				e = $(e);
				e.toggleClass( "active", e.data("id") == id );
			});
		}
		//

		// remove original nav init
		var clear_active_timer = setInterval(function(){
			$nav_items.each(function(i,e) {
				var $e = $(e);
				if( $e.hasClass("active")){
					$e.removeClass( "active" );		
					clearInterval(clear_active_timer);
					// console.log("nav init detected: quit");
				}
			});
			// console.log("wait for nav init");
		},40);

	}, 40 );



	// FOOTER
	var $footer = $("footer").hide();





/*
██╗  ██╗██╗██████╗ ███████╗    ███████╗██╗     ██╗██████╗ ███████╗
██║  ██║██║██╔══██╗██╔════╝    ██╔════╝██║     ██║██╔══██╗██╔════╝
███████║██║██║  ██║█████╗      ███████╗██║     ██║██║  ██║█████╗  
██╔══██║██║██║  ██║██╔══╝      ╚════██║██║     ██║██║  ██║██╔══╝  
██║  ██║██║██████╔╝███████╗    ███████║███████╗██║██████╔╝███████╗
╚═╝  ╚═╝╚═╝╚═════╝ ╚══════╝    ╚══════╝╚══════╝╚═╝╚═════╝ ╚══════╝
*/
	function hideSlide( index ){
		
		is_animated = true;

		console.log("hide slide");
		
		// $current_slide.fadeOut(300, function () {
		// 	showSlide( index );
		// });
		// $current_slide.hide();

		var _count = 0;
		var arrow_delay = 0;

		// ARROW DOWNWARDS
		
		$(".arrow-downward>p", $current_slide ).each(function(i,e) {

			_count++;
			var $e = $(e);

			TweenLite.to( e, .5,
			{
				y: - $e.height()*.3,
				ease: Cubic.easeInOut,
				onComplete: function(){
					var $parent = $($e.parent()[0]);
					TweenLite.to( e, .5,
					{
						y: $parent.height(),
						ease: Cubic.easeIn,
						onComplete: checkCount
					});
				}
			});
			
			arrow_delay = .8;

		});

		// ANIMATE TITLES & LOGOS
		$(".intro__subtitle>p, .intro__subtitle>canvas, .intro__logo>img", $current_slide).each(function(i,e) {
			
			// console.log(":>", i, e );
			_count++;

			TweenLite.to( e, .5,
			{
				y: - $(e).height()*1.2,
				delay: .02 * i + arrow_delay,
				ease: Cubic.easeIn,
				onComplete: checkCount
			});
		})

		// ANIMATE TEXTS
		$(".intro__text, .big-link", $current_slide ).each(function(i,e) {
			
			_count++;

			TweenLite.to( e, .6,
			{
				opacity: 0,
				y: -40,
				delay: .02 * i,
				ease: Cubic.easeIn,
				onComplete: checkCount
			});
		});


		// BUTTON SHOWREEL
		$(".showreel-button", $current_slide ).each(function(i,e) {
			
			_count++;

			TweenLite.to( e, .6,
			{
				opacity: 0,
				y: -40,
				delay: .1 + arrow_delay,
				ease: Cubic.easeIn,
				onComplete: checkCount
			});

		});


		// LAST SLIDE
		if( index != $slides.length-1 ){

			// Hide footer
			TweenLite.killTweensOf( $footer );
			TweenLite.to( $footer, .3,
				{
					css: { "bottom": "-70px" },
					ease: Cubic.easeIn,
					onComplete: function() {
						$footer.hide();
					}
				}
			);

		}
		//
		function checkCount() {
			
			_count--;

			if( _count <= 0 ) {
				is_animated = false;
				$current_slide.hide();
				$current_slide = null;
				showSlide( index );
			}
		}

	}





/*
███████╗██╗  ██╗ ██████╗ ██╗    ██╗    ███████╗██╗     ██╗██████╗ ███████╗
██╔════╝██║  ██║██╔═══██╗██║    ██║    ██╔════╝██║     ██║██╔══██╗██╔════╝
███████╗███████║██║   ██║██║ █╗ ██║    ███████╗██║     ██║██║  ██║█████╗  
╚════██║██╔══██║██║   ██║██║███╗██║    ╚════██║██║     ██║██║  ██║██╔══╝  
███████║██║  ██║╚██████╔╝╚███╔███╔╝    ███████║███████╗██║██████╔╝███████╗
╚══════╝╚═╝  ╚═╝ ╚═════╝  ╚══╝╚══╝     ╚══════╝╚══════╝╚═╝╚═════╝ ╚══════╝
*/
	function  showSlide( index ){

		current_slide_id = index;
		$current_slide = $( $slides[index] );
		console.log("show slide", current_slide_id+" > "+index +" : "+ $current_slide );

		is_animated = true;
		var _count = 0;

		$current_slide.show();


		// ANIMATE TITLES & LOGOS
		$(".intro__subtitle>p, .intro__subtitle>canvas, .intro__logo>img", $current_slide).each(function(i,e) {
			// console.log(":>", i, e );
			_count++;
			_animate( e, .7, $(e).height(), .02 * i );

		});


		// ANIMATE TEXTS
		$(".intro__text", $current_slide ).each(function(i,e) {
			
			_count++;

			TweenLite.fromTo( e, 1,
			{
				opacity: 0,
				y: 40
			},
			{
				opacity: 1,
				y: 0,
				delay: .02 * i,
				ease: Cubic.easeOut,
				onComplete: checkCount
			});
		});


		// BIG LINK
		$(".big-link", $current_slide ).each(function(i,e) {
			
			_count++;

			var tt = .7;
			
			TweenLite.set( e, {
				opacity: 1,
				y: 0
			});

			e = $(e);

			var $underline = $(".big-link__underline", e );
			$underline.css("transition","0s width");
			TweenLite.fromTo( $underline[0], tt,
			{
				css: { width: "0%" }
			},
			{
				css: { width: "100%" },
				ease: Cubic.easeInOut,
				onComplete: function(){
					$underline[0].style = "";
					// checkCount();
				}
			});

			var $arrow = $(".big-link__arrow>p", e );
			TweenLite.fromTo( $arrow[0], tt*.75,
			{
				css: { left: "-100%" }
			},
			{
				delay: tt*.7,
				css: { left: "0%" },
				ease: Cubic.easeInOut,
				onComplete: checkCount
			});

			var $link = $(".big-link__link>a", e );
			_animate( $link[0], tt, $link.height()*1.2, tt*.5 );

		});


		// ARROW DOWNWARDS
		$(".arrow-downward>p", $current_slide ).each(function(i,e) {
			
			_count++;
			_animate( e, .8, -$(e).height() * 1.2, .2 );

		});


		// SHOWREEL BUTTON
		$(".showreel-button", $current_slide ).each(function(i,e) {
			
			_count++;

			// reset
			TweenLite.set( e, {
				opacity: 1,
				y: 0
			});

			var $e = $(e);

			// triangle
			var path = $( "svg", $e );
			var _length = 583;
			TweenLite.fromTo( path, 1.2,
				{
					css: {
						"stroke-dasharray": _length,
  					"stroke-dashoffset": _length
					}
				},
				{
					css: {
						"stroke-dasharray": _length,
  					"stroke-dashoffset": 0
					},
					ease: Cubic.easeInOut,
					onComplete: checkCount
				}
			);

			// text
			var $text = $(".showreel-button__text", $e );
			TweenLite.fromTo( $text, 1,
				{
					css: { "margin-left": "-60px", opacity: 0 }
				},
				{
					css: { "margin-left": "0px", opacity: 1 },
					ease: Cubic.easeOut
				}
			);


		});

		// LAST SLIDE
		if( index == $slides.length-1 ){
			// console.log("last slide!");
			$footer.show();
			TweenLite.killTweensOf( $footer );
			TweenLite.fromTo( $footer, .3,
				{
					css: { "bottom": "-70px" }
				},
				{
					css: { "bottom": "0" },
					ease: Cubic.easeOut
				}
			);
		}
		//

		function checkCount() {
			_count--;
			if( _count <= 0 ) {
				is_animated = false;
				console.log("current slide is shown");
			}
		}

		function _animate( ee, tt, yy, dd ) {
			TweenLite.fromTo( ee, tt,
				{
					y: yy
				},
				{
					y: 0,
					delay: dd,
					ease: Cubic.easeOut,
					onComplete: checkCount
				}
			);
		}

	}






/*
███████╗██╗   ██╗███████╗███╗   ██╗████████╗███████╗
██╔════╝██║   ██║██╔════╝████╗  ██║╚══██╔══╝██╔════╝
█████╗  ██║   ██║█████╗  ██╔██╗ ██║   ██║   ███████╗
██╔══╝  ╚██╗ ██╔╝██╔══╝  ██║╚██╗██║   ██║   ╚════██║
███████╗ ╚████╔╝ ███████╗██║ ╚████║   ██║   ███████║
╚══════╝  ╚═══╝  ╚══════╝╚═╝  ╚═══╝   ╚═╝   ╚══════╝
*/
	// EVENTS

	$(window)
		.on("side-paginator:switched", function(e,index) {
			
			console.log("show slide", index );

			// Hide the current slide
			if( $current_slide ){

				hideSlide( index );

			}else{

				showSlide( index );

			}

			$animation.trigger( "bg:switch", index+1 );

		})
		.on("resize", onResize )
		.on("click touchstart", function(e) {
			console.log("e.target> ", e.target );
			if( $(e.target).hasClass("__click-enabled") ) return;
			// e.preventDefault();
		})
		;



	$body
		.on( "wheel mousewheel", function(e) {
			var dir = e.originalEvent.deltaY / Math.abs(e.originalEvent.deltaY);
			swipeSlide(dir);
			// console.log("mousewheel", dir );
			e.preventDefault();

		})
		.swipe( {
			swipeUp:function(e){
				// console.log("Up");
				swipeSlide(1);
			},
			swipeDown:function(e) {
				// console.log("Down");
				swipeSlide(-1);
			}
		});


	function swipeSlide(dir){

		if( is_animated ) return;
			
		var new_slide_index = current_slide_id + dir;
		// console.log("mousewheel!!", dir, e, current_slide_id,  new_slide_index );
		
		if( new_slide_index < 0 || new_slide_index >= $slides.length ) return;

		$(window)
			.trigger( "side-paginator:switched", new_slide_index )
			.trigger("side-paginator:set", new_slide_index );
	}






/*
██████╗ ███████╗███████╗██╗███████╗███████╗
██╔══██╗██╔════╝██╔════╝██║╚══███╔╝██╔════╝
██████╔╝█████╗  ███████╗██║  ███╔╝ █████╗  
██╔══██╗██╔══╝  ╚════██║██║ ███╔╝  ██╔══╝  
██║  ██║███████╗███████║██║███████╗███████╗
╚═╝  ╚═╝╚══════╝╚══════╝╚═╝╚══════╝╚══════╝
*/
	// RESIZE
	var resize_timeout;
	
	var PHONE_W = 375;
	var PHONE_W_MAX = 480;
	var TABLET_W = 768;
	var TABLET_H = 1024;

	function onResize () {
		clearTimeout( resize_timeout );
		resize_timeout = setTimeout( _onResize, 80 );
	}

	function _onResize () {
		console.log("resize");
		
		$body
			.removeClass("phone_horizontal")
			.removeClass("phone_vertical")
			.removeClass("tablet_horizontal")
			.removeClass("tablet_vertical")
			.removeClass("desktop")
		
		var _class = "";
		
		$body.hide();
		var is_portrait = window.innerWidth < window.innerHeight;
		// console.log( "is_portrait", is_portrait );

		if( window.innerWidth <= PHONE_W_MAX ){
				
			_class = "phone_vertical";

		}else if( window.innerWidth <= TABLET_W ){

			if( !is_portrait ) _class = "phone_horizontal";
			else _class = "tablet_vertical";

		}else if( window.innerWidth <= TABLET_H ){

			if( !is_portrait ) _class = "tablet_horizontal";
			else _class = "tablet_vertical";
			// console.log("!!!!!!!!!!!!!", window.innerWidth );

		}else{

			_class = "desktop";

		}

		$body.addClass(_class);
		$body.data("proportion_type",_class);

		// console.log("reszie: ", window.innerWidth, window.innerHeight, _class );

		$body.show();

		// $element.addClass( isMobile.any && window.innerWidth < window.innerHeight ? "is_vertical" : "is_horizontal" );
		$(window).trigger("intro:resize", _class );

		initGradientTexts();
	}



/*
 ██████╗ ██████╗  █████╗ ██████╗ ██╗███████╗███╗   ██╗████████╗    ████████╗███████╗██╗  ██╗████████╗
██╔════╝ ██╔══██╗██╔══██╗██╔══██╗██║██╔════╝████╗  ██║╚══██╔══╝    ╚══██╔══╝██╔════╝╚██╗██╔╝╚══██╔══╝
██║  ███╗██████╔╝███████║██║  ██║██║█████╗  ██╔██╗ ██║   ██║          ██║   █████╗   ╚███╔╝    ██║   
██║   ██║██╔══██╗██╔══██║██║  ██║██║██╔══╝  ██║╚██╗██║   ██║          ██║   ██╔══╝   ██╔██╗    ██║   
╚██████╔╝██║  ██║██║  ██║██████╔╝██║███████╗██║ ╚████║   ██║          ██║   ███████╗██╔╝ ██╗   ██║   
 ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝╚═════╝ ╚═╝╚══════╝╚═╝  ╚═══╝   ╚═╝          ╚═╝   ╚══════╝╚═╝  ╚═╝   ╚═╝   
*/
 	function initGradientTexts () {
 		// GRADIENT TITLES
		$(".intro__subtitle", $element ).each(function (i,el) {
			
			el = $(el);

	  
			var gradient = el.data("gradient");
			if( !gradient ) return;
			gradient = gradient.split(",");

	    el.addClass("intro__subtitle_gradient");

			// console.log( i, "GRAD: ", el, gradient );
	    
			var $p = $("p", el );
	    var font_weight = 900; // $p.css("font-weight");
	    var font_size = parseFloat( $p.css("font-size") ) * font_size_coef * PIXEL_RATIO;
	    var font = font_weight +" "+ font_size + "px " +$p.css("font-family");
	    
	    // console.log(">"+font+"<" );
	  	
	  	var $c = $("canvas", el );
	  	if( !$c.length ) {
	  		$c = $("<canvas/>").appendTo( el );
	  	}
	  	var c = $c[0];
	  	$c.hide();
			// var c = document.createElement('canvas');

			var ctx = c.getContext("2d");
	    ctx.textAlign = "left";
			ctx.textBaseline = "middle";
			ctx.font = font;
		  
	    
	    var t_width = ctx.measureText($p.text()).width;	
			var t_height = font_size * h_coef;
	  	
	    c.width = t_width;
	    c.height = t_height;

	    if( PIXEL_RATIO != 1 ) {
	    	var inv_coef = 1 / PIXEL_RATIO;
	    	$(c).css({
	  			"width": t_width * inv_coef +"px",
	  			"height": t_height * inv_coef +"px"
	  		});
	    }

			// console.log(" t_width: ", t_width, ctx.font);
			// Create gradient
			// var gradientFill = ctx.createLinearGradient(0,0,c.width,0);
			var gradientFill = ctx.createLinearGradient( t_width*.2, t_height*1.3, c.width*.8, -t_height*.3 );

			gradientFill.addColorStop("0",gradient[0]);
			gradientFill.addColorStop("1.0",gradient[1]);
			// Fill with gradient
			ctx.fillStyle = gradientFill;
	  
	    ctx.textAlign = "left";
			ctx.textBaseline = "middle";
			ctx.font = font;
			ctx.fillText( $p.text(), 0, t_height/2 );

	    if( show_debug ) {
	      $p.css({
	        "opacity":.5,
	        "position":"absolute"
	      });
	    }else $p.hide();

	    $c.show();

		});
 	}



/*
██╗███╗   ██╗██╗████████╗
██║████╗  ██║██║╚══██╔══╝
██║██╔██╗ ██║██║   ██║   
██║██║╚██╗██║██║   ██║   
██║██║ ╚████║██║   ██║   
╚═╝╚═╝  ╚═══╝╚═╝   ╚═╝   
*/
	// INIT CONTENTS

	var show_debug = !true;
	var h_coef = 1.15;
	var font_size_coef = 1;

	_onResize();

	// setTimeout( initGradientTexts, 300 );
	
	// Elements
	$(".arrow-downward").click(function() {
		swipeSlide(1);
	});




/*
██╗   ██╗████████╗██╗██╗     ███████╗
██║   ██║╚══██╔══╝██║██║     ██╔════╝
██║   ██║   ██║   ██║██║     ███████╗
██║   ██║   ██║   ██║██║     ╚════██║
╚██████╔╝   ██║   ██║███████╗███████║
 ╚═════╝    ╚═╝   ╚═╝╚══════╝╚══════╝
*/
// Utils
	

	function getDevicePixelRatio() {
      var ratio = 1;
      // To account for zoom, change to use deviceXDPI instead of systemXDPI
      if (window.screen.systemXDPI !== undefined && window.screen.logicalXDPI !== undefined && window.screen.systemXDPI > window.screen.logicalXDPI) {
          // Only allow for values > 1
          ratio = window.screen.systemXDPI / window.screen.logicalXDPI;
      }
      else if (window.devicePixelRatio !== undefined) {
          ratio = window.devicePixelRatio;
      }
      return ratio;
  };




});
